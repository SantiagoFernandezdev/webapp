(window.webpackJsonp=window.webpackJsonp||[]).push([[33],{"+8Tp":function(i,t,o){"use strict";o.r(t),o.d(t,"SANinicioPageModule",function(){return ni});var e=o("ofXK"),n=o("3Pt+"),r=o("TEn/"),c=o("tyNb"),a=o("mrSG"),s=o("HDdC"),b=o("Jmyf"),l=o("4kKk"),p=o("c6Yc"),d=o("UInZ"),u=o("fXoL"),h=o("fsfq"),m=o("WGaO"),f=o("fmoy"),g=o("VYYF"),v=o("7JkF"),O=o("FlrC"),x=o("vLoH");let k=(()=>{class i{constructor(i){this.el=i}cargando(){this.el.nativeElement.currentTime=.3}}return i.\u0275fac=function(t){return new(t||i)(u.Lb(u.m))},i.\u0275dir=u.Gb({type:i,selectors:[["","video-load",""]],hostBindings:function(i,t){1&i&&u.Wb("loadstart",function(){return t.cargando()})}}),i})();var w=o("SpuA");const N=[".enlace"],j=["contenido"],M=["inifinito"];function A(i,t){if(1&i){const i=u.Pb();u.Ob(0,"div",14),u.Wb("click",function(){return u.pc(i),u.Yb(2).crearHistoria()}),u.wc(1," + "),u.Nb()}}function y(i,t){if(1&i){const i=u.Pb();u.Ob(0,"ion-avatar",15),u.Wb("click",function(){u.pc(i);const o=t.$implicit;return u.Yb(2).navegarHistoria(o)}),u.Mb(1,"img",16),u.Nb()}if(2&i){const i=t.$implicit;u.Db("borde",i.marcado),u.Ab(1),u.gc("src",i.img,u.qc)}}function $(i,t){1&i&&(u.Ob(0,"div",18),u.Ob(1,"ion-item",19),u.Ob(2,"ion-avatar",20),u.Mb(3,"ion-skeleton-text",21),u.Nb(),u.Ob(4,"ion-label"),u.Mb(5,"ion-skeleton-text",22),u.Mb(6,"ion-skeleton-text",23),u.Nb(),u.Nb(),u.Ob(7,"div",24),u.Mb(8,"ion-skeleton-text",25),u.Nb(),u.Nb())}const P=function(){return[1,1,1,1,1]};function Y(i,t){1&i&&(u.Ob(0,"div"),u.vc(1,$,9,0,"div",17),u.Nb()),2&i&&(u.Ab(1),u.fc("ngForOf",u.kc(1,P)))}function I(i,t){if(1&i){const i=u.Pb();u.Ob(0,"ion-buttons",1),u.Ob(1,"ion-button",2),u.Wb("click",function(t){u.pc(i);const o=u.Yb(2),e=o.$implicit,n=o.index;return u.Yb(3).opciones(t,e._id,n)}),u.Mb(2,"ion-icon",48),u.Nb(),u.Nb()}}function _(i,t){if(1&i){const i=u.Pb();u.Ob(0,"div",49),u.Wb("click",function(){u.pc(i);const t=u.Yb(2).$implicit;return u.Yb(3).etiquetas(t.etiquetas)}),u.Ob(1,"h3"),u.wc(2,"Etiquetas"),u.Nb(),u.Nb()}}function E(i,t){if(1&i){const i=u.Pb();u.Ob(0,"ion-button",2),u.Wb("click",function(){u.pc(i);const t=u.Yb(2),o=t.$implicit,e=t.index;return u.Yb(3).megusta(o,"megusta",e)}),u.Mb(1,"ion-icon",50),u.Nb()}}function C(i,t){if(1&i){const i=u.Pb();u.Ob(0,"ion-button",2),u.Wb("click",function(){u.pc(i);const t=u.Yb(2),o=t.$implicit,e=t.index;return u.Yb(3).megusta(o,"nomegusta",e)}),u.Mb(1,"ion-icon",51),u.Nb()}}function W(i,t){if(1&i){const i=u.Pb();u.Ob(0,"ion-item",52),u.Ob(1,"ion-avatar",30),u.Wb("click",function(){u.pc(i);const t=u.Yb(2).$implicit;return u.Yb(3).perfilNavegar(t.creadororiginal)}),u.Mb(2,"img",31),u.Nb(),u.Ob(3,"ion-label",2),u.Wb("click",function(){u.pc(i);const t=u.Yb(2).$implicit;return u.Yb(3).perfilNavegar(t.creadororiginal)}),u.wc(4," Publicaci\xf3n original creada por "),u.Mb(5,"br"),u.wc(6),u.Nb(),u.Nb()}if(2&i){const i=u.Yb(2).$implicit;u.Ab(2),u.fc("src",i.imageori,u.qc),u.Ab(4),u.yc(" @",i.creadororiginal.nombreusuario,"")}}function T(i,t){if(1&i){const i=u.Pb();u.Ob(0,"div",29),u.Ob(1,"ion-item",19),u.Ob(2,"ion-avatar",30),u.Wb("click",function(){u.pc(i);const t=u.Yb().$implicit;return u.Yb(3).perfilNavegar(t.creador)}),u.Mb(3,"img",31),u.Nb(),u.Ob(4,"ion-label",32),u.Wb("click",function(){u.pc(i);const t=u.Yb().$implicit;return u.Yb(3).perfilNavegar(t.creador)}),u.wc(5),u.Mb(6,"br"),u.wc(7),u.Nb(),u.vc(8,I,3,0,"ion-buttons",33),u.Nb(),u.Ob(9,"div",34),u.wc(10),u.Nb(),u.vc(11,_,3,0,"div",35),u.Ob(12,"div",36),u.Ob(13,"ion-item",37),u.Ob(14,"ion-buttons",20),u.Ob(15,"ion-button",2),u.Wb("click",function(){u.pc(i);const t=u.Yb(),o=t.$implicit,e=t.index;return u.Yb(3).comentarios(o,e)}),u.Mb(16,"ion-icon",38),u.Nb(),u.Ob(17,"ion-button",2),u.Wb("click",function(){u.pc(i);const t=u.Yb().$implicit;return u.Yb(3).compartir(t)}),u.Mb(18,"ion-icon",39),u.Nb(),u.Nb(),u.Ob(19,"ion-buttons",1),u.Ob(20,"ion-chip",40),u.Wb("click",function(){u.pc(i);const t=u.Yb().$implicit;return u.Yb(3).mglista(t.mglista)}),u.wc(21),u.Nb(),u.vc(22,E,2,0,"ion-button",41),u.vc(23,C,2,0,"ion-button",41),u.Nb(),u.Nb(),u.vc(24,W,7,2,"ion-item",42),u.Nb(),u.Ob(25,"div",43),u.Ob(26,"strong",44),u.Wb("click",function(){u.pc(i);const t=u.Yb().$implicit;return u.Yb(3).perfilNavegar(t.creador)}),u.wc(27),u.Nb(),u.Ob(28,"span"),u.wc(29),u.Nb(),u.Nb(),u.Ob(30,"div",45),u.Wb("click",function(){u.pc(i);const t=u.Yb(),o=t.$implicit,e=t.index;return u.Yb(3).comentarios(o,e)}),u.Ob(31,"span",46),u.wc(32),u.Nb(),u.Mb(33,"br"),u.wc(34," A\xf1adir Comentario "),u.Nb(),u.Ob(35,"div",47),u.wc(36),u.Zb(37,"cambioUTC"),u.Nb(),u.Nb()}if(2&i){const i=u.Yb().$implicit;u.Ab(3),u.fc("src",i.image,u.qc),u.Ab(2),u.yc("",i.creador.nombrecompleto," "),u.Ab(2),u.yc(" @",i.creador.nombreusuario,""),u.Ab(1),u.fc("ngIf",i.eliminar),u.Ab(1),u.tc("background",i.dibujo.fondo)("color",i.dibujo.color),u.Ab(1),u.yc(" ",i.dibujo.texto," "),u.Ab(1),u.fc("ngIf",i.etiquetas.length>0),u.Ab(10),u.yc(" ",i.valormg,""),u.Ab(1),u.fc("ngIf",!i.megusta),u.Ab(1),u.fc("ngIf",i.megusta),u.Ab(1),u.fc("ngIf",i.cog),u.Ab(3),u.xc(i.creador.nombreusuario),u.Ab(2),u.xc(i.comentario),u.Ab(3),u.xc(i.msg),u.Ab(4),u.xc(u.ac(37,18,i.fecha))}}function F(i,t){if(1&i){const i=u.Pb();u.Ob(0,"ion-buttons",1),u.Ob(1,"ion-button",2),u.Wb("click",function(t){u.pc(i);const o=u.Yb(2),e=o.$implicit,n=o.index;return u.Yb(3).opciones(t,e._id,n)}),u.Mb(2,"ion-icon",48),u.Nb(),u.Nb()}}function q(i,t){if(1&i&&u.Mb(0,"img",60),2&i){const i=u.Yb().$implicit;u.hc("src","https://motocaliapp.com/11927613401/",i.ruta,"",u.qc)}}function G(i,t){if(1&i&&u.Mb(0,"video",61),2&i){const i=u.Yb().$implicit;u.hc("src","https://motocaliapp.com/11927613401/",i.ruta,"",u.qc)}}function L(i,t){1&i&&(u.Ob(0,"ion-button",62),u.wc(1,"Abrir V\xeddeo"),u.Nb())}function D(i,t){if(1&i){const i=u.Pb();u.Ob(0,"ion-slide",56),u.Wb("click",function(){u.pc(i);const o=t.index,e=u.Yb(3).$implicit;return u.Yb(3).ver(e.archivos,o,e)}),u.vc(1,q,1,1,"img",57),u.vc(2,G,1,1,"video",58),u.vc(3,L,2,0,"ion-button",59),u.Nb()}if(2&i){const i=t.$implicit;u.Ab(1),u.fc("ngIf",i.mime.includes("image")),u.Ab(1),u.fc("ngIf",i.mime.includes("video")||i.mime.includes("Video")||i.mime.includes("mp4")||i.mime.includes("MP4")),u.Ab(1),u.fc("ngIf",i.mime.includes("video")||i.mime.includes("Video")||i.mime.includes("mp4")||i.mime.includes("MP4"))}}function z(i,t){if(1&i&&(u.Ob(0,"ion-slides",54),u.vc(1,D,4,3,"ion-slide",55),u.Nb()),2&i){const i=u.Yb(2).$implicit;u.fc("pager",i.pager),u.Ab(1),u.fc("ngForOf",i.archivos)}}function B(i,t){if(1&i){const i=u.Pb();u.Ob(0,"div",49),u.Wb("click",function(){u.pc(i);const t=u.Yb(2).$implicit;return u.Yb(3).etiquetas(t.etiquetas)}),u.Ob(1,"h3"),u.wc(2,"Etiquetas"),u.Nb(),u.Nb()}}function S(i,t){if(1&i){const i=u.Pb();u.Ob(0,"ion-button",2),u.Wb("click",function(){u.pc(i);const t=u.Yb(2),o=t.$implicit,e=t.index;return u.Yb(3).megusta(o,"megusta",e)}),u.Mb(1,"ion-icon",50),u.Nb()}}function R(i,t){if(1&i){const i=u.Pb();u.Ob(0,"ion-button",2),u.Wb("click",function(){u.pc(i);const t=u.Yb(2),o=t.$implicit,e=t.index;return u.Yb(3).megusta(o,"nomegusta",e)}),u.Mb(1,"ion-icon",51),u.Nb()}}function U(i,t){if(1&i){const i=u.Pb();u.Ob(0,"ion-item",52),u.Ob(1,"ion-avatar",30),u.Wb("click",function(){u.pc(i);const t=u.Yb(2).$implicit;return u.Yb(3).perfilNavegar(t.creadororiginal)}),u.Mb(2,"img",31),u.Nb(),u.Ob(3,"ion-label",2),u.Wb("click",function(){u.pc(i);const t=u.Yb(2).$implicit;return u.Yb(3).perfilNavegar(t.creadororiginal)}),u.wc(4),u.Mb(5,"br"),u.wc(6),u.Nb(),u.Nb()}if(2&i){const i=u.Yb(2).$implicit;u.Ab(2),u.fc("src",i.imageori,u.qc),u.Ab(2),u.yc("",i.creadororiginal.nombrecompleto," "),u.Ab(2),u.yc(" ",i.creadororiginal.nombreusuario,"")}}function H(i,t){if(1&i){const i=u.Pb();u.Ob(0,"div",29),u.Ob(1,"ion-item",19),u.Ob(2,"ion-avatar",30),u.Wb("click",function(){u.pc(i);const t=u.Yb().$implicit;return u.Yb(3).perfilNavegar(t.creador)}),u.Mb(3,"img",31),u.Nb(),u.Ob(4,"ion-label",32),u.Wb("click",function(){u.pc(i);const t=u.Yb().$implicit;return u.Yb(3).perfilNavegar(t.creador)}),u.wc(5),u.Mb(6,"br"),u.wc(7),u.Nb(),u.vc(8,F,3,0,"ion-buttons",33),u.Nb(),u.vc(9,z,2,2,"ion-slides",53),u.vc(10,B,3,0,"div",35),u.Ob(11,"div",36),u.Ob(12,"ion-item",37),u.Ob(13,"ion-buttons",20),u.Ob(14,"ion-button",2),u.Wb("click",function(){u.pc(i);const t=u.Yb(),o=t.$implicit,e=t.index;return u.Yb(3).comentarios(o,e)}),u.Mb(15,"ion-icon",38),u.Nb(),u.Ob(16,"ion-button",2),u.Wb("click",function(){u.pc(i);const t=u.Yb().$implicit;return u.Yb(3).compartir(t)}),u.Mb(17,"ion-icon",39),u.Nb(),u.Nb(),u.Ob(18,"ion-buttons",1),u.Ob(19,"ion-chip",40),u.Wb("click",function(){u.pc(i);const t=u.Yb().$implicit;return u.Yb(3).mglista(t.mglista)}),u.wc(20),u.Nb(),u.vc(21,S,2,0,"ion-button",41),u.vc(22,R,2,0,"ion-button",41),u.Nb(),u.Nb(),u.vc(23,U,7,3,"ion-item",42),u.Nb(),u.Ob(24,"div",43),u.Ob(25,"strong",44),u.Wb("click",function(){u.pc(i);const t=u.Yb().$implicit;return u.Yb(3).perfilNavegar(t.creador)}),u.wc(26),u.Nb(),u.Ob(27,"span"),u.wc(28),u.Nb(),u.Nb(),u.Ob(29,"div",45),u.Wb("click",function(){u.pc(i);const t=u.Yb(),o=t.$implicit,e=t.index;return u.Yb(3).comentarios(o,e)}),u.Ob(30,"span",46),u.wc(31),u.Nb(),u.Mb(32,"br"),u.wc(33," A\xf1adir Comentario "),u.Nb(),u.Ob(34,"div",47),u.wc(35),u.Zb(36,"cambioUTC"),u.Nb(),u.Nb()}if(2&i){const i=u.Yb().$implicit,t=u.Yb(3);u.Ab(3),u.fc("src",i.image,u.qc),u.Ab(2),u.yc("",i.creador.nombrecompleto," "),u.Ab(2),u.yc(" @",i.creador.nombreusuario,""),u.Ab(1),u.fc("ngIf",i.eliminar),u.Ab(1),u.fc("ngIf",t.cargadentro),u.Ab(1),u.fc("ngIf",i.etiquetas.length>0),u.Ab(10),u.yc(" ",i.valormg,""),u.Ab(1),u.fc("ngIf",!i.megusta),u.Ab(1),u.fc("ngIf",i.megusta),u.Ab(1),u.fc("ngIf",i.cog),u.Ab(3),u.xc(i.creador.nombreusuario),u.Ab(2),u.xc(i.comentario),u.Ab(3),u.xc(i.msg),u.Ab(4),u.xc(u.ac(36,14,i.fecha))}}function V(i,t){if(1&i&&(u.Ob(0,"div"),u.Mb(1,"div",27),u.vc(2,T,38,20,"div",28),u.vc(3,H,37,16,"div",28),u.Nb()),2&i){const i=t.$implicit;u.Ab(2),u.fc("ngIf","dibujar"===i.tipo),u.Ab(1),u.fc("ngIf","multimedia"===i.tipo)}}function X(i,t){if(1&i&&(u.Ob(0,"div"),u.vc(1,V,4,2,"div",26),u.Nb()),2&i){const i=u.Yb(2);u.Ab(1),u.fc("ngForOf",i.publicaciones)}}function J(i,t){if(1&i){const i=u.Pb();u.Ob(0,"ion-infinite-scroll",63,64),u.Wb("ionInfinite",function(t){return u.pc(i),u.Yb(2).loadData(t)}),u.Mb(2,"ion-infinite-scroll-content",65),u.Nb()}}function K(i,t){if(1&i){const i=u.Pb();u.Ob(0,"ion-content",5,6),u.Ob(2,"ion-segment",7),u.vc(3,A,2,0,"div",8),u.vc(4,y,2,3,"ion-avatar",9),u.Nb(),u.Ob(5,"ion-refresher",10),u.Wb("ionRefresh",function(t){return u.pc(i),u.Yb().refrescando(t)}),u.Mb(6,"ion-refresher-content",11),u.Nb(),u.vc(7,Y,2,2,"div",12),u.vc(8,X,2,1,"div",12),u.vc(9,J,3,0,"ion-infinite-scroll",13),u.Nb()}if(2&i){const i=u.Yb();u.fc("fullscreen",!0),u.Ab(3),u.fc("ngForOf",i.noticias),u.Ab(1),u.fc("ngForOf",i.historias),u.Ab(3),u.fc("ngIf",!i.cargaTodo),u.Ab(1),u.fc("ngIf",i.cargaTodo),u.Ab(1),u.fc("ngIf",i.cargainfinite)}}let Z=(()=>{class i{constructor(i,t,o,e,n,r,c,a,s,b,l){this.almacenamiento=i,this.modalCtrl=t,this.IGTMApi=o,this.toast=e,this.router=n,this.statusbar=r,this.socket=c,this.poipover=a,this.entrada=s,this.apiGrupo=b,this.menuCtrl=l,this.slideOpt={zoom:{maxRatio:8,toggle:!0}},this.click=!1,this.publicaciones=[],this.cargadentro=!1,this.noticias=[1],this.historias=[],this.historiasBase=[],this.cargaTodo=!1,this.cargainfinite=!0,this.desde=0,this.cr=!1,this.entrada.$inicio.subscribe(i=>{console.log(i),console.log("dataaaaaa"),""!==i&&this.cr&&this.contenido.scrollToTop(300).then(()=>{}).catch(()=>{})})}ngOnInit(){}ionViewWillEnter(){this.cr=!0,this.desde=0,this.historias=[],this.historiasBase=[],this.iniciar2(),this.iniciar()}menu(){this.menuCtrl.open("perfil")}refrescando(i){this.cr=!0,this.desde=0,this.infinite.disabled=!1,this.historias=[],this.historiasBase=[],this.iniciar().then(()=>{this.iniciar2(),i.detail.complete()}).catch(()=>{this.iniciar2(),i.detail.complete()})}clicks(){return new s.a(i=>{this.enlace&&(i.next("Bien"),this.enlace.nativeElement.addEventListener("click",()=>{}))})}iniciar(){return Object(a.a)(this,void 0,void 0,function*(){const i=yield this.almacenamiento.obtenerToken();i&&this.IGTMApi.saber(i.token,{desde:this.desde}).subscribe(t=>Object(a.a)(this,void 0,void 0,function*(){t.exe&&(t.response.forEach((t,o)=>Object(a.a)(this,void 0,void 0,function*(){t.eliminar=t.creador._id===i._id,t.guardado=!1,t.image=t.creador.imagen.length>0?`https://motocaliapp.com/${t.creador.imagen[0].path}`:"/assets/notfound.png",t.creadororiginal?(t.cog=!0,t.imageori=t.creadororiginal.imagen.length>0?`https://motocaliapp.com/${t.creadororiginal.imagen[0].path}`:"/assets/notfound.png"):t.cog=!1,yield new Promise((o,e)=>{this.IGTMApi.leerFotos(i.token,{id:t._id,historia:"false"}).subscribe(i=>{i.exe?(t.archivos=i.response,i.response.length>1?(t.pager=!0,o({exe:!0})):(o({exe:!1}),t.pager=!1)):(o({exe:!0}),t.archivos=[]),this.cargadentro=!0},i=>{o({exe:!1}),t.archivos=[]})}),yield new Promise((o,e)=>{this.IGTMApi.crearGuardado(i.token,{publicacion:t._id,tipo:"leer"}).subscribe(i=>{t.guardado=!!i.exe,o(!0)},i=>{o(!0),t.guardado=!1})}),yield new Promise((o,e)=>{this.IGTMApi.meGusta(i.token,{id:t._id,tipo:"leer"}).subscribe(e=>{t.megusta=!!e.response.find(t=>t.creador._id===i._id),t.valormg=e.response.length,t.mglista=e.response,o(!0)},i=>{o(!0),t.megusta=!1,t.valormg=""})}),yield new Promise((o,e)=>{this.IGTMApi.crearComentario(i.token,{_id:t._id,tipo:"leer"}).subscribe(i=>{i.exe?(t.comentarios=i.response,t.msg=i.response.length>0?`${t.comentarios.length} comentarios...`:"No hay ning\xfan comentario paraesta publicaci\xf3n"):t.comentarios=[],o(!0),this.cargadentro=!0},i=>{o(!0),t.comentarios=[]})})})),this.publicaciones=t.response),this.cargaTodo=!0}),i=>{})})}iniciar2(){return Object(a.a)(this,void 0,void 0,function*(){const i=yield this.almacenamiento.obtenerToken();i&&(this.infinite.disabled=!1,this.IGTMApi.saberHistorias(i.token,{}).subscribe(t=>Object(a.a)(this,void 0,void 0,function*(){t.exe&&(this.historias=[],t.response.length>0&&t.response.forEach((t,o)=>Object(a.a)(this,void 0,void 0,function*(){if(t.length>0){t[0].image=t[0].creador.imagen.length>0?`https://motocaliapp.com/${t[0].creador.imagen[0].path}`:"/assets/notfound.png";let e={img:t[0].image,idx:o,nombre:t[0].creador.nombrecompleto,usuario:t[0].creador.nombreusuario,marcado:!1,visto:0};t.forEach((t,o)=>Object(a.a)(this,void 0,void 0,function*(){0===t.vistos.filter(t=>t._id.toString()===i._id).length&&(e.marcado=!0,e.visto=o),yield new Promise((o,e)=>{this.IGTMApi.leerFotos(i.token,{id:t._id,historia:"true"}).subscribe(i=>{i.exe?(t.archivos=i.response,o(i.response.length>1?{exe:!0}:{exe:!1})):(o({exe:!0}),t.archivos=[])},i=>{o({exe:!1}),t.archivos=[]})})})),this.historias.push(e),this.historiasBase.push(t)}})))}),i=>{}))})}megusta(i,t,o){return Object(a.a)(this,void 0,void 0,function*(){"megusta"===t?(this.publicaciones[o].megusta=!0,this.publicaciones[o].valormg=parseFloat(this.publicaciones[o].valormg)+1):(this.publicaciones[o].megusta=!1,this.publicaciones[o].valormg=parseFloat(this.publicaciones[o].valormg)-1);const e=yield this.almacenamiento.obtenerToken();e&&this.IGTMApi.meGusta(e.token,{tipo:t,id:i._id,creador:i.creador}).subscribe(o=>{o.exe?e._id!==i.creador._id&&"megusta"===t&&this.socket.emit("megusta",{id:i._id,mensaje:`@${e.nusuario} le gusta tu publicaci\xf3n`,creador:i.creador._id}):this.toast.toastError("No se pudo dar me gusta, intentelo m\xe1s tarde")},i=>{this.toast.toastError("No se pudo dar me gusta, intentelo m\xe1s tarde")})})}guardado(i,t,o){return Object(a.a)(this,void 0,void 0,function*(){this.publicaciones[o].guardado="crear"===t;const e=yield this.almacenamiento.obtenerToken();e&&this.IGTMApi.crearGuardado(e.token,{tipo:t,publicacion:i._id}).subscribe(i=>{i.exe?this.toast.toastNotificacion("crear"===t?"Publicaci\xf3n guardada en colecciones":"Publicaci\xf3n eliminada de colecciones"):this.toast.toastError("No se pudo guardar, intentelo m\xe1s tarde")},i=>{this.toast.toastError("No se pudo guardar, intentelo m\xe1s tarde")})})}etiquetar(){return Object(a.a)(this,void 0,void 0,function*(){const i=yield this.modalCtrl.create({component:b.a,componentProps:{tipo:"etiquetar"}});yield i.present()})}etiquetas(i){return Object(a.a)(this,void 0,void 0,function*(){const t=yield this.modalCtrl.create({component:b.a,componentProps:{tipo:"etiquetados",etiquetados:i}});yield t.present(),(yield t.onWillDismiss())&&(this.statusbar.show(),this.click=!1)})}ver(i,t,o){return Object(a.a)(this,void 0,void 0,function*(){if(!this.click){this.click=!0;const e=yield this.modalCtrl.create({component:b.a,componentProps:{tipo:"visualizador",archivos:i,indice:t,info:o}});yield e.present(),(yield e.onWillDismiss())&&(this.statusbar.show(),this.click=!1)}})}comentarios(i,t){return Object(a.a)(this,void 0,void 0,function*(){const o=yield this.modalCtrl.create({component:b.a,componentProps:{tipo:"comentar",publicacion:i._id,creador:i.creador,comentarios:i.comentarios}});yield o.present();const e=yield o.onWillDismiss();e&&(this.statusbar.show(),this.click=!1,e.data&&e.data.exe&&(this.publicaciones[t].comentarios=e.data.comentarios,this.publicaciones[t].msg=e.data.comentarios.length>0?`${e.data.comentarios.length} comentarios...`:"No hay ning\xfan comentario paraesta publicaci\xf3n"))})}compartir(i){return Object(a.a)(this,void 0,void 0,function*(){const t=yield this.modalCtrl.create({component:b.a,componentProps:{tipo:"compartir",publicacionc:i}});yield t.present();const o=yield t.onWillDismiss();o&&(this.statusbar.show(),this.click=!1,o.data&&o.data.recargo&&(yield this.contenido.scrollToTop()))})}perfil(i){}perfilNavegar(i){return Object(a.a)(this,void 0,void 0,function*(){console.log(i,"DATA_ UR");const t=yield this.almacenamiento.obtenerToken();t&&(t.nusuario===i.nombreusuario?this.router.navigate(["/perfil/","s"]):i.grupo?this.apiGrupo.irgrupo(t.token,{id:i._id}).subscribe(i=>{i.exe?i.response.length>0?this.router.navigate(["/interfaz-grupo/",i.response[0]._id,"inicio",i.response[0]._id]):this.toast.toastError("No se puede acceder al grupo o el grupo no existe, int\xe9ntelo m\xe1s tarde"):this.toast.toastError("No se puede acceder al grupo, int\xe9ntelo m\xe1s tarde")},i=>{this.toast.toastError("No se puede acceder al grupo, int\xe9ntelo m\xe1s tarde")}):this.router.navigate(["/visita/",i.nombreusuario,"s"]))})}crearHistoria(){this.router.navigate(["/central/creando/creador","historia"])}navegarHistoria(i){return Object(a.a)(this,void 0,void 0,function*(){const t=yield this.modalCtrl.create({component:l.a,componentProps:{info:i,historias:this.historiasBase}});yield t.present(),t.onWillDismiss().then(()=>{this.historias=[],this.historiasBase=[],this.iniciar2()}).catch(()=>{this.historias=[],this.historiasBase=[],this.iniciar2()})})}opciones(i,t,o){return Object(a.a)(this,void 0,void 0,function*(){const e=yield this.poipover.create({component:p.a,componentProps:{id:t},event:i});yield e.present();const n=yield e.onWillDismiss();n&&n.data&&n.data.exe&&(this.toast.toastExitoso("Publicaci\xf3n eliminada"),this.publicaciones.splice(o,1))})}loadData(i){return Object(a.a)(this,void 0,void 0,function*(){this.desde=this.desde+10;const t=yield this.almacenamiento.obtenerToken();t&&this.IGTMApi.saber(t.token,{desde:this.desde}).subscribe(o=>{o.exe?o.response.length>0?(i.target.complete(),o.response.forEach((i,o)=>Object(a.a)(this,void 0,void 0,function*(){i.eliminar=i.creador._id===t._id,i.guardado=!1,i.image=i.creador.imagen.length>0?`https://motocaliapp.com/${i.creador.imagen[0].path}`:"/assets/notfound.png",i.creadororiginal?(i.cog=!0,i.imageori=i.creadororiginal.imagen.length>0?`https://motocaliapp.com/${i.creadororiginal.imagen[0].path}`:"/assets/notfound.png"):i.cog=!1,yield new Promise((o,e)=>{this.IGTMApi.leerFotos(t.token,{id:i._id,historia:"false"}).subscribe(t=>{t.exe?(i.archivos=t.response,t.response.length>1?(i.pager=!0,o({exe:!0})):(o({exe:!1}),i.pager=!1)):(o({exe:!0}),i.archivos=[]),this.cargadentro=!0},t=>{o({exe:!1}),i.archivos=[]})}),yield new Promise((o,e)=>{this.IGTMApi.crearGuardado(t.token,{publicacion:i._id,tipo:"leer"}).subscribe(t=>{i.guardado=!!t.exe,o(!0)},t=>{o(!0),i.guardado=!1})}),yield new Promise((o,e)=>{this.IGTMApi.meGusta(t.token,{id:i._id,tipo:"leer"}).subscribe(e=>{i.megusta=!!e.response.find(i=>i.creador===t._id),o(!0),i.valormg=e.response.length},t=>{o(!0),i.megusta=!1,i.valormg=""})}),yield new Promise((o,e)=>{this.IGTMApi.crearComentario(t.token,{_id:i._id,tipo:"leer"}).subscribe(t=>{t.exe?(i.comentarios=t.response,i.msg=t.response.length>0?`${i.comentarios.length} comentarios...`:"No hay ning\xfan comentario paraesta publicaci\xf3n"):i.comentarios=[],o(!0),this.cargadentro=!0},t=>{o(!0),i.comentarios=[]})}),this.publicaciones.push(i)}))):(i.target.disabled=!0,this.desde=0):this.toast.alertApplication("No se pudo traer las publicaciones, intentelo m\xe1s tarde",!1)},i=>{this.toast.alertApplication("No se pudo traer las publicaciones, intentelo m\xe1s tarde",!1)})})}mglista(i){return Object(a.a)(this,void 0,void 0,function*(){const t=yield this.modalCtrl.create({component:d.a,componentProps:{listado:i}});yield t.present()})}ionViewWillLeave(){this.cr=!1}}return i.\u0275fac=function(t){return new(t||i)(u.Lb(h.a),u.Lb(r.qb),u.Lb(m.a),u.Lb(f.a),u.Lb(c.g),u.Lb(g.a),u.Lb(v.a),u.Lb(r.ub),u.Lb(O.a),u.Lb(x.a),u.Lb(r.pb))},i.\u0275cmp=u.Fb({type:i,selectors:[["app-saninicio"]],viewQuery:function(i,t){if(1&i&&(u.Ac(N,1),u.Ac(j,1),u.Ac(M,1)),2&i){let i;u.oc(i=u.Xb())&&(t.enlace=i.first),u.oc(i=u.Xb())&&(t.contenido=i.first),u.oc(i=u.Xb())&&(t.infinite=i.first)}},decls:8,vars:1,consts:[[1,"ion-no-border"],["slot","end"],[3,"click"],["name","menu","slot","icon-only"],[3,"fullscreen",4,"ngIf"],[3,"fullscreen"],["contenido",""],["scrollable","true",1,"ct"],["class","color",3,"click",4,"ngFor","ngForOf"],["class","avatar",3,"borde","click",4,"ngFor","ngForOf"],["slot","fixed","pullFactor","0.5","pullMin","50","pullMax","150",3,"ionRefresh"],["pullingIcon","arrow-dropdown","refreshingSpinner","circles"],[4,"ngIf"],["threshold","100px",3,"ionInfinite",4,"ngIf"],[1,"color",3,"click"],[1,"avatar",3,"click"],[3,"src"],["class","skt",4,"ngFor","ngForOf"],[1,"skt"],["lines","none",1,"sinfondo"],["slot","start"],["animated","","width","100%","height","100%"],["animated","","width","100%","height","30px"],["animated","","width","100px","height","30px"],[2,"height","200px"],["animated","","width","100%","height","200px"],[4,"ngFor","ngForOf"],[1,"divider","ligth"],["class","publicacion dibujar",4,"ngIf"],[1,"publicacion","dibujar"],["slot","start",3,"click"],["width","100%","height","100%","alt","",3,"src"],[1,"ion-text-wrap",3,"click"],["slot","end",4,"ngIf"],[1,"lienzo"],["class","etiquetas",3,"click",4,"ngIf"],[1,"opciones"],["lines","none","mode","md",1,"sinfondo"],["name","chatbubble-outline","slot","icon-only"],["name","arrow-redo-outline","slot","icon-only"],["mode","ios","color","medium",3,"click"],[3,"click",4,"ngIf"],["lines","none","class","sinfondo opacity",4,"ngIf"],[1,"comentarios"],[1,"gris","espacio",3,"click"],[1,"comentar",3,"click"],[1,"opt"],[1,"fecha"],["name","ellipsis-vertical-outline","slot","icon-only"],[1,"etiquetas",3,"click"],["name","heart-outline","slot","icon-only"],["name","heart","color","danger","slot","icon-only"],["lines","none",1,"sinfondo","opacity"],["color","dark","mode","ios",3,"pager",4,"ngIf"],["color","dark","mode","ios",3,"pager"],["class","diapo",3,"click",4,"ngFor","ngForOf"],[1,"diapo",3,"click"],["width","100%",3,"src",4,"ngIf"],["video-load","","poster","/assets/Video.png","width","100%",3,"src",4,"ngIf"],["class","btonDiapo","fill","outline","color","blanco","mode","md","expand","block",4,"ngIf"],["width","100%",3,"src"],["video-load","","poster","/assets/Video.png","width","100%",3,"src"],["fill","outline","color","blanco","mode","md","expand","block",1,"btonDiapo"],["threshold","100px",3,"ionInfinite"],["inifinito",""],["loadingSpinner","bubbles","loadingText","Cargando Publicaciones..."]],template:function(i,t){1&i&&(u.Ob(0,"ion-header",0),u.Ob(1,"ion-toolbar"),u.Ob(2,"ion-title"),u.wc(3,"intas App"),u.Nb(),u.Ob(4,"ion-buttons",1),u.Ob(5,"ion-button",2),u.Wb("click",function(){return t.menu()}),u.Mb(6,"ion-icon",3),u.Nb(),u.Nb(),u.Nb(),u.Nb(),u.vc(7,K,10,6,"ion-content",4)),2&i&&(u.Ab(7),u.fc("ngIf",t.cr))},directives:[r.z,r.lb,r.jb,r.k,r.j,r.A,e.j,r.t,r.V,r.xb,e.i,r.Q,r.R,r.f,r.F,r.Z,r.K,r.r,r.bb,r.ab,k,r.C,r.D],pipes:[w.a],styles:["div[_ngcontent-%COMP%]{width:100%}.color[_ngcontent-%COMP%]{margin:10px 5px;width:60px;height:60px;border-radius:10px;background-color:#f1f1f1;color:#333;display:flex;justify-content:center;align-items:center;font-size:22px}.color[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{opacity:0}.avatar[_ngcontent-%COMP%]{width:60px;height:60px;margin:10px 5px}.borde[_ngcontent-%COMP%]{border:4px solid #0374f7}.publicacion[_ngcontent-%COMP%]{background:#fff;border-top:1px solid rgba(3,3,3,.1);max-width:800px;margin:auto}.publicacion[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]{font-size:12px!important}.lienzo[_ngcontent-%COMP%]{padding:10px;display:flex;text-align:center;justify-content:center;align-items:center;white-space:pre-wrap;min-height:300px;font-size:24px;font-weight:700;line-height:1.7}.info[_ngcontent-%COMP%]{padding:15px}.opciones[_ngcontent-%COMP%]{width:100%}.comentarios[_ngcontent-%COMP%]{padding:10px 10px 10px 15px;font-weight:300;line-height:1.6;font-size:16px}.gris[_ngcontent-%COMP%]{color:#333}.espacio[_ngcontent-%COMP%]{padding-right:10px}.diapo[_ngcontent-%COMP%]{background-color:#000!important;width:100%;max-height:calc(100vh - 270px);overflow:hidden;position:relative}.diapo[_ngcontent-%COMP%]   video[_ngcontent-%COMP%]{max-width:100%;max-height:100%}.diapo[_ngcontent-%COMP%]   .btonDiapo[_ngcontent-%COMP%]{margin:auto 5%;width:90%;position:absolute;bottom:10px;left:0;z-index:10}.etiquetas[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{width:100px;border-radius:3px;text-align:center;background-color:#f1f1f1;color:#333;cursor:pointer}.comentar[_ngcontent-%COMP%]{color:#333}.comentar[_ngcontent-%COMP%], .fecha[_ngcontent-%COMP%]{padding:5px 15px;font-size:14px}.fecha[_ngcontent-%COMP%]{color:#777;opacity:.7}.opt[_ngcontent-%COMP%]{opacity:.5}"]}),i})();var Q=o("iTUp");const ii=[{path:"",component:Z}];let ti=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=u.Jb({type:i}),i.\u0275inj=u.Ib({imports:[[c.j.forChild(ii),Q.a],c.j]}),i})();var oi=o("D3OO"),ei=o("Qv/D");let ni=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=u.Jb({type:i}),i.\u0275inj=u.Ib({imports:[[e.b,n.e,r.mb,ti,Q.a,oi.a,ei.HistoriasModalPageModule]]}),i})()},SpuA:function(i,t,o){"use strict";o.d(t,"a",function(){return r});var e=o("wd/R"),n=o("fXoL");let r=(()=>{class i{transform(i){console.log(i,"fechin");let t=e.utc(i).toDate();return e(t).format("dddd, DD MMMM YYYY h:mm:a")}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275pipe=n.Kb({name:"cambioUTC",type:i,pure:!0}),i})()},UInZ:function(i,t,o){"use strict";o.d(t,"a",function(){return l});var e=o("mrSG"),n=o("fXoL"),r=o("fsfq"),c=o("TEn/"),a=o("tyNb"),s=o("ofXK");function b(i,t){if(1&i){const i=n.Pb();n.Ob(0,"ion-item",3),n.Wb("click",function(){n.pc(i);const o=t.$implicit;return n.Yb().perfil(o.creador.nombreusuario)}),n.Ob(1,"ion-avatar",6),n.Mb(2,"img",7),n.Nb(),n.Ob(3,"ion-label",8),n.Ob(4,"div"),n.wc(5),n.Nb(),n.Ob(6,"strong"),n.wc(7),n.Nb(),n.Nb(),n.Nb()}if(2&i){const i=t.$implicit;n.Ab(2),n.hc("src","https://www.motocaliapp.com/",i.creador.imagen[0].path,"",n.qc),n.Ab(3),n.xc(i.creador.nombrecompleto),n.Ab(2),n.xc(i.creador.nombreusuario)}}let l=(()=>{class i{constructor(i,t,o){this.almacenamiento=i,this.modal=t,this.router=o}ngOnInit(){}ionViewWillEnter(){console.log(this.listado)}perfil(i){return Object(e.a)(this,void 0,void 0,function*(){const t=yield this.almacenamiento.obtenerToken();t&&(t.nusuario===i?(this.router.navigate(["/perfil/","s"]),this.cerrar()):(this.router.navigate(["/visita/",i,"s"]),this.cerrar()))})}cerrar(){this.modal.dismiss()}}return i.\u0275fac=function(t){return new(t||i)(n.Lb(r.a),n.Lb(c.qb),n.Lb(a.g))},i.\u0275cmp=n.Fb({type:i,selectors:[["app-modal-megustas"]],inputs:{listado:"listado"},decls:10,vars:1,consts:[[1,"ion-no-border"],["color","oscuro"],["slot","end"],[3,"click"],["name","close-outline","slot","icon-only"],[3,"click",4,"ngFor","ngForOf"],["slot","start"],[3,"src"],[1,"ion-text-wrap"]],template:function(i,t){1&i&&(n.Ob(0,"ion-header",0),n.Ob(1,"ion-toolbar",1),n.Ob(2,"ion-title"),n.wc(3,"Le gusta a:"),n.Nb(),n.Ob(4,"ion-buttons",2),n.Ob(5,"ion-button",3),n.Wb("click",function(){return t.cerrar()}),n.Mb(6,"ion-icon",4),n.Nb(),n.Nb(),n.Nb(),n.Nb(),n.Ob(7,"ion-content"),n.Ob(8,"ion-list"),n.vc(9,b,8,3,"ion-item",5),n.Nb(),n.Nb()),2&i&&(n.Ab(9),n.fc("ngForOf",t.listado))},directives:[c.z,c.lb,c.jb,c.k,c.j,c.A,c.t,c.L,s.i,c.F,c.f,c.K],styles:[""]}),i})()},vLoH:function(i,t,o){"use strict";o.d(t,"a",function(){return f});var e=o("tk/3"),n=o("PqYM"),r=o("Cfvw"),c=o("coGc"),a=o("lJxs"),s=o("IzEk"),b=o("MtjB"),l=o("JIr8"),p=o("AytR"),d=o("fXoL"),u=o("B7Rs"),h=o("fsfq"),m=o("TEn/");let f=(()=>{class i{constructor(i,t,o,e){this.http=i,this.transfer=t,this.almacenamiento=o,this.navCtrl=e}hanflerError(i){let t=0;return i.pipe(Object(c.a)(()=>Object(n.a)(5e3)),Object(a.a)(i=>{if(t++,console.log("Entramos a intentos"),i instanceof ErrorEvent){if(3===t)throw new Error("Error de Red")}else{if(!(i instanceof ProgressEvent))throw 404===i.status?new Error(" al realizar la solicictud "):401===i.status?(this.almacenamiento.terminarPartida().then(()=>{this.navCtrl.navigateRoot("/home")}),new Error("No tiene permisos para realizar la petici\xf3n ")):(console.log(i,"Error de servidor"),new Error(" No se pudo realizar la petici\xf3n, intentalo m\xe1s tarde "));if(3===t)throw new Error("Error de Red")}}),Object(s.a)(3))}crearGrupo(i,t){const o={headers:new e.c({"x-token":i})};return this.http.post(`${p.a}/grupos/crear`,t,o).pipe(Object(b.a)(i=>this.hanflerError(i)))}listarGrupos(i,t){const o={headers:new e.c({"x-token":i})};return this.http.put(`${p.a}/grupos/lista`,t,o).pipe(Object(b.a)(i=>this.hanflerError(i)))}info(i,t){const o={headers:new e.c({"x-token":i})};return this.http.put(`${p.a}/grupos/info`,t,o).pipe(Object(b.a)(i=>this.hanflerError(i)))}integrantes(i,t){const o={headers:new e.c({"x-token":i})};return this.http.put(`${p.a}/grupos/integrantes`,t,o).pipe(Object(b.a)(i=>this.hanflerError(i)))}fotoPerfilUsuarioMoto(i,t,o,e){const n={fileKey:"archivo",httpMethod:"PUT",headers:{"x-token":i,"x-id":e},params:{tipo:o}},c=this.transfer.create();return Object(r.a)(c.upload(t,`${p.a}/upload/grupos`,n)).pipe(Object(l.a)(i=>{throw console.log("No se pudo subir la imagen "),new Error("No se pudo subir la imagen ")}))}subirweb(i,t,o){const n={headers:new e.c({"x-token":i,"x-id":o})};return this.http.put(`${p.a}/upload/grupos`,t,n).pipe(Object(b.a)(i=>this.hanflerError(i)))}leerProducto(i,t){const o={headers:new e.c({"x-token":i})};return this.http.put(`${p.a}/grupos/filtrar`,t,o).pipe(Object(b.a)(i=>this.hanflerError(i)))}chat(i,t){const o={headers:new e.c({"x-token":i})};return this.http.put(`${p.a}/grupos/chat`,t,o).pipe(Object(b.a)(i=>this.hanflerError(i)))}descarga(i,t){return this.http.get(`https://api.mapbox.com/directions/v5/mapbox/driving-traffic/${t.coordsIniciales.lng},${t.coordsIniciales.lat};${t.coordsFinales.lng},${t.coordsFinales.lat}?geometries=geojson&steps=true&language=es&access_token=${i}`).pipe(Object(b.a)(i=>this.hanflerError(i)))}dibujar(i,t){return this.http.get(`https://api.mapbox.com/directions/v5/mapbox/driving-traffic/${t.lng},${t.lat};${t.lngf},${t.latf}?geometries=geojson&steps=true&language=es&access_token=${i}`).pipe(Object(b.a)(i=>this.hanflerError(i)))}viaje(i,t){const o={headers:new e.c({"x-token":i})};return this.http.post(`${p.a}/grupos/viajes`,t,o).pipe(Object(b.a)(i=>this.hanflerError(i)))}irgrupo(i,t){const o={headers:new e.c({"x-token":i})};return this.http.put(`${p.a}/grupos/bu`,t,o).pipe(Object(b.a)(i=>this.hanflerError(i)))}podio(i,t){const o={headers:new e.c({"x-token":i})};return this.http.put(`${p.a}/grupos/podio`,t,o).pipe(Object(b.a)(i=>this.hanflerError(i)))}tabla(i,t){const o={headers:new e.c({"x-token":i})};return this.http.put(`${p.a}/grupos/tabla`,t,o).pipe(Object(b.a)(i=>this.hanflerError(i)))}viajechao(i,t){const o={headers:new e.c({"x-token":i})};return this.http.put(`${p.a}/grupos/viajes/eliminar`,t,o).pipe(Object(b.a)(i=>this.hanflerError(i)))}fotospodio(i,t){const o={headers:new e.c({"x-token":i})};return this.http.put(`${p.a}/grupos/podio/fotos`,t,o).pipe(Object(b.a)(i=>this.hanflerError(i)))}viajeBuscarUno(i,t){const o={headers:new e.c({"x-token":i})};return this.http.put(`${p.a}/grupos/buscar`,t,o).pipe(Object(b.a)(i=>this.hanflerError(i)))}viajeBuscar(i,t){const o={headers:new e.c({"x-token":i})};return this.http.put(`${p.a}/grupos/viajes/filtrar`,t,o).pipe(Object(b.a)(i=>this.hanflerError(i)))}fotoviaje(i,t,o){const e={fileKey:"archivo",httpMethod:"PUT",headers:{"x-token":t,"x-viaje":o}},n=this.transfer.create();return Object(r.a)(n.upload(i,`${p.a}/grupos/viaje/upload`,e)).pipe(Object(l.a)(i=>{throw new Error("No se pudo subir la imagen ")}))}subirweb2(i,t,o){const n={headers:new e.c({"x-token":i,"x-viaje":o})};return this.http.put(`${p.a}/grupos/viaje/upload`,t,n).pipe(Object(b.a)(i=>this.hanflerError(i)))}fotosviaje(i,t){const o={headers:new e.c({"x-token":i})};return this.http.put(`${p.a}/grupos/viaje/fotos`,t,o).pipe(Object(b.a)(i=>this.hanflerError(i)))}destino(i,t){const o={headers:new e.c({"x-token":i})};return this.http.put(`${p.a}/grupos/viaje/destino`,t,o).pipe(Object(b.a)(i=>this.hanflerError(i)))}eliminarviaje(i,t){const o={headers:new e.c({"x-token":i})};return this.http.put(`${p.a}/grupos/viaje/eliminar`,t,o).pipe(Object(b.a)(i=>this.hanflerError(i)))}eliminarFoto(i,t){const o={headers:new e.c({"x-token":i})};return this.http.put(`${p.a}/grupos/viaje/eliminarfoto`,t,o).pipe(Object(b.a)(i=>this.hanflerError(i)))}km(i,t){const o={headers:new e.c({"x-token":i})};return this.http.put(`${p.a}/grupos/km`,t,o).pipe(Object(b.a)(i=>this.hanflerError(i)))}}return i.\u0275fac=function(t){return new(t||i)(d.Sb(e.a),d.Sb(u.a),d.Sb(h.a),d.Sb(m.rb))},i.\u0275prov=d.Hb({token:i,factory:i.\u0275fac,providedIn:"root"}),i})()}}]);