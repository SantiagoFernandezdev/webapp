(window.webpackJsonp=window.webpackJsonp||[]).push([[132],{UDvZ:function(e,i,o){"use strict";o.r(i),o.d(i,"CuentaUsuarioPageModule",function(){return k});var t=o("ofXK"),n=o("3Pt+"),a=o("TEn/"),r=o("tyNb"),s=o("mrSG"),c=o("h7Pn"),d=o("fXoL"),l=o("oQG1"),b=o("fsfq"),u=o("fmoy"),h=o("1+ow"),p=o("FlrC"),m=o("3qam"),g=o("2c91"),v=o("8A7y"),f=o("7JkF");function C(e,i){if(1&e&&(d.Ob(0,"div",35),d.wc(1),d.Nb()),2&e){const e=d.Yb();d.Db("brojo",!e.okUsuario)("bverde",e.okUsuario),d.Ab(1),d.xc(e.msgUsuario)}}function O(e,i){if(1&e&&(d.Ob(0,"ion-select-option",36),d.wc(1),d.Nb()),2&e){const e=i.$implicit;d.fc("value",e),d.Ab(1),d.xc(e.nombre)}}function N(e,i){1&e&&(d.Ob(0,"ion-item",24),d.Ob(1,"ion-chip",18),d.wc(2,"Requerido"),d.Nb(),d.Nb())}function x(e,i){if(1&e&&(d.Ob(0,"ion-select-option",36),d.wc(1),d.Nb()),2&e){const e=i.$implicit;d.gc("value",e.nombre),d.Ab(1),d.xc(e.nombre)}}function S(e,i){if(1&e){const e=d.Pb();d.Ob(0,"ion-item",19),d.Ob(1,"ion-label",13),d.wc(2,"Selecciona la ciudad"),d.Nb(),d.Ob(3,"ion-select",20),d.Wb("ionChange",function(i){return d.pc(e),d.Yb().seleccionarCiudad(i)}),d.vc(4,x,2,2,"ion-select-option",21),d.Nb(),d.Nb()}if(2&e){const e=d.Yb();d.Ab(4),d.fc("ngForOf",e.ciudades)}}function M(e,i){if(1&e&&(d.Ob(0,"div",35),d.wc(1),d.Nb()),2&e){const e=d.Yb();d.Db("brojo",!e.okClave)("bverde",e.okClave),d.Ab(1),d.xc(e.msgClave)}}const E=[{path:"",component:(()=>{class e{constructor(e,i,o,t,a,r,s,c,d,l,b,u,h,p,m){this.apiService=e,this.inicioService=i,this.toastService=o,this.router=t,this.navCtrl=a,this.menuCtrl=r,this.conexion=s,this.entradas=c,this.almacenamiento=d,this.registroService=l,this.apiMapas=b,this.modal=u,this.empresa=h,this.socket=p,this.active=m,this.sesion=!0,this.usuarioID="",this.vista=1,this.miCodigo="",this.usuarioValido=!1,this.msgUsuario="",this.okUsuario=!1,this.paises=[],this.ciudades=[],this.ciudad=!1,this.load=!1,this.pais="",this.miciudad="",this.claveValida=!1,this.msgClave="",this.clave="",this.confirClave="",this.correo="",this.tel=0,this.nusuario="",this.ncompleto="",this.okClave=!1,this.negocios=[],this.escogidos=[],this.acepto=!1,this.ur="",this.cr="",this.cod="",this.hab=!1,this.pp=!1,this.cl="",this.ccl="",this.color="danger",this.forma=new n.c({usuario:new n.a("",n.m.required),clave:new n.a("",n.m.required)})}ngOnInit(){}ionViewWillEnter(){this.menuCtrl.enable(!1,"perfil"),this.menuCtrl.close("perfil"),this.listarPaises(),this.comprobarDominio()}comprobarDominio(){return Object(s.a)(this,void 0,void 0,function*(){const e=yield this.almacenamiento.cargaCarro();e&&this.empresa.obtenerDominioSolo({id:e[0].creador}).subscribe(e=>Object(s.a)(this,void 0,void 0,function*(){console.log(e,"existe data"),e.exe&&e.existe&&(this.dominio=e.responde[0].nombre)}),e=>{})})}iniciar(){""!==this.forma.value.usuario&&""!==this.forma.value.clave&&(this.sesion=!1,this.apiService.iniciarPartida(this.forma.value,"web").subscribe(e=>{e.exe?(this.sesion=!0,this.inicioService.cambiarEstado(!1),e.usuarioID=this.usuarioID,this.inicioService.guardarUsuario(e).then(()=>{this.conexion.cargaLista(),this.toastService.alertApplication("Bienvenido!!!",!0).then(()=>{this.router.navigate(["/central/klklk"]),this.entradas.crearEntrada()})},e=>{this.toastService.alertApplication(e.message,!1)})):(this.sesion=!0,this.toastService.alertApplication("Credenciales Incorrectas",!1))},e=>{this.sesion=!0,this.inicioService.cambiarEstado(!0),this.toastService.alertApplication(e.message,!1)}))}ir(){this.vista=2}recuperar(){this.vista=5}retroceder(){this.vista=1}codigo(){this.vista=3}verificar(){""!==this.miCodigo?this.apiService.CodigoComprobar({codigo:this.miCodigo}).subscribe(e=>{e?0===e.response.length?this.toastService.toastError("Ingrese un c\xf3digo v\xe1lido"):(this.vista=4,this.toastService.toastNotificacion("Complete toda la informaci\xf3n")):this.toastService.toastError("No se pudo comprobar el c\xf3digo, int\xe9ntelo m\xe1s tarde")},e=>{this.toastService.toastError("No se pudo comprobar el c\xf3digo, int\xe9ntelo m\xe1s tarde")}):this.toastService.toastError("Ingrese un c\xf3digo v\xe1lido")}validar(){""!==this.cr&&""!==this.ur?this.apiService.Cambio({usuario:this.ur,correo:this.cr}).subscribe(e=>{e.exe?0===e.response.length?this.toastService.toastError("Los datos son incorrectos, por favor verifique la informaci\xf3n registrada"):(this.hab=!0,this.toastService.toastNotificacion("Complete toda la informaci\xf3n")):this.toastService.toastError(e.response?"No puedes recuperar la contrase\xf1a de este usuario por este m\xe9todo.":"No se pudo enviar el c\xf3digo, int\xe9ntelo m\xe1s tarde")},e=>{this.toastService.toastError("No se pudo enviar el c\xf3digo, int\xe9ntelo m\xe1s tarde")}):this.toastService.toastError("Por favor llene los dos campos")}validarCod(){""!==this.cod?this.apiService.Validar({codigo:this.cod}).subscribe(e=>{console.log(e,"tdod"),e.exe?e.resp?(this.hab=!1,this.pp=!0):this.toastService.toastError("C\xf3digo vencido, caduc\xf3 el tiempo de espera de 1 minuto"):(this.toastService.toastError("No se pudo verificar el c\xf3digo, int\xe9ntelo m\xe1s tarde"),this.hab=!1)},e=>{this.toastService.toastError("No se pudo verificar el c\xf3digo, int\xe9ntelo m\xe1s tarde"),this.hab=!1}):this.toastService.toastError("Por favor ingrese el c\xf3digo")}actualizar(){return Object(s.a)(this,void 0,void 0,function*(){this.cl===this.ccl&&""!==this.cl&&""!==this.ccl?(yield this.almacenamiento.obtenerToken())&&this.apiService.editarClaves2({clave:this.ccl,usuario:this.ur}).subscribe(e=>{e.exe?(this.pp=!1,this.vista=1,this.toastService.toastExitoso("Contrase\xf1a actualizada")):this.toastService.toastError("No se pudo actualizar la contrase\xf1a, int\xe9ntelo m\xe1s tarde")},e=>{this.toastService.toastError("No se pudo actualizar la contrase\xf1a, int\xe9ntelo m\xe1s tarde")}):this.toastService.toastError("Las contrase\xf1as no co\xednciden")})}comprobarUsuario(e){e.detail.value.length>5?(this.usuarioValido=!0,this.apiService.usuario(e.detail.value).subscribe(i=>Object(s.a)(this,void 0,void 0,function*(){i.exe?(this.okUsuario=!1,this.msgUsuario="El usuario ya se encuentra en uso"):(this.okUsuario=!0,this.msgUsuario="El nombre de usuario esta disponible",this.nusuario=e.detail.value)}),e=>Object(s.a)(this,void 0,void 0,function*(){this.toastService.toastError("No se pudo comprobar el usuario, int\xe9ntelo m\xe1s tarde")}))):this.usuarioValido=!1}listarPaises(){this.apiService.listarPaises().subscribe(e=>{e.exe?this.paises=e.response:this.paises.push("Colombia")},e=>{this.paises.push("Colombia")})}listarCiudades(e){this.pais=e.detail.value.nombre,this.miciudad="",this.apiService.listarCiudades(e.detail.value._id).subscribe(e=>{e.exe?(this.ciudades=e.response,this.ciudad=!0):this.toastService.toastError("No se pudo traer las ciudades, intente registrarse m\xe1s tarde")},e=>{this.toastService.toastError("No se pudo traer las ciudades, intente registrarse m\xe1s tarde")})}seleccionarCiudad(e){this.miciudad=e.detail.value}comprobarClave(e,i){this.claveValida=!0,e.detail.value.length>=8?(1===i?this.clave=e.detail.value:this.confirClave=e.detail.value,this.clave===this.confirClave?(this.msgClave="Las claves co\xednciden correctamente",this.okClave=!0):(this.msgClave="Las contrase\xf1as no co\xednciden",this.okClave=!1)):(this.okClave=!1,this.msgClave="Debe tener como m\xednmo 8 caracteres")}guardar(){this.okUsuario&&this.okClave&&""!==this.pais&&""!==this.miciudad&&""!==this.ncompleto?this.acepto?this.apiService.registrar({nombreCompleto:this.ncompleto,nombreUsuario:this.nusuario,clave:this.clave,correo:this.correo,tel:this.tel,role:"USER_ROLE",pais:this.pais,ciudad:this.miciudad,tipoNegocio:this.escogidos,usuarioID:this.usuarioID,acepto:this.acepto}).subscribe(e=>{this.almacenamiento.guardarUsuario(e).then(()=>Object(s.a)(this,void 0,void 0,function*(){this.toastService.Especial("Usuario registrado corectamente"),this.registroService.cambioEstado(!0),this.almacenamiento.cambiarEstado(!1);const i=yield this.almacenamiento.cargaCarro();i&&this.empresa.crearPedido(e.token,{productos:i,tipo:"Recoger en la tienda",dominio:this.dominio,empresa:i[0].creador,tienda:i[0].tienda}).subscribe(o=>{console.log(o,"REPUESTA"),o.exe?(this.toastService.Especial("Pedido creado correctamente"),this.socket.emit("conectar",e),this.socket.emit("pedidostienda",{usuario:i[0].creador,body:o.response}),this.router.navigate(["/empresa",this.dominio,"catalogo",i[0].tienda,"pedidos"])):this.toastService.toastError("No se pudo crear el pedido, int\xe9ntelo m\xe1s tarde")},e=>{this.toastService.toastError("No se pudo crear el pedido, int\xe9ntelo m\xe1s tarde")}),this.apiService.EditarCodigo({codigo:this.miCodigo}).subscribe(e=>{})}))},e=>{this.toastService.toastError("No se pudo registrar el usuario, int\xe9ntelo m\xe1s tarde")}):this.toastService.toastError("Debe aceptar las pol\xedticas de la aplicaci\xf3n"):this.toastService.toastError("Existen campos sin diligenciar correctamente")}politicas(){return Object(s.a)(this,void 0,void 0,function*(){const e=yield this.modal.create({component:c.a});yield e.present()})}aceptar(e){this.acepto=e.detail.checked}cerrar(){this.modal.dismiss()}}return e.\u0275fac=function(i){return new(i||e)(d.Lb(l.a),d.Lb(b.a),d.Lb(u.a),d.Lb(r.g),d.Lb(a.rb),d.Lb(a.pb),d.Lb(h.a),d.Lb(p.a),d.Lb(b.a),d.Lb(m.a),d.Lb(g.a),d.Lb(a.qb),d.Lb(v.a),d.Lb(f.a),d.Lb(r.a))},e.\u0275cmp=d.Fb({type:e,selectors:[["app-cuenta-usuario"]],decls:77,vars:9,consts:[[1,"no-border"],[3,"color"],["slot","end"],[3,"click"],["name","close-outline","slot","icon-only"],[1,"ion-padding"],[1,"contenedor"],["lines","none","mode","ios",1,"noborder"],["lines","none","mode","ios"],["type","text","placeholder","Ingrese nombre completo del negocio",1,"privado",3,"ngModel","ngModelChange"],["class","mensaje",3,"brojo","bverde",4,"ngIf"],["type","text","placeholder","Ingrese su nombre de usuario",1,"privado",3,"ionChange"],["lines","none","mode","md",1,"noborder","ion-margin-top"],[1,"ion-text-wrap"],["lines","none","mode","ios",1,"campo","ion-margin-top"],["placeholder","Correo Electr\xf3nico","type","email",3,"ngModel","ngModelChange"],["placeholder","N\xfamero de Celular","type","tel",3,"ngModel","ngModelChange"],["lines","none","mode","md",1,"noborder","ion-margin-top","sinfondo"],["color","danger"],["lines","none","mode","md",1,"noborder"],["okText","Aceptar","cancelText","Cancelar",3,"ionChange"],[3,"value",4,"ngFor","ngForOf"],["lines","none","class","noborder sinfondo","mode","md",4,"ngIf"],["lines","none","class"," noborder","mode","md",4,"ngIf"],["lines","none","mode","md",1,"noborder","sinfondo"],["type","password","placeholder","Escriba su contrase\xf1a",3,"ionChange"],["lines","none","mode","ios",1,"noborder","ion-margin-top"],["type","password","placeholder","Confirmar la contrase\xf1a",3,"ionChange"],["lines","none","mode","md",1,"noborder","sinfondo","ion-margin-top",3,"click"],[1,"ion-text-wrap","azul"],["lines","none","color","light","mode","md",1,"noborder"],["color","barra","slot","start",3,"ionChange"],[1,"flexbet"],["expand","block","color","danger","mode","ios","fill","outline","shape","round",3,"click"],["expand","block","color","light","mode","ios","shape","round",3,"click"],[1,"mensaje"],[3,"value"]],template:function(e,i){1&e&&(d.Ob(0,"ion-header",0),d.Ob(1,"ion-toolbar",1),d.Ob(2,"ion-title"),d.wc(3,"Ultimo paso"),d.Nb(),d.Ob(4,"ion-buttons",2),d.Ob(5,"ion-button",3),d.Wb("click",function(){return i.cerrar()}),d.Mb(6,"ion-icon",4),d.Nb(),d.Nb(),d.Nb(),d.Nb(),d.Ob(7,"ion-content",5),d.Ob(8,"div",6),d.Ob(9,"h3"),d.wc(10,"Crea una cuenta rapidamente"),d.Nb(),d.Ob(11,"p"),d.wc(12,"Solo realizas este paso si no tienes una cuenta"),d.Nb(),d.Ob(13,"ion-list"),d.Ob(14,"ion-item",7),d.Ob(15,"ion-label"),d.wc(16,"Nombre Completo"),d.Nb(),d.Nb(),d.Ob(17,"ion-item",8),d.Ob(18,"ion-input",9),d.Wb("ngModelChange",function(e){return i.ncompleto=e}),d.Nb(),d.Nb(),d.Mb(19,"br"),d.vc(20,C,2,5,"div",10),d.Ob(21,"ion-item",7),d.Ob(22,"ion-label"),d.wc(23,"Nombre usuario"),d.Nb(),d.Nb(),d.Ob(24,"ion-item",8),d.Ob(25,"ion-input",11),d.Wb("ionChange",function(e){return i.comprobarUsuario(e)}),d.Nb(),d.Nb(),d.Mb(26,"br"),d.Ob(27,"ion-item",12),d.Ob(28,"ion-label",13),d.wc(29,"Escriba su correo electr\xf3nico (opcional)"),d.Nb(),d.Nb(),d.Ob(30,"ion-item",14),d.Ob(31,"ion-input",15),d.Wb("ngModelChange",function(e){return i.correo=e}),d.Nb(),d.Nb(),d.Ob(32,"ion-item",12),d.Ob(33,"ion-label",13),d.wc(34,"Escriba su tel\xe9fono celular (opcional)"),d.Nb(),d.Nb(),d.Ob(35,"ion-item",14),d.Ob(36,"ion-input",16),d.Wb("ngModelChange",function(e){return i.tel=e}),d.Nb(),d.Nb(),d.Ob(37,"ion-item",17),d.Ob(38,"ion-chip",18),d.wc(39,"Requerido"),d.Nb(),d.Nb(),d.Ob(40,"ion-item",19),d.Ob(41,"ion-label",13),d.wc(42,"Selecciona el Pa\xeds"),d.Nb(),d.Ob(43,"ion-select",20),d.Wb("ionChange",function(e){return i.listarCiudades(e)}),d.vc(44,O,2,2,"ion-select-option",21),d.Nb(),d.Nb(),d.vc(45,N,3,0,"ion-item",22),d.vc(46,S,5,1,"ion-item",23),d.Mb(47,"br"),d.Ob(48,"ion-item",24),d.Ob(49,"ion-chip",18),d.wc(50,"Requerido"),d.Nb(),d.Nb(),d.vc(51,M,2,5,"div",10),d.Ob(52,"ion-item",12),d.Ob(53,"ion-label",13),d.wc(54,"Escriba su contrase\xf1a"),d.Nb(),d.Nb(),d.Ob(55,"ion-item",14),d.Ob(56,"ion-input",25),d.Wb("ionChange",function(e){return i.comprobarClave(e,1)}),d.Nb(),d.Nb(),d.Ob(57,"ion-item",26),d.Ob(58,"ion-label",13),d.wc(59,"Confirmar la contrase\xf1a"),d.Nb(),d.Nb(),d.Ob(60,"ion-item",14),d.Ob(61,"ion-input",27),d.Wb("ionChange",function(e){return i.comprobarClave(e,2)}),d.Nb(),d.Nb(),d.Mb(62,"br"),d.Ob(63,"ion-item",28),d.Wb("click",function(){return i.politicas()}),d.Ob(64,"ion-label",29),d.wc(65,"Leer pol\xedticas de datos"),d.Nb(),d.Nb(),d.Ob(66,"ion-item",30),d.Ob(67,"ion-checkbox",31),d.Wb("ionChange",function(e){return i.aceptar(e)}),d.Nb(),d.Ob(68,"ion-label",13),d.wc(69,"Acepto pol\xedticas de datos"),d.Nb(),d.Nb(),d.Mb(70,"br"),d.Mb(71,"br"),d.Ob(72,"div",32),d.Ob(73,"ion-button",33),d.Wb("click",function(){return i.ir()}),d.wc(74,"Cancelar"),d.Nb(),d.Ob(75,"ion-button",34),d.Wb("click",function(){return i.guardar()}),d.wc(76,"Crear Cuenta"),d.Nb(),d.Nb(),d.Nb(),d.Nb(),d.Nb()),2&e&&(d.Ab(1),d.fc("color",i.color),d.Ab(17),d.fc("ngModel",i.ncompleto),d.Ab(2),d.fc("ngIf",i.usuarioValido),d.Ab(11),d.fc("ngModel",i.correo),d.Ab(5),d.fc("ngModel",i.tel),d.Ab(8),d.fc("ngForOf",i.paises),d.Ab(1),d.fc("ngIf",i.ciudad),d.Ab(1),d.fc("ngIf",i.ciudad),d.Ab(5),d.fc("ngIf",i.claveValida))},directives:[a.z,a.lb,a.jb,a.k,a.j,a.A,a.t,a.L,a.F,a.K,a.E,a.yb,n.i,n.k,t.j,a.r,a.X,a.xb,t.i,a.q,a.d,a.Y],styles:[".contenedor[_ngcontent-%COMP%]{width:50px auto;max-width:80%;margin:50px auto}ion-button[_ngcontent-%COMP%]{--padding-top:20px;--padding-end:15px;--padding-start:15px;--padding-bottom:20px}.azul[_ngcontent-%COMP%]{color:#005a8c}.load[_ngcontent-%COMP%]{margin-top:10px;width:100%;display:flex;flex-direction:column;justify-content:center;align-items:center}.load[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:16px;opacity:.7}ion-item[_ngcontent-%COMP%]{border:1px solid rgba(0,0,0,.3);margin-bottom:8px}.noborder[_ngcontent-%COMP%]{border:0}.margen[_ngcontent-%COMP%]{margin-bottom:35px}.centrar[_ngcontent-%COMP%]{justify-content:center}.centrar[_ngcontent-%COMP%], .flexbet[_ngcontent-%COMP%], ion-card[_ngcontent-%COMP%]{display:flex}ion-card[_ngcontent-%COMP%]{width:calc(100% - 20px);margin:10px;flex-direction:column;justify-content:center;align-items:center;transition:all .5s}ion-card[_ngcontent-%COMP%]   ion-card-title[_ngcontent-%COMP%]{font-size:22px;text-align:center}ion-card[_ngcontent-%COMP%]   ion-card-header[_ngcontent-%COMP%]{text-align:center;padding:5px}.privado[_ngcontent-%COMP%]{border:0!important}.privado[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{border-radius:100px;background-color:#faebd7}.flexbet[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]{width:50%}.mensaje[_ngcontent-%COMP%], .texto[_ngcontent-%COMP%]{background-color:#fbf6d8;padding:10px;border-radius:10px}.brojo[_ngcontent-%COMP%]{background:#f3c5c1;color:#93372f}.bverde[_ngcontent-%COMP%]{background:#c4e4c5;color:#4eaf52}h3[_ngcontent-%COMP%]{padding:10px;background:#fef1bd}"]}),e})()}];let w=(()=>{class e{}return e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=d.Jb({type:e}),e.\u0275inj=d.Ib({imports:[[r.j.forChild(E)],r.j]}),e})(),k=(()=>{class e{}return e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=d.Jb({type:e}),e.\u0275inj=d.Ib({imports:[[t.b,n.e,a.mb,w]]}),e})()}}]);