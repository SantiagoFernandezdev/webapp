(window.webpackJsonp=window.webpackJsonp||[]).push([[45],{oQG1:function(e,t,i){"use strict";i.d(t,"a",function(){return g});var o=i("tk/3"),s=i("PqYM"),a=i("Cfvw"),n=i("coGc"),r=i("lJxs"),c=i("IzEk"),l=i("MtjB"),d=i("JIr8"),b=i("AytR"),h=i("fXoL"),u=i("B7Rs"),p=i("fsfq"),m=i("TEn/");let g=(()=>{class e{constructor(e,t,i,o){this.http=e,this.transfer=t,this.almacenamiento=i,this.navCtrl=o}hanflerError(e){let t=0;return e.pipe(Object(n.a)(()=>Object(s.a)(5e3)),Object(r.a)(e=>{if(t++,console.log("Entramos a intentos"),e instanceof ErrorEvent){if(3===t)throw new Error("Error de Red")}else{if(!(e instanceof ProgressEvent))throw 404===e.status?new Error(" al realizar la solicictud "):401===e.status?(this.almacenamiento.terminarPartida().then(()=>{this.navCtrl.navigateRoot("/home")}),new Error("No tiene permisos para realizar la petici\xf3n ")):(console.log(e,"Error de servidor"),new Error(" No se pudo realizar la petici\xf3n, intentalo m\xe1s tarde "));if(3===t)throw new Error("Error de Red")}}),Object(c.a)(3))}registrar(e){return this.http.post(`${b.a}/usuarios`,e).pipe(Object(r.a)(e=>e.exe?(e.response.exe=e.exe,e.response.token=e.token,e.response):e),Object(l.a)(e=>this.hanflerError(e)))}usuario(e){return this.http.post(`${b.a}/usuarios/unico`,{buscar:e}).pipe(Object(l.a)(e=>this.hanflerError(e)))}iniciarPartida(e,t){const i={headers:new o.c({"x-dispositivoID":t})};return this.http.post(`${b.a}/login`,e,i).pipe(Object(r.a)(e=>(console.log(e),e.exe?(e.response.exe=e.exe,e.response.token=e.token,e.response):e.exe)),Object(l.a)(e=>this.hanflerError(e)))}fotoPerfilUsuarioMoto(e,t,i){const o={fileKey:"archivo",httpMethod:"PUT",headers:{"x-token":t},params:{tipo:i}},s=this.transfer.create();return Object(a.a)(s.upload(e,`${b.a}/upload`,o)).pipe(Object(d.a)(e=>{throw console.log("No se pudo subir la imagen "),new Error("No se pudo subir la imagen ")}))}fotoPortada(e,t,i){const o={fileKey:"archivo",httpMethod:"PUT",headers:{"x-token":t},params:{old:i}},s=this.transfer.create();return Object(a.a)(s.upload(e,`${b.a}/upload/portada/`,o)).pipe(Object(d.a)(e=>{throw console.log("No se pudo subir la imagen "),new Error("No se pudo subir la imagen ")}))}viewImagen(e){const t={headers:new o.c({"x-token":e})};return this.http.get(`${b.a}/ver`,t).pipe(Object(l.a)(e=>this.hanflerError(e)))}buscarUsuario(e,t){const i={headers:new o.c({"x-token":t})};return this.http.get(`${b.a}/usuarios/${e}`,i).pipe(Object(l.a)(e=>this.hanflerError(e)))}cerrar(e){const t={headers:new o.c({"x-token":e})};return this.http.put(`${b.a}/usuarios/cerrar/`,{},t).pipe(Object(l.a)(e=>this.hanflerError(e)))}usuarioDatos(e){const t={headers:new o.c({"x-token":e})};return this.http.put(`${b.a}/usuarios/uno/`,{},t).pipe(Object(l.a)(e=>this.hanflerError(e)))}editarUusuario(e,t){const i={headers:new o.c({"x-token":e})};return this.http.put(`${b.a}/usuarios/editar/uno/`,t,i).pipe(Object(l.a)(e=>this.hanflerError(e)))}buscarPerfilUsuario(e,t){const i={headers:new o.c({"x-token":t})};return this.http.get(`${b.a}/usuarios/perfil/${e}`,i).pipe(Object(l.a)(e=>this.hanflerError(e)))}traerMisNotificaciones(e,t){const i={headers:new o.c({"x-token":e,"x-desde":t.toString()})};return this.http.get(`${b.a}/notificaciones/misnotificaciones/`,i).pipe(Object(l.a)(e=>this.hanflerError(e)))}notiCantidad(e){const t={headers:new o.c({"x-token":e})};return this.http.get(`${b.a}/notificaciones/numero/`,t).pipe(Object(l.a)(e=>this.hanflerError(e)))}ActualizarNotificaciones(e,t){const i={headers:new o.c({"x-token":e})};return this.http.put(`${b.a}/notificaciones/misnotificaciones/cambiarestado/`,{id:t},i).pipe(Object(l.a)(e=>this.hanflerError(e)))}validarClave(e,t){const i={headers:new o.c({"x-token":e})};return this.http.put(`${b.a}/usuarios/claves/`,t,i).pipe(Object(l.a)(e=>this.hanflerError(e)))}editarClaves(e,t){const i={headers:new o.c({"x-token":e})};return this.http.put(`${b.a}/usuarios/claves/editar`,t,i).pipe(Object(l.a)(e=>this.hanflerError(e)))}editarClaves2(e){return this.http.put(`${b.a}/usuarios/claves/editar/dos`,e).pipe(Object(l.a)(e=>this.hanflerError(e)))}listarPaises(){return this.http.get(`${b.a}/paises`).pipe(Object(l.a)(e=>this.hanflerError(e)))}listarCiudades(e){const t={headers:new o.c({"x-pais":e})};return this.http.get(`${b.a}/ciudad`,t).pipe(Object(l.a)(e=>this.hanflerError(e)))}CodigoComprobar(e){return this.http.put(`${b.a}/codigos`,e).pipe(Object(l.a)(e=>this.hanflerError(e)))}EditarCodigo(e){return this.http.put(`${b.a}/codigos/cambiar`,e).pipe(Object(l.a)(e=>this.hanflerError(e)))}negocios(){return this.http.get(`${b.a}/tiponegocio`).pipe(Object(l.a)(e=>this.hanflerError(e)))}modulos(e){const t={headers:new o.c({"x-token":e})};return this.http.get(`${b.a}/modulos`,t).pipe(Object(l.a)(e=>this.hanflerError(e)))}modulosTALLER(e,t){const i={headers:new o.c({"x-token":e})};return this.http.post(`${b.a}/modulos`,t,i).pipe(Object(l.a)(e=>this.hanflerError(e)))}Cambio(e){return this.http.post(`${b.a}/cambio`,e).pipe(Object(l.a)(e=>this.hanflerError(e)))}Validar(e){return this.http.put(`${b.a}/cambio`,e).pipe(Object(l.a)(e=>this.hanflerError(e)))}}return e.\u0275fac=function(t){return new(t||e)(h.Qb(o.a),h.Qb(u.a),h.Qb(p.a),h.Qb(m.pb))},e.\u0275prov=h.Fb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})()},qfE0:function(e,t,i){"use strict";i.r(t),i.d(t,"SedesMapaPageModule",function(){return T});var o=i("ofXK"),s=i("3Pt+"),a=i("TEn/"),n=i("tyNb"),r=i("mrSG"),c=i("fXoL"),l=i("fsfq"),d=i("2c91"),b=i("oQG1"),h=i("fmoy"),u=i("Bfh1");const p=["mapa"];function m(e,t){if(1&e){const e=c.Nb();c.Mb(0,"ion-button",3),c.Ub("click",function(){return c.lc(e),c.Wb().guardar2()}),c.Kb(1,"ion-icon",7),c.Lb()}}let g=(()=>{class e{constructor(e,t,i,o,s,a,n){this.almacenamiento=e,this.alertCtrl=t,this.apiMapas=i,this.apiUsuario=o,this.toastService=s,this.geoReferencia=a,this.modalCtrl=n,this.mensaje="",this.draggable=!0}ngOnInit(){}ionViewWillEnter(){this.primero||this.editable?this.configurar():(this.draggable=!1,setTimeout(()=>{this.graficar()},1e3))}cerrar(){this.modalCtrl.dismiss()}calcular(){return Object(r.a)(this,void 0,void 0,function*(){try{const e=yield this.geoReferencia.getCurrentPosition({enableHighAccuracy:!0,timeout:2e4});e&&(this.lat=e.coords.latitude,this.lng=e.coords.longitude,this.graficar())}catch(e){this.mensaje=e,this.toastService.toastError("No se pudo captruar su ubicaci\xf3n, verifique que el GPS este prendido o int\xe9ntelo m\xe1s tarde"),this.modalCtrl.dismiss()}})}configurar(){""!==this.ncompleto&&""!==this.pais&&""!==this.miciudad&&this.escogidos.length>0&&""!==this.de&&""!==this.a&&""!==this.desde&&""!==this.hasta?this.editable?setTimeout(()=>{this.graficar()},1e3):this.calcular():this.toastService.toastError("Hay datos que no se han diligenciado correctamente")}graficar(){mapboxgl.accessToken="pk.eyJ1Ijoic2FudGlhZ29mZXJuYW5kZXpkZXYiLCJhIjoiY2tmYmh6cXdzMDM0bDJ2cHRucTI4cHpkaSJ9.-01EYvsLdJOU1Oy4BtwBwA";const e=new mapboxgl.Map({container:this.mapa.nativeElement,style:"mapbox://styles/mapbox/streets-v11",center:[this.lng,this.lat],zoom:15});e.addControl(new mapboxgl.NavigationControl);const t=document.createElement("div");t.className="marker",t.style.backgroundImage="url("+this.imagen+")",t.style.backgroundSize="100%",t.style.width="50px",t.style.height="50px";const i=new mapboxgl.Marker({element:t,draggable:this.draggable}).setLngLat([this.lng,this.lat]).addTo(e);i.on("dragend",()=>{const e=i.getLngLat();this.lat=e.lat,this.lng=e.lng})}guardar2(){this.primero&&!this.editable?this.guardar():this.editable&&this.editarGuardar()}editarGuardar(){return Object(r.a)(this,void 0,void 0,function*(){const e=yield this.almacenamiento.obtenerToken();e&&this.apiMapas.editarSede(e.token,{ubicacion:{lat:this.lat,lng:this.lng},nombre:this.ncompleto,tipo:this.escogidos,pais:this.pais,ciudad:this.miciudad,_id:this.id,desde:this.desde,hasta:this.hasta,de:this.de,a:this.a}).subscribe(e=>{e.exe?this.toastService.toastExitoso("Sede editada"):this.toastService.toastError("No se pudo editar la sede, int\xe9ntelo m\xe1s tarde"),this.modalCtrl.dismiss()},e=>{this.modalCtrl.dismiss(),this.toastService.toastError("No se pudo editar la sede, int\xe9ntelo m\xe1s tarde")})})}guardar(){return Object(r.a)(this,void 0,void 0,function*(){const e=yield this.almacenamiento.obtenerToken();e&&this.apiMapas.crearSede(e.token,{ubicacion:{lat:this.lat,lng:this.lng},nombre:this.ncompleto,tipo:this.escogidos,pais:this.pais,ciudad:this.miciudad,desde:this.desde,hasta:this.hasta,de:this.de,a:this.a}).subscribe(e=>{e?this.toastService.toastExitoso("Sede creada"):this.toastService.toastError("No se pudo crear la sede, int\xe9ntelo m\xe1s tarde"),this.modalCtrl.dismiss()},e=>{this.modalCtrl.dismiss(),this.toastService.toastError("No se pudo crear la sede, int\xe9ntelo m\xe1s tarde")})})}}return e.\u0275fac=function(t){return new(t||e)(c.Jb(l.a),c.Jb(a.b),c.Jb(d.a),c.Jb(b.a),c.Jb(h.a),c.Jb(u.a),c.Jb(a.ob))},e.\u0275cmp=c.Db({type:e,selectors:[["app-mapaeditable"]],viewQuery:function(e,t){if(1&e&&c.vc(p,1),2&e){let e;c.kc(e=c.Vb())&&(t.mapa=e.first)}},inputs:{lng:"lng",lat:"lat",ncompleto:"ncompleto",pais:"pais",miciudad:"miciudad",escogidos:"escogidos",de:"de",a:"a",desde:"desde",hasta:"hasta",editable:"editable",primero:"primero",id:"id",imagen:"imagen",imagenLocal:"imagenLocal"},decls:11,vars:1,consts:[["color","oscuro"],["slot","end"],[3,"click",4,"ngIf"],[3,"click"],["name","close-outline","slot","icon-only"],[1,"mapa"],["mapa",""],["name","checkmark-outline","slot","icon-only"]],template:function(e,t){1&e&&(c.Mb(0,"ion-header"),c.Mb(1,"ion-toolbar",0),c.Mb(2,"ion-title"),c.rc(3,"Mapa"),c.Lb(),c.Mb(4,"ion-buttons",1),c.qc(5,m,2,0,"ion-button",2),c.Mb(6,"ion-button",3),c.Ub("click",function(){return t.cerrar()}),c.Kb(7,"ion-icon",4),c.Lb(),c.Lb(),c.Lb(),c.Lb(),c.Mb(8,"ion-content"),c.Kb(9,"div",5,6),c.Lb()),2&e&&(c.zb(5),c.dc("ngIf",t.editable||t.primero))},directives:[a.z,a.jb,a.hb,a.k,o.j,a.j,a.A,a.t],styles:[".mapa[_ngcontent-%COMP%]{width:100%;height:100%}"]}),e})();const f=["mapa"];function v(e,t){if(1&e){const e=c.Nb();c.Mb(0,"ion-button",5),c.Ub("click",function(){return c.lc(e),c.Wb().retroceder()}),c.Kb(1,"ion-icon",6),c.Lb()}}function M(e,t){if(1&e){const e=c.Nb();c.Mb(0,"ion-item-sliding"),c.Mb(1,"ion-item",5),c.Ub("click",function(){c.lc(e);const i=t.$implicit;return c.Wb(2).ver(i)}),c.Mb(2,"ion-avatar",12),c.Kb(3,"img",13),c.Lb(),c.Mb(4,"ion-label",14),c.Mb(5,"div"),c.rc(6),c.Lb(),c.Mb(7,"div",15),c.Mb(8,"strong"),c.rc(9,"Pais: "),c.Lb(),c.rc(10),c.Lb(),c.Mb(11,"div",15),c.Mb(12,"strong"),c.rc(13,"Ciudad: "),c.Lb(),c.rc(14),c.Lb(),c.Lb(),c.Lb(),c.Mb(15,"ion-item-options",16),c.Mb(16,"ion-item-option",17),c.Ub("click",function(){c.lc(e);const i=t.$implicit,o=t.index;return c.Wb(2).editar(i,o)}),c.Kb(17,"ion-icon",18),c.Lb(),c.Mb(18,"ion-item-option",19),c.Ub("click",function(){c.lc(e);const i=t.$implicit,o=t.index;return c.Wb(2).eliminar(i,o)}),c.Kb(19,"ion-icon",20),c.Lb(),c.Lb(),c.Lb()}if(2&e){const e=t.$implicit;c.zb(6),c.sc(e.nombre),c.zb(4),c.tc(" ",e.pais," "),c.zb(4),c.tc(" ",e.ciudad," ")}}function L(e,t){if(1&e){const e=c.Nb();c.Mb(0,"div",7),c.Mb(1,"ion-list"),c.qc(2,M,20,3,"ion-item-sliding",8),c.Lb(),c.Mb(3,"ion-fab",9),c.Mb(4,"ion-fab-button",10),c.Ub("click",function(){return c.lc(e),c.Wb().crear()}),c.Kb(5,"ion-icon",11),c.Lb(),c.Lb(),c.Lb()}if(2&e){const e=c.Wb();c.zb(2),c.dc("ngForOf",e.sedes)}}function k(e,t){if(1&e){const e=c.Nb();c.Mb(0,"ion-item",44),c.Mb(1,"ion-checkbox",45),c.Ub("ionChange",function(t){return c.lc(e),c.Wb(2).agregarNegocios(t)}),c.Lb(),c.Mb(2,"ion-label"),c.rc(3),c.Lb(),c.Lb()}if(2&e){const e=t.$implicit;c.zb(1),c.ec("value",e.nombre),c.dc("checked",e.checked),c.zb(2),c.sc(e.nombre)}}function C(e,t){if(1&e&&(c.Mb(0,"ion-select-option",48),c.rc(1),c.Lb()),2&e){const e=t.$implicit;c.dc("value",e),c.zb(1),c.sc(e.nombre)}}function E(e,t){if(1&e){const e=c.Nb();c.Mb(0,"ion-select",46),c.Ub("ionChange",function(t){return c.lc(e),c.Wb(2).listarCiudades(t)}),c.qc(1,C,2,2,"ion-select-option",47),c.Lb()}if(2&e){const e=c.Wb(2);c.zb(1),c.dc("ngForOf",e.paises)}}function x(e,t){if(1&e&&(c.Mb(0,"ion-select-option",48),c.rc(1),c.Lb()),2&e){const e=t.$implicit;c.dc("value",e),c.zb(1),c.sc(e.nombre)}}function O(e,t){if(1&e){const e=c.Nb();c.Mb(0,"ion-select",49),c.Ub("ionChange",function(t){return c.lc(e),c.Wb(2).listarCiudades(t)}),c.qc(1,x,2,2,"ion-select-option",47),c.Lb()}if(2&e){const e=c.Wb(2);c.dc("value",e.paiss),c.zb(1),c.dc("ngForOf",e.paises)}}function w(e,t){1&e&&(c.Mb(0,"div",50),c.Kb(1,"br"),c.Kb(2,"ion-spinner",51),c.rc(3," Cargando Ciudades... "),c.Lb())}function j(e,t){if(1&e&&(c.Mb(0,"ion-select-option",48),c.rc(1),c.Lb()),2&e){const e=t.$implicit;c.ec("value",e.nombre),c.zb(1),c.sc(e.nombre)}}function y(e,t){if(1&e){const e=c.Nb();c.Mb(0,"ion-select",46),c.Ub("ionChange",function(t){return c.lc(e),c.Wb(3).seleccionarCiudad(t)}),c.qc(1,j,2,2,"ion-select-option",47),c.Lb()}if(2&e){const e=c.Wb(3);c.zb(1),c.dc("ngForOf",e.ciudades)}}function S(e,t){if(1&e&&(c.Mb(0,"ion-select-option",48),c.rc(1),c.Lb()),2&e){const e=t.$implicit;c.ec("value",e.nombre),c.zb(1),c.sc(e.nombre)}}function z(e,t){if(1&e){const e=c.Nb();c.Mb(0,"ion-select",49),c.Ub("ionChange",function(t){return c.lc(e),c.Wb(3).seleccionarCiudad(t)}),c.qc(1,S,2,2,"ion-select-option",47),c.Lb()}if(2&e){const e=c.Wb(3);c.dc("value",e.miciudad),c.zb(1),c.dc("ngForOf",e.ciudades)}}function N(e,t){if(1&e&&(c.Mb(0,"ion-item",26),c.Mb(1,"ion-label",14),c.rc(2,"Selecciona la ciudad"),c.Lb(),c.qc(3,y,2,1,"ion-select",27),c.qc(4,z,2,2,"ion-select",28),c.Lb()),2&e){const e=c.Wb(2);c.zb(3),c.dc("ngIf",!e.editable),c.zb(1),c.dc("ngIf",e.editable)}}function $(e,t){if(1&e){const e=c.Nb();c.Mb(0,"div",7),c.Mb(1,"ion-list"),c.Mb(2,"ion-item",21),c.Mb(3,"ion-label"),c.rc(4,"Nombre de la Sede"),c.Lb(),c.Lb(),c.Mb(5,"ion-item",22),c.Mb(6,"ion-input",23),c.Ub("ngModelChange",function(t){return c.lc(e),c.Wb().ncompleto=t}),c.Lb(),c.Lb(),c.Kb(7,"br"),c.Mb(8,"ion-item",24),c.Mb(9,"ion-label",14),c.rc(10,"Tipo de negocio"),c.Lb(),c.Lb(),c.qc(11,k,4,3,"ion-item",25),c.Kb(12,"br"),c.Mb(13,"ion-item",26),c.Mb(14,"ion-label",14),c.rc(15,"Selecciona el Pa\xeds"),c.Lb(),c.qc(16,E,2,1,"ion-select",27),c.qc(17,O,2,2,"ion-select",28),c.Lb(),c.qc(18,w,4,0,"div",29),c.qc(19,N,5,2,"ion-item",30),c.Kb(20,"br"),c.Mb(21,"ion-item-divider",31),c.Mb(22,"ion-label"),c.rc(23,"Horario de atenci\xf3n"),c.Lb(),c.Lb(),c.Mb(24,"ion-item",32),c.Mb(25,"ion-label"),c.rc(26,"Desde"),c.Lb(),c.Mb(27,"ion-datetime",33),c.Ub("ionChange",function(t){return c.lc(e),c.Wb().horario(t,"desde")}),c.Lb(),c.Lb(),c.Mb(28,"ion-item",32),c.Mb(29,"ion-label"),c.rc(30,"Hasta"),c.Lb(),c.Mb(31,"ion-datetime",33),c.Ub("ionChange",function(t){return c.lc(e),c.Wb().horario(t,"hasta")}),c.Lb(),c.Lb(),c.Mb(32,"ion-item-divider",34),c.Mb(33,"ion-label"),c.rc(34,"D\xedas de atenci\xf3n"),c.Lb(),c.Lb(),c.Mb(35,"ion-item",32),c.Mb(36,"strong"),c.rc(37,"De"),c.Lb(),c.Mb(38,"ion-select",35),c.Ub("ionChange",function(t){return c.lc(e),c.Wb().dias(t,"de")}),c.Mb(39,"ion-select-option",36),c.rc(40,"Lunes"),c.Lb(),c.Mb(41,"ion-select-option",37),c.rc(42,"Martes"),c.Lb(),c.Mb(43,"ion-select-option",38),c.rc(44,"Mi\xe9rcoles"),c.Lb(),c.Mb(45,"ion-select-option",39),c.rc(46,"Jueves"),c.Lb(),c.Mb(47,"ion-select-option",40),c.rc(48,"Viernes"),c.Lb(),c.Mb(49,"ion-select-option",41),c.rc(50,"S\xe1bado"),c.Lb(),c.Mb(51,"ion-select-option",42),c.rc(52,"Domingo"),c.Lb(),c.Lb(),c.Kb(53,"br"),c.Mb(54,"strong"),c.rc(55,"A"),c.Lb(),c.Mb(56,"ion-select",35),c.Ub("ionChange",function(t){return c.lc(e),c.Wb().dias(t,"a")}),c.Mb(57,"ion-select-option",36),c.rc(58,"Lunes"),c.Lb(),c.Mb(59,"ion-select-option",37),c.rc(60,"Martes"),c.Lb(),c.Mb(61,"ion-select-option",38),c.rc(62,"Mi\xe9rcoles"),c.Lb(),c.Mb(63,"ion-select-option",39),c.rc(64,"Jueves"),c.Lb(),c.Mb(65,"ion-select-option",40),c.rc(66,"Viernes"),c.Lb(),c.Mb(67,"ion-select-option",41),c.rc(68,"S\xe1bado"),c.Lb(),c.Mb(69,"ion-select-option",42),c.rc(70,"Domingo"),c.Lb(),c.Lb(),c.Lb(),c.Mb(71,"ion-button",43),c.Ub("click",function(){return c.lc(e),c.Wb().configurar()}),c.rc(72,"Crear Sede"),c.Lb(),c.Lb(),c.Lb()}if(2&e){const e=c.Wb();c.zb(6),c.dc("ngModel",e.ncompleto),c.zb(5),c.dc("ngForOf",e.negocios),c.zb(5),c.dc("ngIf",!e.editable),c.zb(1),c.dc("ngIf",e.editable),c.zb(1),c.dc("ngIf",e.cargando),c.zb(1),c.dc("ngIf",e.ciudad),c.zb(8),c.dc("value",e.desde),c.zb(4),c.dc("value",e.hasta),c.zb(7),c.dc("value",e.de),c.zb(18),c.dc("value",e.a)}}const I=[{path:"",component:(()=>{class e{constructor(e,t,i,o,s,a,n){this.almacenamiento=e,this.alertCtrl=t,this.apiMapas=i,this.apiUsuario=o,this.toastService=s,this.geoReferencia=a,this.modalCtrl=n,this.cargando=!1,this.primero=!1,this.vista=3,this.negocios=[],this.paises=[],this.ciudades=[],this.pais="",this.paiss="",this.miciudad="",this.escogidos=[],this.ciudad=!1,this.ncompleto="",this.sedes=[],this.imagen="",this.lat=0,this.lng=0,this.mensaje="",this.draggable=!0,this.editable=!1,this.id="",this.imagenLocal="",this.hasta="",this.desde="",this.de="",this.a=""}ngOnInit(){}ionViewWillEnter(){this.vista=1,this.listarPaises(),this.listarNegocios(),this.traerSedes(),this.llamarFoto()}llamarFoto(){return Object(r.a)(this,void 0,void 0,function*(){const e=yield this.almacenamiento.obtenerToken();e&&this.apiUsuario.viewImagen(e.token).subscribe(e=>{this.imagen=`https://motocaliapp.com/${e.paquete}`,this.imagenLocal=e.paquete},e=>{})})}traerSedes(){return Object(r.a)(this,void 0,void 0,function*(){const e=yield this.almacenamiento.obtenerToken();e&&this.apiMapas.traerSedes(e.token,{}).subscribe(e=>{e?this.sedes=e.response:this.toastService.toastError("No se pudo traer las sedes, int\xe9ntelo m\xe1s tarde")},e=>{this.toastService.toastError("No se pudo traer las sedes, int\xe9ntelo m\xe1s tarde")})})}listarNegocios(){this.apiUsuario.negocios().subscribe(e=>{e.exe?(e.response.forEach(e=>{e.checked=!1}),this.negocios=e.response):this.negocios.push("Taller M\xe9canico")},e=>{this.negocios.push("Taller M\xe9canico")})}listarPaises(){this.apiUsuario.listarPaises().subscribe(e=>{e.exe?this.paises=e.response:this.paises.push("Colombia")},e=>{this.paises.push("Colombia")})}listarCiudades(e,t){this.pais=e.detail.value.nombre,this.miciudad="",this.cargando=!0,this.apiUsuario.listarCiudades(e.detail.value._id).subscribe(e=>{e.exe?(this.ciudades=e.response,this.ciudad=!0):this.toastService.toastError("No se pudo traer las ciudades, intente registrarse m\xe1s tarde"),this.cargando=!1},e=>{this.toastService.toastError("No se pudo traer las ciudades, intente registrarse m\xe1s tarde"),this.cargando=!1})}seleccionarCiudad(e){this.miciudad=e.detail.value}agregarNegocios(e){e.detail.checked?this.escogidos.find(t=>t===e.detail.value)||this.escogidos.push(e.detail.value):this.escogidos=this.escogidos.filter(t=>t!==e.detail.value)}configurar(){""!==this.ncompleto&&""!==this.pais&&""!==this.miciudad&&this.escogidos.length>0&&""!==this.de&&""!==this.a&&""!==this.desde&&""!==this.hasta?(this.vista=3,this.primero=!0,this.abrirModal()):this.toastService.toastError("Hay datos que no se han diligenciado correctamente")}abrirModal(){return Object(r.a)(this,void 0,void 0,function*(){const e=yield this.modalCtrl.create({component:g,componentProps:{lng:this.lng,lat:this.lat,ncompleto:this.ncompleto,pais:this.pais,miciudad:this.miciudad,escogidos:this.escogidos,de:this.de,a:this.a,desde:this.desde,hasta:this.hasta,editable:this.editable,id:this.id,imagenLocal:this.imagenLocal,imagen:this.imagen,primero:this.primero}});yield e.present(),(yield e.onWillDismiss())&&(this.primero=!1,this.vista=1,this.sedes=[],this.traerSedes())})}crear(){this.draggable=!0,this.editable=!1,this.escogidos=[],this.pais="",this.miciudad="",this.de="",this.desde="",this.a="",this.hasta="",this.listarNegocios(),this.ncompleto="Escriba el nombre",this.vista=2}retroceder(){this.vista=1}ver(e){this.lat=e.ubicacion.lat,this.lng=e.ubicacion.lng,this.abrirModal()}eliminar(e,t){return Object(r.a)(this,void 0,void 0,function*(){const i=yield this.almacenamiento.obtenerToken();i&&this.apiMapas.eliminarSede(i.token,{id:e._id}).subscribe(e=>{e.exe?(this.toastService.toastExitoso("Sede eliminada"),this.sedes.splice(t,1)):this.toastService.toastError("No se pudo eliminar la sede, int\xe9ntelo m\xe1s tarde")},e=>{this.toastService.toastError("No se pudo eliminar la sede, int\xe9ntelo m\xe1s tarde")})})}editar(e,t){const i=this.paises.filter(t=>t.nombre===e.pais)[0];this.paiss=i,this.pais=e.pais,this.editable=!0,this.primero=!1,this.listarCiudades({detail:{value:i}},!0),this.miciudad=e.ciudad,this.ncompleto=e.nombre,this.desde=e.desde,this.hasta=e.hasta,this.de=e.de,this.a=e.a,this.lat=e.ubicacion.lat,this.lng=e.ubicacion.lng,this.negocios.forEach(t=>{e.tipoNegocio.forEach(e=>{t.nombre===e&&(t.checked=!0)})}),this.draggable=!0,this.escogidos=e.tipoNegocio,this.vista=2,this.id=e._id}horario(e,t){"desde"===t?this.desde=e.detail.value:this.hasta=e.detail.value}dias(e,t){"de"===t?this.de=e.detail.value:this.a=e.detail.value}}return e.\u0275fac=function(t){return new(t||e)(c.Jb(l.a),c.Jb(a.b),c.Jb(d.a),c.Jb(b.a),c.Jb(h.a),c.Jb(u.a),c.Jb(a.ob))},e.\u0275cmp=c.Db({type:e,selectors:[["app-sedes-mapa"]],viewQuery:function(e,t){if(1&e&&c.vc(f,1),2&e){let e;c.kc(e=c.Vb())&&(t.mapa=e.first)}},decls:10,vars:3,consts:[["color","oscuro"],["slot","start","icon","chevron-back-outline","defaultHref","/central/menu/inicioMapa"],["slot","end"],[3,"click",4,"ngIf"],["class","recuadro",4,"ngIf"],[3,"click"],["name","close-outline","slot","icon-only","color","blanco"],[1,"recuadro"],[4,"ngFor","ngForOf"],["vertical","bottom","horizontal","end","slot","fixed"],["color","success",3,"click"],["name","location-outline"],["slot","start",1,"avatar"],["src","/assets/Marcador.png","alt",""],[1,"ion-text-wrap"],[1,"info"],["side","end"],["color","warning",3,"click"],["name","pencil-outline","slot","icon-only"],["color","danger",3,"click"],["name","trash-outline","slot","icon-only"],["lines","none","mode","ios",1,"noborder"],["lines","none","mode","ios"],["type","text","placeholder","Ingrese nombre completo de la sede",1,"privado",3,"ngModel","ngModelChange"],["lines","none","mode","md",1,"amrillo"],["class","noborder","mode","md",4,"ngFor","ngForOf"],["mode","ios"],["okText","Aceptar","cancelText","Cancelar",3,"ionChange",4,"ngIf"],["okText","Aceptar","cancelText","Cancelar",3,"value","ionChange",4,"ngIf"],["class","flexbet",4,"ngIf"],["mode","ios",4,"ngIf"],[1,"amrillo"],[1,"sinfondo"],["displayFormat","h:mm a",3,"value","ionChange"],["color","light"],["placeholder","Seleccionar D\xeda","okText","Aceptar","cancelText","Cancelar",3,"value","ionChange"],["value","Lunes"],["value","Martes"],["value","Mi\xe9rcoles"],["value","Jueves"],["value","Viernes"],["value","S\xe1bado"],["value","Domingo"],["expand","block","color","light","mode","ios","shape","round",3,"click"],["mode","md",1,"noborder"],["slot","start","color","success",3,"checked","value","ionChange"],["okText","Aceptar","cancelText","Cancelar",3,"ionChange"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],["okText","Aceptar","cancelText","Cancelar",3,"value","ionChange"],[1,"flexbet"],["name","crescent","color","primary"]],template:function(e,t){1&e&&(c.Mb(0,"ion-header"),c.Mb(1,"ion-toolbar",0),c.Kb(2,"ion-back-button",1),c.Mb(3,"ion-title"),c.rc(4,"Administrar sedes"),c.Lb(),c.Mb(5,"ion-buttons",2),c.qc(6,v,2,0,"ion-button",3),c.Lb(),c.Lb(),c.Lb(),c.Mb(7,"ion-content"),c.qc(8,L,6,1,"div",4),c.qc(9,$,73,10,"div",4),c.Lb()),2&e&&(c.zb(6),c.dc("ngIf",t.draggable&&1!==t.vista),c.zb(2),c.dc("ngIf",1===t.vista),c.zb(1),c.dc("ngIf",2===t.vista))},directives:[a.z,a.jb,a.g,a.h,a.hb,a.k,o.j,a.t,a.j,a.A,a.L,o.i,a.v,a.w,a.J,a.F,a.f,a.K,a.I,a.H,a.E,a.wb,s.i,s.k,a.G,a.vb,a.u,a.W,a.X,a.q,a.d,a.bb],styles:[".amrillo[_ngcontent-%COMP%]{--background:#fbf6d8!important}.flexbet[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center}.mapa[_ngcontent-%COMP%]{width:100%;height:100%;background-color:#f3f3f3;opacity:0}.visible[_ngcontent-%COMP%]{opacity:1}.avatar[_ngcontent-%COMP%]{width:50px;height:60px}.avatar[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:40px}"]}),e})()}];let U=(()=>{class e{}return e.\u0275mod=c.Hb({type:e}),e.\u0275inj=c.Gb({factory:function(t){return new(t||e)},imports:[[n.i.forChild(I)],n.i]}),e})();const W=[{path:"",component:g}];let J=(()=>{class e{}return e.\u0275mod=c.Hb({type:e}),e.\u0275inj=c.Gb({factory:function(t){return new(t||e)},imports:[[n.i.forChild(W)],n.i]}),e})(),P=(()=>{class e{}return e.\u0275mod=c.Hb({type:e}),e.\u0275inj=c.Gb({factory:function(t){return new(t||e)},imports:[[o.b,s.e,a.kb,J]]}),e})(),T=(()=>{class e{}return e.\u0275mod=c.Hb({type:e}),e.\u0275inj=c.Gb({factory:function(t){return new(t||e)},imports:[[o.b,s.e,a.kb,U,P]]}),e})()}}]);