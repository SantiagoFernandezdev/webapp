(window.webpackJsonp=window.webpackJsonp||[]).push([[13],{t8Hx:function(t,o,i){"use strict";i.r(o),i.d(o,"IVTproductosPageModule",function(){return I});var e=i("ofXK"),n=i("3Pt+"),s=i("TEn/"),r=i("tyNb"),a=i("mrSG"),c=i("SQQW"),d=i("fXoL"),l=i("fsfq"),b=i("5yQV"),h=i("fmoy");const u=["inifinito"];function p(t,o){if(1&t){const t=d.Pb();d.Ob(0,"ion-searchbar",20),d.Wb("ionChange",function(o){return d.pc(t),d.Yb().buscar(o)}),d.Nb()}}function g(t,o){if(1&t&&(d.Ob(0,"div",21),d.Mb(1,"img",22),d.Ob(2,"h3",23),d.wc(3),d.Nb(),d.Nb()),2&t){const t=d.Yb();d.Ab(3),d.xc(t.mensaje)}}function m(t,o){1&t&&(d.Ob(0,"ion-item"),d.Mb(1,"ion-skeleton-text",26),d.Ob(2,"ion-label"),d.Mb(3,"ion-skeleton-text",27),d.Mb(4,"ion-skeleton-text",28),d.Nb(),d.Nb())}const f=function(){return[1,1,1,1,1]};function v(t,o){1&t&&(d.Ob(0,"div",24),d.Ob(1,"ion-list"),d.vc(2,m,5,0,"ion-item",25),d.Nb(),d.Nb()),2&t&&(d.Ab(2),d.fc("ngForOf",d.kc(1,f)))}function O(t,o){if(1&t&&(d.Ob(0,"div"),d.Ob(1,"strong"),d.wc(2,"C\xf3digo: "),d.Nb(),d.wc(3),d.Nb()),2&t){const t=d.Yb().$implicit;d.Ab(3),d.yc(" ",t.codigo,"")}}function N(t,o){1&t&&(d.Ob(0,"ion-chip",1),d.wc(1,"AL DIA"),d.Nb())}function x(t,o){1&t&&(d.Ob(0,"ion-chip",42),d.wc(1,"SE EST\xc1 AGOTANDO"),d.Nb())}function A(t,o){1&t&&(d.Ob(0,"ion-chip",43),d.wc(1,"PRODUCTO AGOTADO"),d.Nb())}function P(t,o){if(1&t){const t=d.Pb();d.Ob(0,"ion-item-sliding"),d.Ob(1,"ion-item",29),d.Ob(2,"ion-avatar",2),d.Mb(3,"img",30),d.Nb(),d.Ob(4,"ion-label"),d.Ob(5,"div"),d.wc(6),d.Nb(),d.vc(7,O,4,1,"div",15),d.Ob(8,"div"),d.Ob(9,"strong"),d.wc(10,"Categoria: "),d.Nb(),d.Ob(11,"strong",31),d.wc(12),d.Nb(),d.Nb(),d.Ob(13,"div",32),d.Ob(14,"strong"),d.wc(15,"Existencia: "),d.Ob(16,"span",33),d.wc(17),d.Nb(),d.Nb(),d.vc(18,N,2,0,"ion-chip",34),d.vc(19,x,2,0,"ion-chip",35),d.vc(20,A,2,0,"ion-chip",36),d.Nb(),d.Nb(),d.Nb(),d.Ob(21,"ion-item-options",37),d.Ob(22,"ion-item-option",38),d.Wb("click",function(){d.pc(t);const i=o.$implicit;return d.Yb(2).editar(i)}),d.Mb(23,"ion-icon",39),d.Nb(),d.Ob(24,"ion-item-option",40),d.Wb("click",function(){d.pc(t);const i=o.$implicit,e=o.index;return d.Yb(2).eliminar(i,e)}),d.Mb(25,"ion-icon",41),d.Nb(),d.Nb(),d.Nb()}if(2&t){const t=o.$implicit;d.Ab(6),d.xc(t.nombre),d.Ab(1),d.fc("ngIf",t.codigo),d.Ab(5),d.xc(t.categoria),d.Ab(5),d.xc(t.existencia),d.Ab(1),d.fc("ngIf",t.existencia>t.limite),d.Ab(1),d.fc("ngIf",t.existencia<=t.limite&&t.existencia>0),d.Ab(1),d.fc("ngIf",0===t.existencia)}}function w(t,o){if(1&t&&(d.Ob(0,"ion-list"),d.vc(1,P,26,7,"ion-item-sliding",25),d.Nb()),2&t){const t=d.Yb();d.Ab(1),d.fc("ngForOf",t.productos)}}function M(t,o){if(1&t){const t=d.Pb();d.Ob(0,"ion-infinite-scroll",44,45),d.Wb("ionInfinite",function(o){return d.pc(t),d.Yb().loadData(o)}),d.Mb(2,"ion-infinite-scroll-content",46),d.Nb()}}const y=[{path:"",component:(()=>{class t{constructor(t,o,i,e,n,s){this.modalCtrl=t,this.almacenamiento=o,this.ivtApi=i,this.toast=e,this.alertCtrl=n,this.ActiveRouter=s,this.productos=[],this.load=!1,this.patron="",this.desde=0,this.seleccion="Todos",this.mensaje="No hay productos registrados",this.prod=!0}ngOnInit(){}ionViewWillEnter(){"agotados"===this.ActiveRouter.snapshot.paramMap.get("modal")?(this.seleccion="Agotados",this.cargarProductosAgotados()):"proximos"===this.ActiveRouter.snapshot.paramMap.get("modal")?(this.seleccion="Pr\xf3ximos en agotarse",this.cargarProductosProximos()):this.cargarProductos()}refrescando(t){this.cargarProductos().then(()=>{t.target.complete()}).catch(()=>t.target.complete())}cargarProductos(){return Object(a.a)(this,void 0,void 0,function*(){this.desde=0,this.load&&(this.infinite.disabled=!1);const t=yield this.almacenamiento.obtenerToken();t&&this.ivtApi.leerProducto(t.token,{desde:this.desde,id:this.ActiveRouter.snapshot.paramMap.get("id")}).subscribe(t=>{t.exe?this.productos=t.response:this.toast.toastError("No se pudo cargar los datos, intentelo m\xe1s tarde"),this.load=!0},t=>{this.toast.toastError("No se pudo cargar los datos, intentelo m\xe1s tarde")})})}modal(){return Object(a.a)(this,void 0,void 0,function*(){const t=yield this.modalCtrl.create({component:c.a,componentProps:{tipo:"productos",inventario:this.ActiveRouter.snapshot.paramMap.get("id")}});yield t.present();const o=yield t.onWillDismiss();o.data&&o.data.exe&&this.cargarProductos()})}editar(t){return Object(a.a)(this,void 0,void 0,function*(){const o=yield this.modalCtrl.create({component:c.a,componentProps:{tipo:"editarproductos",producto:t}});yield o.present();const i=yield o.onWillDismiss();i.data&&i.data.exe&&this.cargarProductos()})}eliminar(t,o){return Object(a.a)(this,void 0,void 0,function*(){const i=yield this.almacenamiento.obtenerToken();if(i){const e=yield this.alertCtrl.create({header:`Eliminar Producto: ${t.nombre}`,buttons:[{role:"cancel",text:"Cancelar"},{text:"Eliminar",cssClass:"rojoi",handler:()=>{this.ivtApi.eliminarProducto(i.token,t._id).subscribe(t=>{t.exe?(this.toast.toastExitoso("Producto eliminado!"),this.productos.splice(o,1)):this.toast.toastError("No se pudo eliminar el producto, intentelo m\xe1s tarde")},t=>{this.toast.toastError("No se pudo eliminar el proveedor, intentelo m\xe1s tarde")})}}]});yield e.present()}})}buscar(t){return Object(a.a)(this,void 0,void 0,function*(){if(""!==t.detail.value){this.desde=0,this.infinite.disabled=!1,this.patron=t.detail.value;const o=yield this.almacenamiento.obtenerToken();o&&this.ivtApi.leerProducto(o.token,{desde:this.desde,id:this.ActiveRouter.snapshot.paramMap.get("id"),patron:this.patron}).subscribe(t=>{t.exe?(this.productos=t.response,0===t.response.length&&(this.desde=0)):this.toast.toastError("No se pudo realizar la b\xfasqueda, intentelo m\xe1s tarde")},t=>{this.toast.toastError("No se pudo realizar la b\xfasqueda, intentelo m\xe1s tarde")})}else this.desde=0,this.cargarProductos()})}loadData(t){return Object(a.a)(this,void 0,void 0,function*(){this.desde=this.desde+5;const o=yield this.almacenamiento.obtenerToken();o&&(""===this.patron?this.ivtApi.leerProducto(o.token,{desde:this.desde,id:this.ActiveRouter.snapshot.paramMap.get("id")}).subscribe(o=>{o.exe?o.response.length>0?(o.response.forEach(t=>{this.productos.push(t)}),t.target.complete()):(t.target.disabled=!0,this.desde=0):this.toast.toastError("No se pudo traer las hojas de vida, int\xe9ntelo m\xe1s tarde.")},t=>{this.toast.toastError("No se pudo traer las hojas de vida, int\xe9ntelo m\xe1s tarde.")}):this.ivtApi.leerProducto(o.token,{desde:this.desde,id:this.ActiveRouter.snapshot.paramMap.get("id")}).subscribe(o=>{o.exe?o.response.length>0?(o.response.forEach(t=>{this.productos.push(t)}),t.target.complete()):(t.target.disabled=!0,this.desde=0):this.toast.toastError("No se pudo realizar la b\xfasqueda, intentelo m\xe1s tarde")},t=>{this.toast.toastError("No se pudo realizar la b\xfasqueda, intentelo m\xe1s tarde")}))})}cambioFiltro(t){this.seleccion=t.detail.value,"Todos"===this.seleccion?(this.prod=!0,this.cargarProductos()):"Agotados"===this.seleccion?(this.prod=!1,this.cargarProductosAgotados()):"Pr\xf3ximos en agotarse"===this.seleccion&&(this.prod=!1,this.cargarProductosProximos())}cargarProductosAgotados(){return Object(a.a)(this,void 0,void 0,function*(){const t=yield this.almacenamiento.obtenerToken();t&&this.ivtApi.leerAgotados(t.token,{_id:this.ActiveRouter.snapshot.paramMap.get("id")}).subscribe(t=>{t.exe?(0===t.response.length&&(this.mensaje="No hay productos agotados"),this.productos=t.response):this.toast.toastError("No se pudo cargar los datos, intentelo m\xe1s tarde"),this.load=!0},t=>{this.toast.toastError("No se pudo cargar los datos, intentelo m\xe1s tarde")})})}cargarProductosProximos(){return Object(a.a)(this,void 0,void 0,function*(){const t=yield this.almacenamiento.obtenerToken();t&&this.ivtApi.leerProximos(t.token,{_id:this.ActiveRouter.snapshot.paramMap.get("id")}).subscribe(t=>{t.exe?(0===t.response.length&&(this.mensaje="No hay productos pr\xf3ximos para agotarse"),this.productos=t.response):this.toast.toastError("No se pudo cargar los datos v2, intentelo m\xe1s tarde"),this.load=!0},t=>{this.toast.toastError("No se pudo cargar los datos, intentelo m\xe1s tarde")})})}}return t.\u0275fac=function(o){return new(o||t)(d.Lb(s.qb),d.Lb(l.a),d.Lb(b.a),d.Lb(h.a),d.Lb(s.b),d.Lb(r.a))},t.\u0275cmp=d.Fb({type:t,selectors:[["app-ivtproductos"]],viewQuery:function(t,o){if(1&t&&d.Ac(u,1),2&t){let t;d.oc(t=d.Xb())&&(o.infinite=t.first)}},decls:26,vars:6,consts:[[1,"ion-no-border"],["color","oscuro"],["slot","start"],["icon","chevron-back-outline","defaultHref","/central/menu/ivt-inicio"],["slot","end","interface","popover",3,"value","ionChange"],["value","Todos"],["value","Agotados"],["value","Pr\xf3ximos en agotarse"],["slot","fixed","pullFactor","0.5","pullMin","50","pullMax","150",3,"ionRefresh"],["pullingIcon","arrow-dropdown","refreshingSpinner","circles"],["debounce","300","mode","ios","placeholder","Buscar Productos",3,"ionChange",4,"ngIf"],[1,"divider","light"],[1,"divider"],["class","cen",4,"ngIf"],["class","carga",4,"ngIf"],[4,"ngIf"],["threshold","100px",3,"ionInfinite",4,"ngIf"],["vertical","bottom","horizontal","end","slot","fixed"],["color","oscuro",3,"click"],["name","add-outline"],["debounce","300","mode","ios","placeholder","Buscar Productos",3,"ionChange"],[1,"cen"],["src","/assets/Productos.png","width","100px","alt",""],[1,"tituloGrande"],[1,"carga"],[4,"ngFor","ngForOf"],["slot","start","animated","",2,"width","50px","height","50px"],["animated","",2,"width","50%","height","20px"],["animated","",2,"width","90%","height","20px"],["lines","none"],["src","/assets/Productos.png","width","100%","heigth","100%"],[1,"rojoi"],[1,"flexbet"],[1,"verdei"],["color","oscuro",4,"ngIf"],["color","warning",4,"ngIf"],["color","danger",4,"ngIf"],["side","end"],["color","warning",3,"click"],["slot","icon-only","name","pencil-outline"],["color","danger",3,"click"],["slot","icon-only","name","trash-outline"],["color","warning"],["color","danger"],["threshold","100px",3,"ionInfinite"],["inifinito",""],["loadingSpinner","bubbles","loadingText","Cargando Hojas de Vida..."]],template:function(t,o){1&t&&(d.Ob(0,"ion-header",0),d.Ob(1,"ion-toolbar",1),d.Ob(2,"ion-buttons",2),d.Mb(3,"ion-back-button",3),d.Nb(),d.Ob(4,"ion-title"),d.wc(5,"Productos "),d.Nb(),d.Ob(6,"ion-select",4),d.Wb("ionChange",function(t){return o.cambioFiltro(t)}),d.Ob(7,"ion-select-option",5),d.wc(8,"Todos"),d.Nb(),d.Ob(9,"ion-select-option",6),d.wc(10,"Agotados"),d.Nb(),d.Ob(11,"ion-select-option",7),d.wc(12,"Pr\xf3ximos en agotarse"),d.Nb(),d.Nb(),d.Nb(),d.Nb(),d.Ob(13,"ion-content"),d.Ob(14,"ion-refresher",8),d.Wb("ionRefresh",function(t){return o.refrescando(t)}),d.Mb(15,"ion-refresher-content",9),d.Nb(),d.vc(16,p,1,0,"ion-searchbar",10),d.Mb(17,"div",11),d.Mb(18,"div",12),d.vc(19,g,4,1,"div",13),d.vc(20,v,3,2,"div",14),d.vc(21,w,2,1,"ion-list",15),d.vc(22,M,3,0,"ion-infinite-scroll",16),d.Ob(23,"ion-fab",17),d.Ob(24,"ion-fab-button",18),d.Wb("click",function(){return o.modal()}),d.Mb(25,"ion-icon",19),d.Nb(),d.Nb(),d.Nb()),2&t&&(d.Ab(6),d.fc("value",o.seleccion),d.Ab(10),d.fc("ngIf",o.prod),d.Ab(3),d.fc("ngIf",0===o.productos.length&&o.load),d.Ab(1),d.fc("ngIf",!o.load),d.Ab(1),d.fc("ngIf",o.productos.length>0),d.Ab(1),d.fc("ngIf",o.load))},directives:[s.z,s.lb,s.k,s.g,s.h,s.jb,s.X,s.xb,s.Y,s.t,s.Q,s.R,e.j,s.v,s.w,s.A,s.U,s.yb,s.L,e.i,s.F,s.Z,s.K,s.J,s.f,s.I,s.H,s.r,s.C,s.D],styles:[".cen[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center}.tituloGrande[_ngcontent-%COMP%]{width:300px;text-align:center}.verdei[_ngcontent-%COMP%]{color:#1e8c4a}ion-item-divider[_ngcontent-%COMP%]{border:0!important;margin-bottom:15px}.rojoi[_ngcontent-%COMP%]{color:#c1302c}ion-item-sliding[_ngcontent-%COMP%]:nth-child(odd)   ion-item[_ngcontent-%COMP%]{--background:var(--ion-color-light)!important}"]}),t})()}];let k=(()=>{class t{}return t.\u0275fac=function(o){return new(o||t)},t.\u0275mod=d.Jb({type:t}),t.\u0275inj=d.Ib({imports:[[r.j.forChild(y)],r.j]}),t})(),I=(()=>{class t{}return t.\u0275fac=function(o){return new(o||t)},t.\u0275mod=d.Jb({type:t}),t.\u0275inj=d.Ib({imports:[[e.b,n.e,s.mb,k]]}),t})()}}]);