(window.webpackJsonp=window.webpackJsonp||[]).push([[37],{Fe5k:function(t,e,o){"use strict";o.r(e),o.d(e,"HojaPageModule",function(){return N});var i=o("ofXK"),n=o("3Pt+"),a=o("TEn/"),r=o("tyNb"),s=o("mrSG"),c=o("fXoL"),b=o("fsfq"),l=o("fmoy"),d=o("AQLj"),h=o("VYYF"),u=o("SpuA");const p=["inifinito"];function f(t,e){1&t&&(c.Mb(0,"ion-item"),c.Mb(1,"ion-avatar",12),c.Kb(2,"ion-skeleton-text",13),c.Lb(),c.Mb(3,"ion-label"),c.Kb(4,"ion-skeleton-text",14),c.Kb(5,"ion-skeleton-text",15),c.Lb(),c.Lb())}const g=function(){return[1,1,1,1]};function m(t,e){1&t&&(c.Mb(0,"ion-list"),c.qc(1,f,6,0,"ion-item",11),c.Lb()),2&t&&(c.zb(1),c.dc("ngForOf",c.gc(1,g)))}function M(t,e){1&t&&(c.Mb(0,"div",16),c.Kb(1,"img",17),c.Mb(2,"h3",18),c.rc(3,"Mis hojas de vida"),c.Lb(),c.Lb())}function j(t,e){if(1&t&&(c.Mb(0,"div",29),c.rc(1),c.Lb()),2&t){const t=c.Wb(2).$implicit;c.zb(1),c.sc(t.placa)}}function v(t,e){if(1&t&&(c.Mb(0,"ion-label",23),c.qc(1,j,2,1,"div",24),c.Mb(2,"div",25),c.Mb(3,"strong"),c.rc(4,"Taller: "),c.Lb(),c.Mb(5,"span",26),c.rc(6),c.Lb(),c.Lb(),c.Mb(7,"div",25),c.Mb(8,"strong"),c.rc(9,"Cliente: "),c.Lb(),c.Mb(10,"span",27),c.rc(11),c.Lb(),c.Lb(),c.Kb(12,"br"),c.Mb(13,"div",28),c.Mb(14,"strong"),c.rc(15,"Fecha: "),c.Lb(),c.Mb(16,"span",27),c.rc(17),c.Xb(18,"cambioUTC"),c.Lb(),c.Lb(),c.Lb()),2&t){const t=c.Wb().$implicit;c.zb(1),c.dc("ngIf",t.placa),c.zb(5),c.tc(" ",t.idtaller.nombrecompleto,""),c.zb(5),c.sc(t.idusuario.nombrecompleto),c.zb(6),c.sc(c.Yb(18,4,t.fecha))}}function L(t,e){if(1&t&&(c.Mb(0,"div",29),c.rc(1),c.Lb()),2&t){const t=c.Wb(2).$implicit;c.zb(1),c.sc(t.placa)}}function x(t,e){1&t&&(c.Mb(0,"div"),c.Mb(1,"ion-chip",30),c.rc(2,"HOJA DE VIDA TERMINADA"),c.Lb(),c.Lb())}function z(t,e){1&t&&(c.Mb(0,"div"),c.Mb(1,"ion-chip",31),c.rc(2,"HOJA DE VIDA SIN TERMINAR"),c.Lb(),c.Lb())}function H(t,e){if(1&t&&(c.Mb(0,"ion-label",23),c.qc(1,L,2,1,"div",24),c.Mb(2,"div",25),c.Mb(3,"strong"),c.rc(4,"Taller: "),c.Lb(),c.Mb(5,"span",26),c.rc(6),c.Lb(),c.Lb(),c.Mb(7,"div",25),c.Mb(8,"strong"),c.rc(9,"Cliente: "),c.Lb(),c.Mb(10,"span",27),c.rc(11),c.Lb(),c.Lb(),c.Kb(12,"br"),c.Mb(13,"div",28),c.Mb(14,"strong"),c.rc(15,"Fecha: "),c.Lb(),c.Mb(16,"span",27),c.rc(17),c.Xb(18,"cambioUTC"),c.Lb(),c.Lb(),c.qc(19,x,3,0,"div",7),c.qc(20,z,3,0,"div",7),c.Lb()),2&t){const t=c.Wb().$implicit;c.zb(1),c.dc("ngIf",""!==t.placa),c.zb(5),c.tc(" ",t.idtaller.nombrecompleto,""),c.zb(5),c.tc(" ",t.nusuario,""),c.zb(6),c.sc(c.Yb(18,6,t.fecha)),c.zb(2),c.dc("ngIf",t.terminado),c.zb(1),c.dc("ngIf",!t.terminado)}}function k(t,e){if(1&t){const t=c.Nb();c.Mb(0,"ion-item",20),c.Ub("click",function(){c.lc(t);const o=e.$implicit;return c.Wb(2).navegar(o)}),c.Mb(1,"ion-avatar",12),c.Kb(2,"img",21),c.Lb(),c.qc(3,v,19,6,"ion-label",22),c.qc(4,H,21,8,"ion-label",22),c.Lb()}if(2&t){const t=e.$implicit;c.zb(3),c.dc("ngIf",!t.tipo||"cita"===t.tipo),c.zb(1),c.dc("ngIf",t.tipo&&"hoja"===t.tipo)}}function w(t,e){if(1&t&&(c.Mb(0,"ion-list"),c.qc(1,k,5,2,"ion-item",19),c.Lb()),2&t){const t=c.Wb();c.zb(1),c.dc("ngForOf",t.hojas)}}function I(t,e){if(1&t){const t=c.Nb();c.Mb(0,"ion-infinite-scroll",32,33),c.Ub("ionInfinite",function(e){return c.lc(t),c.Wb().loadData(e)}),c.Kb(2,"ion-infinite-scroll-content",34),c.Lb()}}function C(t,e){if(1&t){const t=c.Nb();c.Mb(0,"ion-fab",35),c.Mb(1,"ion-fab-button",36),c.Ub("click",function(){return c.lc(t),c.Wb().abrir()}),c.Kb(2,"ion-icon",37),c.Lb(),c.Lb()}}const y=[{path:"",component:(()=>{class t{constructor(t,e,o,i,n,a){this.almacenamiento=t,this.toast=e,this.apiHoja=o,this.router=i,this.statusbar=n,this.alertCtrl=a,this.desde=0,this.hojas=[],this.cargado=!0,this.patron="",this.textoBuscar="",this.role=""}ngOnInit(){}ionViewWillEnter(){this.desde=0,this.hojas=[],this.inifinito.disabled=!1,this.cargarHojas(),this.statusbar.backgroundColorByHexString("#273238")}refrescando(t){this.desde=0,this.cargarHojas().then(()=>{t.target.complete()}).catch(()=>{t.target.complete()})}cargarHojas(){return Object(s.a)(this,void 0,void 0,function*(){const t=yield this.almacenamiento.obtenerToken();t&&(this.role=t.role,this.textoBuscar="TALLER_ROLE"===t.role?"Buscar por cliente":"Buscar por taller",this.apiHoja.buscarHojas(t.token,{desde:this.desde}).subscribe(t=>{t.exe?this.hojas=t.response:(this.hojas=[],this.toast.toastError("No se pudo traer las hojas de vida, int\xe9ntelo m\xe1s tarde.")),this.cargado=!0},t=>{this.cargado=!0,this.hojas=[],this.toast.toastError("No se pudo traer las hojas de vida, int\xe9ntelo m\xe1s tarde.")}))})}buscar(t){return Object(s.a)(this,void 0,void 0,function*(){if(""!==t.detail.value){this.desde=0,this.patron=t.detail.value;const e=yield this.almacenamiento.obtenerToken();e&&this.apiHoja.buscarHojasFiltro(e.token,{desde:this.desde,patron:this.patron}).subscribe(t=>{t.exe?this.hojas=t.response:this.toast.toastError("No se pudo realizar la b\xfasqueda, intentelo m\xe1s tarde")},t=>{this.toast.toastError("No se pudo realizar la b\xfasqueda, intentelo m\xe1s tarde")})}else this.inifinito.disabled=!1,this.cargarHojas()})}loadData(t){return Object(s.a)(this,void 0,void 0,function*(){this.desde=this.desde+5;const e=yield this.almacenamiento.obtenerToken();e&&(""===this.patron?this.apiHoja.buscarHojas(e.token,{desde:this.desde}).subscribe(e=>{e.exe?e.response.length>0?(e.response.forEach(t=>{this.hojas.push(t)}),t.target.complete()):(t.target.disabled=!0,this.desde=0):this.toast.toastError("No se pudo traer las hojas de vida, int\xe9ntelo m\xe1s tarde.")},t=>{this.toast.toastError("No se pudo traer las hojas de vida, int\xe9ntelo m\xe1s tarde.")}):this.apiHoja.buscarHojasFiltro(e.token,{desde:this.desde,patron:this.patron}).subscribe(e=>{e.exe?e.response.length>0?(e.response.forEach(t=>{this.hojas.push(t)}),t.target.complete()):(t.target.disabled=!0,this.desde=0):this.toast.toastError("No se pudo realizar la b\xfasqueda, intentelo m\xe1s tarde")},t=>{this.toast.toastError("No se pudo realizar la b\xfasqueda, intentelo m\xe1s tarde")}))})}navegar(t){this.router.navigate(["/central/menu/hoja/mihoja",t._id,"hoja"])}ionViewWillLeave(){this.statusbar.backgroundColorByHexString("#777777")}abrir(){return Object(s.a)(this,void 0,void 0,function*(){const t=yield this.alertCtrl.create({header:"Crear Hoja de vida",message:"\xbfQuieres crear una nueva hoja de vida?",inputs:[{type:"text",placeholder:"Nombre del cliente",name:"cliente"},{type:"text",placeholder:"Placa del Veh\xedculo",name:"placa"},{type:"text",placeholder:"Nombre del trabajador (si es un empleado)",name:"trabajador"}],buttons:[{text:"Cancelar",role:"cancel"},{text:"Crear Hoja",handler:t=>{this.crear(t)}}]});yield t.present()})}crear(t){return Object(s.a)(this,void 0,void 0,function*(){const e=yield this.almacenamiento.obtenerToken();e&&this.apiHoja.crearHoja(e.token,{usuario:"",placa:t.placa,nusuario:t.cliente,cita:"",trabajador:t.trabajador}).subscribe(t=>{t.exe?this.toast.toastExitoso("Hoja de vida creada"):this.toast.toastError("No se pudo crear la hoja de vida, intentelo m\xe1s tarde")},t=>{this.toast.toastError("No se pudo crear la hoja de vida, intentelo m\xe1s tarde")})})}}return t.\u0275fac=function(e){return new(e||t)(c.Jb(b.a),c.Jb(l.a),c.Jb(d.a),c.Jb(r.g),c.Jb(h.a),c.Jb(a.b))},t.\u0275cmp=c.Db({type:t,selectors:[["app-hoja"]],viewQuery:function(t,e){if(1&t&&c.vc(p,1),2&t){let t;c.kc(t=c.Vb())&&(e.inifinito=t.first)}},decls:15,vars:6,consts:[[1,"ion-no-border"],["color","oscuro"],["icon","chevron-back-outline","slot","start","defaultHref","/central/menu/"],["slot","fixed","pullFactor","0.5","pullMin","50","pullMax","150",3,"ionRefresh"],["pullingIcon","arrow-dropdown","refreshingSpinner","circles"],["mode","ios",3,"placeholder","ionChange"],[1,"divider","light"],[4,"ngIf"],["class","flexbet",4,"ngIf"],["threshold","100px",3,"ionInfinite",4,"ngIf"],["vertical","bottom","horizontal","end","slot","fixed",4,"ngIf"],[4,"ngFor","ngForOf"],["slot","start"],["animted","",2,"width","100%","height","100%"],["animted","",2,"width","100%","height","20px"],["animted","",2,"width","50%","height","20px"],[1,"flexbet"],["src","/assets/Hojas.png","width","70px","alt",""],[1,"tituloGrande"],["class","item sinfondo",3,"click",4,"ngFor","ngForOf"],[1,"item","sinfondo",3,"click"],["src","/assets/Hoja.png","width","100%","height","100%","alt",""],["class","ion-text-wrap",4,"ngIf"],[1,"ion-text-wrap"],["class","placa",4,"ngIf"],[1,"flex"],[1,"cll"],[1,"cl"],[1,"flex","fl"],[1,"placa"],["mode","ios","color","barra"],["mode","ios","color","danger"],["threshold","100px",3,"ionInfinite"],["inifinito",""],["loadingSpinner","bubbles","loadingText","Cargando Hojas de Vida..."],["vertical","bottom","horizontal","end","slot","fixed"],["color","barra",3,"click"],["name","add-outline"]],template:function(t,e){1&t&&(c.Mb(0,"ion-header",0),c.Mb(1,"ion-toolbar",1),c.Kb(2,"ion-back-button",2),c.Mb(3,"ion-title"),c.rc(4,"Hojas de Vida"),c.Lb(),c.Lb(),c.Lb(),c.Mb(5,"ion-content"),c.Mb(6,"ion-refresher",3),c.Ub("ionRefresh",function(t){return e.refrescando(t)}),c.Kb(7,"ion-refresher-content",4),c.Lb(),c.Mb(8,"ion-searchbar",5),c.Ub("ionChange",function(t){return e.buscar(t)}),c.Lb(),c.Kb(9,"div",6),c.qc(10,m,2,2,"ion-list",7),c.qc(11,M,4,0,"div",8),c.qc(12,w,2,1,"ion-list",7),c.qc(13,I,3,0,"ion-infinite-scroll",9),c.qc(14,C,3,0,"ion-fab",10),c.Lb()),2&t&&(c.zb(8),c.ec("placeholder",e.textoBuscar),c.zb(2),c.dc("ngIf",!e.cargado),c.zb(1),c.dc("ngIf",e.cargado&&0===e.hojas.length),c.zb(1),c.dc("ngIf",e.hojas.length>0),c.zb(1),c.dc("ngIf",e.cargado),c.zb(1),c.dc("ngIf","TALLER_ROLE"===e.role))},directives:[a.z,a.jb,a.g,a.h,a.hb,a.t,a.P,a.Q,a.T,a.wb,i.j,a.L,i.i,a.F,a.f,a.Y,a.K,a.r,a.C,a.D,a.v,a.w,a.A],pipes:[u.a],styles:[".flexbet[_ngcontent-%COMP%]{margin-top:15px;text-align:center}.tituloGrande[_ngcontent-%COMP%]{opacity:.3}.flex[_ngcontent-%COMP%]{display:flex;justify-content:space-between}.fl[_ngcontent-%COMP%]{align-items:flex-start}.cl[_ngcontent-%COMP%], .cll[_ngcontent-%COMP%]{text-align:right}.separador[_ngcontent-%COMP%]{margin-top:5px;background:#e9e9e9;padding:5px}.item[_ngcontent-%COMP%]:nth-child(2n){--background:#f7f7f7!important}.placa[_ngcontent-%COMP%]{width:150px;background-color:#ffa800;color:#000;font-size:18px;text-align:center;padding:5px 10;border-radius:5px;font-weight:700;border:3px solid #000;margin-bottom:5px}"]}),t})()}];let E=(()=>{class t{}return t.\u0275mod=c.Hb({type:t}),t.\u0275inj=c.Gb({factory:function(e){return new(e||t)},imports:[[r.i.forChild(y)],r.i]}),t})();var O=o("iTUp");let N=(()=>{class t{}return t.\u0275mod=c.Hb({type:t}),t.\u0275inj=c.Gb({factory:function(e){return new(e||t)},imports:[[i.b,n.e,a.kb,E,O.a]]}),t})()},SpuA:function(t,e,o){"use strict";o.d(e,"a",function(){return a});var i=o("wd/R"),n=o("fXoL");let a=(()=>{class t{transform(t){console.log(t,"fechin");let e=i.utc(t).toDate();return i(e).format("dddd, DD MMMM YYYY h:mm:a")}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275pipe=n.Ib({name:"cambioUTC",type:t,pure:!0}),t})()}}]);