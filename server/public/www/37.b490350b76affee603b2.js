(window.webpackJsonp=window.webpackJsonp||[]).push([[37],{gUiv:function(t,e,o){"use strict";o.r(e),o.d(e,"InterfazGrupoCHatsPageModule",function(){return Q});var i=o("ofXK"),s=o("3Pt+"),n=o("TEn/"),r=o("tyNb"),a=o("mrSG"),c=o("R0Ic"),l=o("HDdC"),d=o("ypew"),h=o("fXoL"),p=o("fsfq"),b=o("oQG1"),u=o("fmoy"),f=o("vLoH"),g=o("a/9d"),m=o("r3ab"),v=o("Gq8O"),j=o("7JkF");function x(t,e){1&t&&(h.Mb(0,"ion-title"),h.rc(1,"Integrantes"),h.Lb())}function k(t,e){1&t&&(h.Mb(0,"div",6),h.Kb(1,"img",7),h.Mb(2,"h3"),h.rc(3,"No tiene acceso para ver esta informaci\xf3n, env\xede una invitaci\xf3n a este grupo"),h.Lb(),h.Lb())}function M(t,e){1&t&&(h.Mb(0,"div",16),h.Mb(1,"strong"),h.rc(2,"Creador de\xf1 grupo"),h.Lb(),h.Lb())}function E(t,e){if(1&t){const t=h.Nb();h.Mb(0,"ion-item",9),h.Mb(1,"ion-avatar",10),h.Kb(2,"img",11),h.Lb(),h.Mb(3,"ion-label",12),h.Mb(4,"strong",13),h.rc(5),h.Lb(),h.Kb(6,"br"),h.Mb(7,"div"),h.rc(8),h.Lb(),h.qc(9,M,3,0,"div",14),h.Lb(),h.Mb(10,"ion-checkbox",15),h.Ub("ionChange",function(o){h.lc(t);const i=e.$implicit;return h.Wb(2).seleccion(o,i)}),h.Lb(),h.Lb()}if(2&t){const t=e.$implicit,o=h.Wb(2);h.zb(2),h.fc("src","https://motocaliapp.com/",t.imagen[0].path,"",h.mc),h.zb(3),h.sc(t.nombrecompleto),h.zb(3),h.tc("@",t.nombreusuario,""),h.zb(1),h.dc("ngIf",t._id===o.grupo.creador)}}function w(t,e){if(1&t&&(h.Mb(0,"ion-list"),h.qc(1,E,11,4,"ion-item",8),h.Lb()),2&t){const t=h.Wb();h.zb(1),h.dc("ngForOf",t.grupo.integrantes)}}function O(t,e){if(1&t){const t=h.Nb();h.Mb(0,"ion-footer"),h.Mb(1,"ion-toolbar",17),h.Ub("click",function(){return h.lc(t),h.Wb().crear()}),h.Mb(2,"ion-title"),h.rc(3,"Crear Chat"),h.Lb(),h.Mb(4,"ion-buttons",18),h.Mb(5,"ion-button"),h.Kb(6,"ion-icon",19),h.Lb(),h.Lb(),h.Lb(),h.Lb()}}let L=(()=>{class t{constructor(t,e,o,i,s,n,r,a,c,l,d,h,p){this.almacenamiento=t,this.apiUsuario=e,this.toast=o,this.apiGrupos=i,this.router=s,this.active=n,this.actionCtrl=r,this.camera=a,this.loadingService=c,this.seguimientoService=l,this.socket=d,this.alert=h,this.modal=p,this.cargado=!1,this.solicitudEnviada=!1,this.cargarInformacion=!1,this.mostrar=!1,this.accesos=[],this.dp=[]}ngOnInit(){}ionViewWillEnter(){this.listar()}refrescando(t){this.solicitudEnviada=!1,this.cargado=!1,this.listar().then(()=>{t.target.complete()}).catch(()=>{t.target.complete()})}seleccion(t,e){t.detail.checked?0===this.accesos.filter(t=>t===e._id).length&&(this.accesos.push(e._id),this.dp.push(e.usuarioID)):(this.accesos=this.accesos.filter(t=>t!==e._id),this.dp=this.dp.filter(t=>t!==e.usuarioID)),console.log(t,this.accesos,this.dp)}listar(){return Object(a.a)(this,void 0,void 0,function*(){const t=yield this.almacenamiento.obtenerToken();t&&(this.id=t._id,this.apiGrupos.integrantes(t.token,{id:this.grupoid}).subscribe(t=>{console.log(t),t.exe?(this.grupo=t.response[0],this.mostrar=this.grupo.integrantes.filter(t=>t._id===this.id).length>0,console.log(t)):this.toast.toastError("No se pudo consultar la informaci\xf3n, int\xe9ntelo m\xe1s tarde"),this.cargado=!0},t=>{this.toast.toastError("No se pudo consultar la informaci\xf3n, int\xe9ntelo m\xe1s tarde"),this.cargado=!0}))})}eliminari(t,e){return Object(a.a)(this,void 0,void 0,function*(){const o=yield this.alert.create({header:"Atenci\xf3n!",message:"\xbfQuieres sacar a este usuario del grupo?",buttons:[{text:"Cancelar",role:"cancel",cssClass:"cancelarAlerta"},{text:"Sacar",cssClass:"botonalerta",handler:()=>{this.almacenamiento.obtenerToken().then(o=>{console.log(t),this.seguimientoService.cancelarSolicitudGrupoAdmin(o.token,this.grupo.usuario,{grupo:this.grupo._id,usuario:t}).subscribe(t=>{console.log(t),t.exe&&this.grupo.integrantes.splice(e,1)},t=>{console.log(t),this.toast.alertApplication(t.message,!1)})}).catch(t=>{this.toast.alertApplication(t,!1)})}}]});yield o.present()})}crear(){return Object(a.a)(this,void 0,void 0,function*(){const t=yield this.almacenamiento.obtenerToken();t&&(this.id=t._id,this.dp=this.dp.filter(t=>""!==t),this.apiGrupos.chat(t.token,{grupoid:this.grupoid,gruponombre:this.nombre,grupousuario:this.grupousuario,accesos:this.accesos,dp:this.dp}).subscribe(t=>{console.log(t),t.exe?(this.toast.toastExitoso("Chat creado"),this.modal.dismiss()):this.toast.toastError("No se pudo consultar la informaci\xf3n, int\xe9ntelo m\xe1s tarde"),this.cargado=!0},t=>{this.toast.toastError("No se pudo consultar la informaci\xf3n, int\xe9ntelo m\xe1s tarde"),this.cargado=!0}))})}}return t.\u0275fac=function(e){return new(e||t)(h.Jb(p.a),h.Jb(b.a),h.Jb(u.a),h.Jb(f.a),h.Jb(r.g),h.Jb(r.a),h.Jb(n.a),h.Jb(g.a),h.Jb(m.a),h.Jb(v.a),h.Jb(j.a),h.Jb(n.b),h.Jb(n.pb))},t.\u0275cmp=h.Db({type:t,selectors:[["app-chatsgrupo"]],inputs:{grupoid:"grupoid",nombre:"nombre",grupousuario:"grupousuario"},decls:10,vars:4,consts:[["color","oscuro"],["icon","chevron-back-outline","defaultHref","/interactivo/grupos","slot","start"],[4,"ngIf"],["slot","fixed","pullFactor","0.5","pullMin","50","pullMax","150",3,"ionRefresh"],["pullingIcon","arrow-dropdown","refreshingSpinner","circles"],["class","fcenter",4,"ngIf"],[1,"fcenter"],["src","/assets/No.png","width","100px","alt",""],["color","blanco",4,"ngFor","ngForOf"],["color","blanco"],["slot","start"],["width","100%","height","100%",3,"src"],[1,"ion-text-wrap"],[1,"small"],["class","creador",4,"ngIf"],["slot","end","mode","ios","color","warning",3,"ionChange"],[1,"creador"],["color","masoscuro",3,"click"],["slot","end"],["slot","icon-only","name","chevron-forward-outline"]],template:function(t,e){1&t&&(h.Mb(0,"ion-header"),h.Mb(1,"ion-toolbar",0),h.Kb(2,"ion-back-button",1),h.qc(3,x,2,0,"ion-title",2),h.Lb(),h.Lb(),h.Mb(4,"ion-content"),h.Mb(5,"ion-refresher",3),h.Ub("ionRefresh",function(t){return e.refrescando(t)}),h.Kb(6,"ion-refresher-content",4),h.Lb(),h.qc(7,k,4,0,"div",5),h.qc(8,w,2,1,"ion-list",2),h.Lb(),h.qc(9,O,7,0,"ion-footer",2)),2&t&&(h.zb(3),h.dc("ngIf",e.grupo),h.zb(4),h.dc("ngIf",e.cargado&&!e.mostrar),h.zb(1),h.dc("ngIf",e.cargado&&e.mostrar),h.zb(1),h.dc("ngIf",e.accesos.length>1))},directives:[n.z,n.kb,n.g,n.h,i.j,n.t,n.Q,n.R,n.ib,n.L,i.i,n.F,n.f,n.K,n.q,n.d,n.x,n.k,n.j,n.A],styles:[""]}),t})();var C=o("HavB"),z=o("SpuA");const I=["inifinito"],y=["contenido"];function _(t,e){if(1&t&&(h.Mb(0,"div",13),h.Kb(1,"ion-spinner",14),h.Mb(2,"div"),h.rc(3," Cargando chats... "),h.Kb(4,"br"),h.Mb(5,"strong"),h.rc(6),h.Lb(),h.Lb(),h.Lb()),2&t){const t=h.Wb(2);h.zb(6),h.tc(" ",t.usuario,"")}}function $(t,e){1&t&&(h.Mb(0,"div",13),h.Mb(1,"div",17),h.Kb(2,"img",18),h.Kb(3,"br"),h.rc(4," A\xfan no tiene chats creados "),h.Kb(5,"br"),h.Lb(),h.Lb())}function P(t,e){if(1&t&&(h.Mb(0,"ion-avatar",31),h.Kb(1,"img",32),h.Lb()),2&t){const t=h.Wb().$implicit;h.dc("@escribiendo",t.escribiendo?"activo":"noactivo"),h.zb(1),h.fc("src","https://www.motocaliapp.com/",t.taller.imagen[0].path,"",h.mc)}}function N(t,e){if(1&t&&(h.Mb(0,"ion-avatar",31),h.Kb(1,"img",32),h.Lb()),2&t){const t=h.Wb().$implicit;h.dc("@escribiendo",t.escribiendo?"activo":"noactivo"),h.zb(1),h.fc("src","https://www.motocaliapp.com/",t.creador.imagen[0].path,"",h.mc)}}function q(t,e){if(1&t&&(h.Mb(0,"strong"),h.rc(1),h.Lb()),2&t){const t=h.Wb().$implicit;h.zb(1),h.tc(" ",t.creador.nombrecompleto,"")}}function J(t,e){if(1&t&&(h.Mb(0,"strong"),h.rc(1),h.Lb()),2&t){const t=h.Wb().$implicit;h.zb(1),h.tc(" ",t.taller.nombrecompleto,"")}}function K(t,e){1&t&&(h.Mb(0,"span"),h.rc(1," Escribiendo..."),h.Lb())}function W(t,e){if(1&t&&(h.Mb(0,"div",33),h.rc(1),h.Lb()),2&t){const t=h.Wb().$implicit;h.zb(1),h.sc(t.novistos)}}function T(t,e){if(1&t){const t=h.Nb();h.Mb(0,"ion-item-option",34),h.Ub("click",function(){h.lc(t);const e=h.Wb().$implicit;return h.Wb(4).agregar(e)}),h.Kb(1,"ion-icon",35),h.Lb()}}function G(t,e){if(1&t){const t=h.Nb();h.Mb(0,"ion-item-sliding"),h.Mb(1,"ion-item",21),h.Ub("click",function(){h.lc(t);const o=e.$implicit;return h.Wb(4).entrar(o)}),h.qc(2,P,2,2,"ion-avatar",22),h.qc(3,N,2,2,"ion-avatar",22),h.Mb(4,"ion-label",23),h.Mb(5,"div",24),h.qc(6,q,2,1,"strong",2),h.qc(7,J,2,1,"strong",2),h.Lb(),h.Mb(8,"strong"),h.rc(9),h.Lb(),h.Mb(10,"div"),h.rc(11),h.Xb(12,"cambioUTC"),h.Lb(),h.Mb(13,"div",25),h.qc(14,K,2,0,"span",2),h.Lb(),h.qc(15,W,2,1,"div",26),h.Lb(),h.Lb(),h.Mb(16,"ion-item-options",27),h.qc(17,T,2,0,"ion-item-option",28),h.Mb(18,"ion-item-option",29),h.Ub("click",function(){h.lc(t);const o=e.$implicit;return h.Wb(4).quitar(o._id)}),h.Kb(19,"ion-icon",30),h.Lb(),h.Lb(),h.Lb()}if(2&t){const t=e.$implicit,o=h.Wb(4);h.zb(2),h.dc("ngIf",t.creador._id===o.id),h.zb(1),h.dc("ngIf",t.creador._id!==o.id),h.zb(2),h.dc("@escribiendo",t.escribiendo?"activo":"noactivo"),h.zb(1),h.dc("ngIf",t.creador._id!==o.id),h.zb(1),h.dc("ngIf",t.creador._id===o.id),h.zb(1),h.Bb("ticket","ticket"===t.tipo)("pedido","pedido"===t.tipo)("hoja","hoja"===t.tipo),h.dc("@escribiendo",t.escribiendo?"activo":"noactivo"),h.zb(1),h.tc("Chat Tipo: ",t.tipo,""),h.zb(1),h.dc("@escribiendo",t.escribiendo?"activo":"noactivo"),h.zb(1),h.sc(h.Yb(12,18,t.fecha)),h.zb(3),h.dc("ngIf",t.escribiendo),h.zb(1),h.dc("ngIf",t.novistos>0),h.zb(2),h.dc("ngIf",t.taller._id===o.id||"TALLER_ROLE"===o.role)}}function U(t,e){if(1&t&&(h.Mb(0,"div",19),h.Mb(1,"ion-list"),h.qc(2,G,20,20,"ion-item-sliding",20),h.Lb(),h.Lb()),2&t){const t=h.Wb(3);h.zb(2),h.dc("ngForOf",t.salas)}}function F(t,e){if(1&t&&(h.Mb(0,"div"),h.qc(1,$,6,0,"div",15),h.qc(2,U,3,1,"div",16),h.Lb()),2&t){const t=h.Wb(2);h.zb(1),h.dc("ngIf",0===t.salas.length),h.zb(1),h.dc("ngIf",t.salas.length>0)}}function R(t,e){if(1&t){const t=h.Nb();h.Mb(0,"ion-infinite-scroll",36,37),h.Ub("ionInfinite",function(e){return h.lc(t),h.Wb(2).loadData(e)}),h.Kb(2,"ion-infinite-scroll-content",38),h.Lb()}}function A(t,e){if(1&t){const t=h.Nb();h.Mb(0,"ion-content",null,3),h.Mb(2,"ion-refresher",4),h.Ub("ionRefresh",function(e){return h.lc(t),h.Wb().refrescando(e)}),h.Kb(3,"ion-refresher-content",5),h.Lb(),h.Mb(4,"ion-searchbar",6),h.Ub("ionChange",function(e){return h.lc(t),h.Wb().buscar(e)}),h.Lb(),h.qc(5,_,7,1,"div",7),h.Kb(6,"div",8),h.qc(7,F,3,2,"div",2),h.qc(8,R,3,0,"ion-infinite-scroll",9),h.Mb(9,"ion-fab",10),h.Mb(10,"ion-fab-button",11),h.Ub("click",function(){return h.lc(t),h.Wb().crearChat()}),h.Kb(11,"ion-icon",12),h.Lb(),h.Lb(),h.Lb()}if(2&t){const t=h.Wb();h.zb(5),h.dc("ngIf",!t.cargado),h.zb(2),h.dc("ngIf",t.cargado),h.zb(1),h.dc("ngIf",t.cargado)}}const S=[{path:"",component:(()=>{class t{constructor(t,e,o,i,s,n,r,c,l,d,h){this.router=t,this.alert=e,this.almacenamiento=o,this.toast=i,this.apiPedidos=s,this.socket=n,this.modal=r,this.plt=c,this.active=l,this.nav=d,this.apiGrupos=h,this.configurando=!1,this.usuario="",this.habilitado=!1,this.cargado=!1,this.id="",this.salas=[],this.desde=0,this.patron="",this.scroll=!0,this.role="",this.parar=!1,this.mostrar=!1,this.plt.backButton.subscribe(()=>{}),this.escucharEscritoss().subscribe(t=>{console.log("escribiendo...",t),t.exe&&this.salas.forEach(e=>{e._id===t.idsala&&(console.log("existe"),e.escribiendo=!0,setTimeout(()=>{e.escribiendo=!1},500))})}),this.escucharMensaje().subscribe(t=>Object(a.a)(this,void 0,void 0,function*(){if(console.log("mensaje",t),t.exe){const e=yield this.almacenamiento.obtenerToken();if(e){const o=this.salas.filter(e=>e._id===t.resp.sala._id);this.apiPedidos.mensajes(e.token,{idsala:o[0]._id}).subscribe(e=>{this.salas=this.salas.filter(e=>e._id!==t.resp.sala._id),o[0].novistos=e.exe?e.response.length:0,this.salas.unshift(o[0])},e=>{this.salas=this.salas.filter(e=>e._id!==t.resp.sala._id),o[0].novistos=0,this.salas.unshift(o[0])})}}}))}ngOnInit(){}ionViewWillEnter(){this.parar=!1,this.listar()}listar(){return Object(a.a)(this,void 0,void 0,function*(){const t=yield this.almacenamiento.obtenerToken();t&&(this.id=t._id,this.apiGrupos.integrantes(t.token,{id:this.active.snapshot.paramMap.get("id")}).subscribe(t=>{console.log(t),t.exe?(this.grupo=t.response[0],this.grupo.integrantes.filter(t=>t._id===this.id).length>0?(this.mostrar=!0,this.pedidosListar()):this.mostrar=!1,console.log(t)):this.toast.toastError("No se pudo consultar la informaci\xf3n, int\xe9ntelo m\xe1s tarde"),this.cargado=!0},t=>{this.toast.toastError("No se pudo consultar la informaci\xf3n, int\xe9ntelo m\xe1s tarde"),this.cargado=!0}))})}refrescando(t){this.listar().then(()=>{t.detail.complete()}).catch(()=>{t.detail.complete()})}pedidosListar(){return Object(a.a)(this,void 0,void 0,function*(){this.salas=[];const t=yield this.almacenamiento.obtenerToken();t&&(this.role=t.role,this.id=t._id,this.usuario=t.nombre,this.apiPedidos.misChatsGrupos(t.token,{patron:"",desde:this.desde}).subscribe(e=>{if(e.exe){let o=e.response.length;e.response.forEach(i=>Object(a.a)(this,void 0,void 0,function*(){i.escribiendo=!1,this.socket.emit("iniciochat",{id:i._id}),(yield new Promise((e,o)=>{this.apiPedidos.mensajes(t.token,{idsala:i._id}).subscribe(t=>{t.exe?(console.log(t,"RESPUESTA DEL TODO"),i.fechamsg=t.response.lemgth>0?t.response[t.response.length-1]:i.fecha,i.novistos=t.response.length,e(!0)):(i.novistos=0,e(!0))},t=>{i.novistos=0,e(!0)})}))&&(o-=1,0===o&&(this.salas=e.response,console.log(this.salas,"salas",o),this.salas.sort((t,e)=>(console.log(t.novistos),t.novistos<e.novistos?(console.log("meno"),1):t.novistos>e.novistos?(console.log("mayor"),-1):0))),this.cargado=!0)})),0===e.response.length&&(this.cargado=!0)}else this.toast.toastError("No se pudo consultar los pedidos, int\xe9ntelo m\xe1s tarde"),this.router.navigate(["/central/menu/"]),this.cargado=!0},t=>{this.toast.toastError("No se pudo consultar los pedidos, int\xe9ntelo m\xe1s tarde"),this.router.navigate(["/central/menu/"])}))})}crear(){return Object(a.a)(this,void 0,void 0,function*(){const t=yield this.alert.create({header:"Crear Pedido",message:"Los pedidos puedes realizarlos para comprar los repuestos o productos que necesites para tu veh\xedculo.",buttons:[{text:"Cancelar",cssClass:"cancelarAlerta",role:"cancel",handler:()=>{}},{text:"Crear",cssClass:"botonalerta",handler:t=>{this.router.navigate(["/central/menu/control-mapas"])}}]});yield t.present()})}escucharEscritoss(){return new l.a(t=>{this.socket.on("escribiendoChat",e=>{t.next(e)})})}escucharMensaje(){return new l.a(t=>{this.socket.on("mensajeChat",e=>{t.next(e)})})}entrar(t){this.almacenamiento.insertarChat(t).then(()=>{this.nav.navigateRoot(["/interfaz-grupo",this.active.snapshot.paramMap.get("id"),"apps",this.active.snapshot.paramMap.get("id"),"chats",this.active.snapshot.paramMap.get("id"),"chat",this.active.snapshot.paramMap.get("id")])}).catch(()=>{this.toast.toastError("No se puede acceder al chat, int\xe9ntelo m\xe1s tarde")})}agregar(t){return Object(a.a)(this,void 0,void 0,function*(){const e=yield this.modal.create({component:d.a,componentProps:{sala:t}});yield e.present()})}quitar(t){return Object(a.a)(this,void 0,void 0,function*(){const e=yield this.alert.create({header:"Atenci\xf3n!",message:"\xbfEstas seguro de abandonar esta sala? No podras visualizar de nuevo la  informaci\xf3n dentro de ella",buttons:[{text:"Cancelar",cssClass:"cancelarAlerta",role:"cancel",handler:()=>{}},{text:"Salir",cssClass:"botonalerta",handler:()=>Object(a.a)(this,void 0,void 0,function*(){const e=yield this.almacenamiento.obtenerToken();if(e){let o=this.salas.filter(e=>e._id===t)[0].accesos;o=o.map(t=>t._id),o=o.filter(t=>t!==e._id),console.log(o," eliminado"),console.log(o),this.apiPedidos.editarChat(e.token,{id:t,accesos:o}).subscribe(t=>{t.exe?(this.toast.Especial("Saliste de la sala"),this.pedidosListar()):this.toast.toastError("No se pudo realizar la petici\xf3n, int\xe9ntelo m\xe1s tarde")},t=>{this.toast.toastError("No se pudo realizar la petici\xf3n, int\xe9ntelo m\xe1s tarde")})}})}]});yield e.present()})}buscar(t){return Object(a.a)(this,void 0,void 0,function*(){if(""!==t.detail.value){this.desde=0,this.infinite.disabled=!1,this.patron=t.detail.value;const e=yield this.almacenamiento.obtenerToken();e&&this.apiPedidos.misChatsGrupos(e.token,{desde:this.desde,patron:this.patron}).subscribe(t=>{t.exe?(this.salas=t.response,0===t.response.length&&(this.desde=0)):this.toast.toastError("No se pudo realizar la consulta, intentelo m\xe1s tarde")},t=>{this.toast.toastError("No se pudo realizar la consulta, intentelo m\xe1s tarde")})}else this.desde=0,this.pedidosListar()})}loadData(t){return Object(a.a)(this,void 0,void 0,function*(){this.desde=this.desde+15;const e=yield this.almacenamiento.obtenerToken();e&&(""===this.patron?this.apiPedidos.misChatsGrupos(e.token,{desde:this.desde,patron:this.patron}).subscribe(e=>{e.exe?e.response.length>0?(e.response.forEach(t=>{this.salas.push(t)}),t.target.complete()):(t.target.disabled=!0,this.desde=0):this.toast.toastError("No se pudo traer los chats, int\xe9ntelo m\xe1s tarde.")},t=>{this.toast.toastError("No se pudo traer los chats, int\xe9ntelo m\xe1s tarde.")}):this.apiPedidos.misChatsGrupos(e.token,{desde:this.desde,patron:this.patron}).subscribe(e=>{e.exe?e.response.length>0?(e.response.forEach(t=>{this.salas.push(t)}),t.target.complete()):(t.target.disabled=!0,this.desde=0):this.toast.toastError("No se pudo realizar la consulta, intentelo m\xe1s tarde")},t=>{this.toast.toastError("No se pudo realizar la consulta, intentelo m\xe1s tarde")}))})}crearChat(){return Object(a.a)(this,void 0,void 0,function*(){const t=yield this.modal.create({component:L,componentProps:{grupoid:this.active.snapshot.paramMap.get("id"),nombre:this.grupo.nombre,grupousuario:this.grupo.usuario}});yield t.present()})}ionViewWillLeave(){this.parar=!0,this.salas.forEach(t=>{this.socket.emit("salidachat",{id:t._id})})}}return t.\u0275fac=function(e){return new(e||t)(h.Jb(r.g),h.Jb(n.b),h.Jb(p.a),h.Jb(u.a),h.Jb(C.a),h.Jb(j.a),h.Jb(n.pb),h.Jb(n.sb),h.Jb(r.a),h.Jb(n.qb),h.Jb(f.a))},t.\u0275cmp=h.Db({type:t,selectors:[["app-interfaz-grupo-chats"]],viewQuery:function(t,e){if(1&t&&(h.vc(I,1),h.vc(y,1)),2&t){let t;h.kc(t=h.Vb())&&(e.infinite=t.first),h.kc(t=h.Vb())&&(e.contenido=t.first)}},decls:6,vars:1,consts:[["color","oscuro"],["slot","start","icon","chevron-back-outline","defaultHref","/central/menu"],[4,"ngIf"],["contenido",""],["slot","fixed","pullFactor","0.5","pullMin","50","pullMax","150",3,"ionRefresh"],["pullingIcon","arrow-dropdown","refreshingSpinner","circles"],["debounce","300","mode","ios","placeholder","Buscar chats por tipo",3,"ionChange"],["class","flcenter ion-padding",4,"ngIf"],[1,"divider","light"],["threshold","100px",3,"ionInfinite",4,"ngIf"],["vertical","bottom","horizontal","end","slot","fixed"],["color","oscuro",3,"click"],["name","add-outline"],[1,"flcenter","ion-padding"],["name","crescent","color","oscuro"],["class","flcenter ion-padding ",4,"ngIf"],["class"," ",4,"ngIf"],[1,"ct"],["src","/assets/Chats.png","width","80px","alt",""],[1,""],[4,"ngFor","ngForOf"],[3,"click"],["slot","start",4,"ngIf"],[1,"relativo"],[1,"info"],[1,"escribiendo"],["class","nv",4,"ngIf"],["side","end"],["color","barra",3,"click",4,"ngIf"],["color","danger",3,"click"],["name","trash-outline","slot","icon-only"],["slot","start"],[3,"src"],[1,"nv"],["color","barra",3,"click"],["name","add-outline","slot","icon-only"],["threshold","100px",3,"ionInfinite"],["inifinito",""],["loadingSpinner","bubbles","loadingText","Cargando Chats..."]],template:function(t,e){1&t&&(h.Mb(0,"ion-header"),h.Mb(1,"ion-toolbar",0),h.Kb(2,"ion-back-button",1),h.Mb(3,"ion-title"),h.rc(4,"Chats"),h.Lb(),h.Lb(),h.Lb(),h.qc(5,A,12,3,"ion-content",2)),2&t&&(h.zb(5),h.dc("ngIf",e.scroll))},directives:[n.z,n.kb,n.g,n.h,n.ib,i.j,n.t,n.Q,n.R,n.U,n.xb,n.v,n.w,n.A,n.cb,n.L,i.i,n.J,n.F,n.K,n.I,n.H,n.f,n.C,n.D],pipes:[z.a],styles:[".flcenter[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;align-items:center;font-size:20px;text-align:center}ion-card[_ngcontent-%COMP%]{position:relative}.tp[_ngcontent-%COMP%]{z-index:10;background-color:initial}.ct[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;font-size:20px;font-weight:300}.msg[_ngcontent-%COMP%]{position:absolute;top:0;right:0;text-align:center;padding:5px 10px;border-radius:10px}.escribiendo[_ngcontent-%COMP%]{color:#627e42;font-weight:700;font-size:14px;height:20px}.relativo[_ngcontent-%COMP%]{position:relative}.nv[_ngcontent-%COMP%]{position:absolute;bottom:5px;right:5px;background-color:#627e42;color:#fff;text-align:center;min-width:20px;min-height:20px;max-width:50px;max-height:50px;border-radius:100%}.info[_ngcontent-%COMP%]{width:70%}.ticket[_ngcontent-%COMP%]{color:#e53935}.pedido[_ngcontent-%COMP%]{color:orange}.hoja[_ngcontent-%COMP%]{color:#4a4a4a}"],data:{animation:[Object(c.l)("escribiendo",[Object(c.i)("activo",Object(c.j)({opacity:.5})),Object(c.i)("noactivo",Object(c.j)({opacity:1})),Object(c.k)("activo <=> noactivo",[Object(c.e)("300ms")])])]}}),t})()}];let D=(()=>{class t{}return t.\u0275mod=h.Hb({type:t}),t.\u0275inj=h.Gb({factory:function(e){return new(e||t)},imports:[[r.i.forChild(S)],r.i]}),t})();var H=o("iTUp");let Q=(()=>{class t{}return t.\u0275mod=h.Hb({type:t}),t.\u0275inj=h.Gb({factory:function(e){return new(e||t)},imports:[[i.b,s.e,n.lb,D,H.a]]}),t})()},r3ab:function(t,e,o){"use strict";o.d(e,"a",function(){return r});var i=o("mrSG"),s=o("fXoL"),n=o("TEn/");let r=(()=>{class t{constructor(t){this.loadingCtrl=t}cargaProcesos(t){return Object(i.a)(this,void 0,void 0,function*(){return this.loading=yield this.loadingCtrl.create({message:t}),this.loading.present()})}finalizarCargado(){this.loading.dismiss()}}return t.\u0275fac=function(e){return new(e||t)(s.Qb(n.nb))},t.\u0275prov=s.Fb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})()},vLoH:function(t,e,o){"use strict";o.d(e,"a",function(){return g});var i=o("tk/3"),s=o("PqYM"),n=o("Cfvw"),r=o("coGc"),a=o("lJxs"),c=o("IzEk"),l=o("MtjB"),d=o("JIr8"),h=o("AytR"),p=o("fXoL"),b=o("B7Rs"),u=o("fsfq"),f=o("TEn/");let g=(()=>{class t{constructor(t,e,o,i){this.http=t,this.transfer=e,this.almacenamiento=o,this.navCtrl=i}hanflerError(t){let e=0;return t.pipe(Object(r.a)(()=>Object(s.a)(5e3)),Object(a.a)(t=>{if(e++,console.log("Entramos a intentos"),t instanceof ErrorEvent){if(3===e)throw new Error("Error de Red")}else{if(!(t instanceof ProgressEvent))throw 404===t.status?new Error(" al realizar la solicictud "):401===t.status?(this.almacenamiento.terminarPartida().then(()=>{this.navCtrl.navigateRoot("/home")}),new Error("No tiene permisos para realizar la petici\xf3n ")):(console.log(t,"Error de servidor"),new Error(" No se pudo realizar la petici\xf3n, intentalo m\xe1s tarde "));if(3===e)throw new Error("Error de Red")}}),Object(c.a)(3))}crearGrupo(t,e){const o={headers:new i.c({"x-token":t})};return this.http.post(`${h.a}/grupos/crear`,e,o).pipe(Object(l.a)(t=>this.hanflerError(t)))}listarGrupos(t,e){const o={headers:new i.c({"x-token":t})};return this.http.put(`${h.a}/grupos/lista`,e,o).pipe(Object(l.a)(t=>this.hanflerError(t)))}info(t,e){const o={headers:new i.c({"x-token":t})};return this.http.put(`${h.a}/grupos/info`,e,o).pipe(Object(l.a)(t=>this.hanflerError(t)))}integrantes(t,e){const o={headers:new i.c({"x-token":t})};return this.http.put(`${h.a}/grupos/integrantes`,e,o).pipe(Object(l.a)(t=>this.hanflerError(t)))}fotoPerfilUsuarioMoto(t,e,o,i){const s={fileKey:"archivo",httpMethod:"PUT",headers:{"x-token":t,"x-id":i},params:{tipo:o}},r=this.transfer.create();return Object(n.a)(r.upload(e,`${h.a}/upload/grupos`,s)).pipe(Object(d.a)(t=>{throw console.log("No se pudo subir la imagen "),new Error("No se pudo subir la imagen ")}))}subirweb(t,e,o){const s={headers:new i.c({"x-token":t,"x-id":o})};return this.http.put(`${h.a}/upload/grupos`,e,s).pipe(Object(l.a)(t=>this.hanflerError(t)))}leerProducto(t,e){const o={headers:new i.c({"x-token":t})};return this.http.put(`${h.a}/grupos/filtrar`,e,o).pipe(Object(l.a)(t=>this.hanflerError(t)))}chat(t,e){const o={headers:new i.c({"x-token":t})};return this.http.put(`${h.a}/grupos/chat`,e,o).pipe(Object(l.a)(t=>this.hanflerError(t)))}descarga(t,e){return this.http.get(`https://api.mapbox.com/directions/v5/mapbox/driving-traffic/${e.coordsIniciales.lng},${e.coordsIniciales.lat};${e.coordsFinales.lng},${e.coordsFinales.lat}?geometries=geojson&steps=true&language=es&access_token=${t}`).pipe(Object(l.a)(t=>this.hanflerError(t)))}dibujar(t,e){return this.http.get(`https://api.mapbox.com/directions/v5/mapbox/driving-traffic/${e.lng},${e.lat};${e.lngf},${e.latf}?geometries=geojson&steps=true&language=es&access_token=${t}`).pipe(Object(l.a)(t=>this.hanflerError(t)))}viaje(t,e){const o={headers:new i.c({"x-token":t})};return this.http.post(`${h.a}/grupos/viajes`,e,o).pipe(Object(l.a)(t=>this.hanflerError(t)))}irgrupo(t,e){const o={headers:new i.c({"x-token":t})};return this.http.put(`${h.a}/grupos/bu`,e,o).pipe(Object(l.a)(t=>this.hanflerError(t)))}podio(t,e){const o={headers:new i.c({"x-token":t})};return this.http.put(`${h.a}/grupos/podio`,e,o).pipe(Object(l.a)(t=>this.hanflerError(t)))}tabla(t,e){const o={headers:new i.c({"x-token":t})};return this.http.put(`${h.a}/grupos/tabla`,e,o).pipe(Object(l.a)(t=>this.hanflerError(t)))}viajechao(t,e){const o={headers:new i.c({"x-token":t})};return this.http.put(`${h.a}/grupos/viajes/eliminar`,e,o).pipe(Object(l.a)(t=>this.hanflerError(t)))}fotospodio(t,e){const o={headers:new i.c({"x-token":t})};return this.http.put(`${h.a}/grupos/podio/fotos`,e,o).pipe(Object(l.a)(t=>this.hanflerError(t)))}viajeBuscarUno(t,e){const o={headers:new i.c({"x-token":t})};return this.http.put(`${h.a}/grupos/buscar`,e,o).pipe(Object(l.a)(t=>this.hanflerError(t)))}viajeBuscar(t,e){const o={headers:new i.c({"x-token":t})};return this.http.put(`${h.a}/grupos/viajes/filtrar`,e,o).pipe(Object(l.a)(t=>this.hanflerError(t)))}fotoviaje(t,e,o){const i={fileKey:"archivo",httpMethod:"PUT",headers:{"x-token":e,"x-viaje":o}},s=this.transfer.create();return Object(n.a)(s.upload(t,`${h.a}/grupos/viaje/upload`,i)).pipe(Object(d.a)(t=>{throw new Error("No se pudo subir la imagen ")}))}subirweb2(t,e,o){const s={headers:new i.c({"x-token":t,"x-viaje":o})};return this.http.put(`${h.a}/grupos/viaje/upload`,e,s).pipe(Object(l.a)(t=>this.hanflerError(t)))}fotosviaje(t,e){const o={headers:new i.c({"x-token":t})};return this.http.put(`${h.a}/grupos/viaje/fotos`,e,o).pipe(Object(l.a)(t=>this.hanflerError(t)))}destino(t,e){const o={headers:new i.c({"x-token":t})};return this.http.put(`${h.a}/grupos/viaje/destino`,e,o).pipe(Object(l.a)(t=>this.hanflerError(t)))}eliminarviaje(t,e){const o={headers:new i.c({"x-token":t})};return this.http.put(`${h.a}/grupos/viaje/eliminar`,e,o).pipe(Object(l.a)(t=>this.hanflerError(t)))}eliminarFoto(t,e){const o={headers:new i.c({"x-token":t})};return this.http.put(`${h.a}/grupos/viaje/eliminarfoto`,e,o).pipe(Object(l.a)(t=>this.hanflerError(t)))}km(t,e){const o={headers:new i.c({"x-token":t})};return this.http.put(`${h.a}/grupos/km`,e,o).pipe(Object(l.a)(t=>this.hanflerError(t)))}}return t.\u0275fac=function(e){return new(e||t)(p.Qb(i.a),p.Qb(b.a),p.Qb(u.a),p.Qb(f.qb))},t.\u0275prov=p.Fb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})()}}]);