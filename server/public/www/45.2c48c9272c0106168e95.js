(window.webpackJsonp=window.webpackJsonp||[]).push([[45],{"+WxW":function(t,e,i){"use strict";i.d(e,"a",function(){return p});var o=i("AytR"),n=i("tk/3"),r=i("coGc"),s=i("lJxs"),a=i("IzEk"),c=i("MtjB"),d=i("PqYM"),l=i("fXoL"),b=i("tyNb");let p=(()=>{class t{constructor(t,e){this.http=t,this.router=e}hanflerError(t){return t.pipe(Object(r.a)(()=>Object(d.a)(3e3)),Object(s.a)(t=>{if(console.log("Entramos a intentos"),t instanceof ErrorEvent)throw new Error("Error de Red");if(404===t.status)throw new Error(" P\xe1gina no encontrada");if(401===t.status)throw new Error(" No tiene permisos ")}),Object(a.a)(3))}disponibilidad(t){const e={headers:new n.c({"x-token":t})};return this.http.get(`${o.a}/ticket/disponibilidad`,e).pipe(Object(c.a)(t=>this.hanflerError(t)))}Creardisponibilidad(t){const e={headers:new n.c({"x-token":t})};return this.http.post(`${o.a}/ticket/disponibilidad`,{},e).pipe(Object(c.a)(t=>this.hanflerError(t)))}editardisponibilidad(t,e){const i={headers:new n.c({"x-token":t})};return this.http.put(`${o.a}/ticket/disponibilidad`,e,i).pipe(Object(c.a)(t=>this.hanflerError(t)))}crearSala(t,e){const i={headers:new n.c({"x-token":t})};return this.http.post(`${o.a}/ticket/salas`,e,i).pipe(Object(c.a)(t=>this.hanflerError(t)))}misSalas(t){const e={headers:new n.c({"x-token":t})};return this.http.get(`${o.a}/ticket/salas`,e).pipe(Object(c.a)(t=>this.hanflerError(t)))}crearTicket(t,e){const i={headers:new n.c({"x-token":t})};return this.http.post(`${o.a}/ticket/crear`,e,i).pipe(Object(c.a)(t=>this.hanflerError(t)))}misTickets(t){const e={headers:new n.c({"x-token":t})};return this.http.get(`${o.a}/ticket/lista`,e).pipe(Object(c.a)(t=>this.hanflerError(t)))}misTicketsLista(t,e){const i={headers:new n.c({"x-token":t})};return this.http.put(`${o.a}/ticket/lista/negocio`,e,i).pipe(Object(c.a)(t=>this.hanflerError(t)))}salasNegocio(t,e){const i={headers:new n.c({"x-token":t})};return this.http.put(`${o.a}/ticket/salas/usuario`,e,i).pipe(Object(c.a)(t=>this.hanflerError(t)))}disponibilidadnegocio(t,e){const i={headers:new n.c({"x-token":t})};return this.http.put(`${o.a}/ticket/disponibilidad/negocio`,e,i).pipe(Object(c.a)(t=>this.hanflerError(t)))}ticketsolo(t,e){const i={headers:new n.c({"x-token":t})};return this.http.put(`${o.a}/ticket/solo`,e,i).pipe(Object(c.a)(t=>this.hanflerError(t)))}ticketelimina(t,e){const i={headers:new n.c({"x-token":t})};return this.http.put(`${o.a}/ticket/eliminar`,e,i).pipe(Object(c.a)(t=>this.hanflerError(t)))}crearHoja(t,e){const i={headers:new n.c({"x-token":t})};return this.http.post(`${o.a}/hoja/dos`,e,i).pipe(Object(c.a)(t=>this.hanflerError(t)))}consultarSala(t,e){const i={headers:new n.c({"x-token":t})};return this.http.post(`${o.a}/ticket/consultar/chat`,e,i).pipe(Object(c.a)(t=>this.hanflerError(t)))}}return t.\u0275fac=function(e){return new(e||t)(l.Sb(n.a),l.Sb(b.g))},t.\u0275prov=l.Hb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})()},"1XrT":function(t,e,i){"use strict";i.r(e),i.d(e,"PedidosInicioPageModule",function(){return M});var o=i("ofXK"),n=i("3Pt+"),r=i("TEn/"),s=i("tyNb"),a=i("mrSG"),c=i("ypew"),d=i("Si6o"),l=i("fXoL"),b=i("fsfq"),p=i("fmoy"),h=i("HavB"),u=i("SpuA");function f(t,e){if(1&t&&(l.Ob(0,"div",8),l.Mb(1,"ion-spinner",9),l.Ob(2,"div"),l.wc(3," Cargando pedidos... "),l.Mb(4,"br"),l.Ob(5,"strong"),l.wc(6),l.Nb(),l.Nb(),l.Nb()),2&t){const t=l.Yb();l.Ab(6),l.yc(" ",t.usuario,"")}}function g(t,e){1&t&&(l.Ob(0,"div",8),l.Ob(1,"div",12),l.Mb(2,"img",13),l.Mb(3,"br"),l.wc(4," A\xfan no tiene pedidos creados "),l.Mb(5,"br"),l.Nb(),l.Nb())}function m(t,e){if(1&t&&(l.Ob(0,"strong"),l.wc(1),l.Nb()),2&t){const t=l.Yb().$implicit;l.Ab(1),l.yc("Solicitado por ",t.creador.nombrecompleto,"")}}function v(t,e){if(1&t&&(l.Ob(0,"strong"),l.wc(1),l.Nb()),2&t){const t=l.Yb().$implicit;l.Ab(1),l.yc("Solicitado a ",t.taller.nombrecompleto,"")}}function O(t,e){1&t&&(l.Ob(0,"div",27),l.Mb(1,"ion-spinner",28),l.wc(2," Cargando Chat..."),l.Nb())}function k(t,e){if(1&t){const t=l.Pb();l.Ob(0,"ion-item-option",29),l.Wb("click",function(){l.pc(t);const e=l.Yb().$implicit;return l.Yb(3).agregar(e)}),l.Mb(1,"ion-icon",30),l.Nb()}}function w(t,e){if(1&t){const t=l.Pb();l.Ob(0,"ion-item-sliding"),l.Ob(1,"ion-item",16),l.Wb("click",function(){l.pc(t);const i=e.$implicit;return l.Yb(3).info(i._id)}),l.Ob(2,"ion-avatar",17),l.Mb(3,"img",18),l.Nb(),l.Ob(4,"ion-label",19),l.vc(5,m,2,1,"strong",6),l.vc(6,v,2,1,"strong",6),l.Ob(7,"div"),l.wc(8),l.Zb(9,"cambioUTC"),l.Nb(),l.vc(10,O,3,0,"div",20),l.Nb(),l.Nb(),l.Ob(11,"ion-item-options",21),l.vc(12,k,2,0,"ion-item-option",22),l.Ob(13,"ion-item-option",23),l.Wb("click",function(){l.pc(t);const i=e.$implicit,o=e.index;return l.Yb(3).navegar(i._id,o)}),l.Mb(14,"ion-icon",24),l.Nb(),l.Ob(15,"ion-item-option",25),l.Wb("click",function(){l.pc(t);const i=e.$implicit;return l.Yb(3).quitar(i._id)}),l.Mb(16,"ion-icon",26),l.Nb(),l.Nb(),l.Nb()}if(2&t){const t=e.$implicit,i=l.Yb(3);l.Ab(5),l.fc("ngIf",t.creador._id!==i.id),l.Ab(1),l.fc("ngIf",t.creador._id===i.id),l.Ab(2),l.yc("Fecha ",l.ac(9,5,t.fecha),""),l.Ab(2),l.fc("ngIf",t.chat),l.Ab(2),l.fc("ngIf",i.id===t.taller._id)}}function x(t,e){if(1&t&&(l.Ob(0,"div",14),l.Ob(1,"ion-list"),l.vc(2,w,17,7,"ion-item-sliding",15),l.Nb(),l.Nb()),2&t){const t=l.Yb(2);l.Ab(2),l.fc("ngForOf",t.pedidos)}}function E(t,e){if(1&t&&(l.Ob(0,"div"),l.vc(1,g,6,0,"div",10),l.vc(2,x,3,1,"div",11),l.Nb()),2&t){const t=l.Yb();l.Ab(1),l.fc("ngIf",0===t.pedidos.length),l.Ab(1),l.fc("ngIf",t.pedidos.length>0)}}function N(t,e){if(1&t){const t=l.Pb();l.Ob(0,"ion-fab",31),l.Ob(1,"ion-fab-button",32),l.Wb("click",function(){return l.pc(t),l.Yb().crear()}),l.Mb(2,"ion-icon",33),l.Nb(),l.Nb()}}const j=[{path:"",component:(()=>{class t{constructor(t,e,i,o,n,r){this.router=t,this.alert=e,this.almacenamiento=i,this.toast=o,this.apiPedidos=n,this.modal=r,this.configurando=!1,this.usuario="",this.habilitado=!1,this.cargado=!1,this.id="",this.pedidos=[],this.role=""}ngOnInit(){}ionViewWillEnter(){this.pedidosListar()}refrescando(t){this.pedidosListar().then(()=>{t.detail.complete()}).catch(()=>{t.detail.complete()})}pedidosListar(){return Object(a.a)(this,void 0,void 0,function*(){const t=yield this.almacenamiento.obtenerToken();t&&(this.role=t.role,this.id=t._id,this.usuario=t.nombre,this.apiPedidos.misPedido(t.token).subscribe(t=>{console.log(t),t.exe?this.pedidos=t.response:(this.toast.toastError("No se pudo consultar los pedidos, int\xe9ntelo m\xe1s tarde"),this.router.navigate(["/central/menu/"])),this.cargado=!0},t=>{this.toast.toastError("No se pudo consultar los pedidos, int\xe9ntelo m\xe1s tarde"),this.router.navigate(["/central/menu/"])}))})}crear(){return Object(a.a)(this,void 0,void 0,function*(){const t=yield this.alert.create({header:"Crear Pedido",message:"Escoge el m\xe9todo por el cu\xe1l deseas buscar al establecimiento que quieres solicitarle un pedido",buttons:[{text:"Buscador",cssClass:"validarAlerta",handler:()=>Object(a.a)(this,void 0,void 0,function*(){const t=yield this.modal.create({component:d.a,componentProps:{crear:"pedido"}});yield t.present();const e=yield t.onWillDismiss();e&&e.data&&e.data.exe&&this.pedidosListar()})}]});yield t.present()})}navegar(t,e){return Object(a.a)(this,void 0,void 0,function*(){this.pedidos[e].chat=!0;const i=yield this.almacenamiento.obtenerToken();i&&this.apiPedidos.consultarSala(i.token,{pedido:t}).subscribe(t=>{console.log(t),t.exe?(t.response.length>0?this.almacenamiento.insertarChat(t.response[0]).then(()=>{this.router.navigate(["/central/menu/chats/chat"]),this.pedidos[e].chat=!1}).catch(()=>{this.pedidos[e].chat=!1,this.toast.toastError("No se puede acceder al chat, int\xe9ntelo m\xe1s tarde")}):(this.pedidos[e].chat=!1,this.toast.toastError("No se puede acceder al chat, int\xe9ntelo m\xe1s tarde")),this.pedidos[e].chat=!1):(this.toast.toastError("No se puede acceder al chat, int\xe9ntelo m\xe1s tarde"),this.pedidos[e].chat=!1)},t=>{this.pedidos[e].chat=!1,this.toast.toastError("No se puede acceder al chat, int\xe9ntelo m\xe1s tarde")})})}info(t){this.router.navigate(["/central/menu/pedidos/info",t])}agregar(t){return Object(a.a)(this,void 0,void 0,function*(){const e=yield this.modal.create({component:c.a,componentProps:{pedido:t}});yield e.present()})}quitar(t){return Object(a.a)(this,void 0,void 0,function*(){const e=yield this.alert.create({header:"Atenci\xf3n!",message:"\xbfEstas seguro de abandonar este pedido? No podras visualizar de nuevo la informaci\xf3n.",buttons:[{text:"Cancelar",cssClass:"cancelarAlerta",role:"cancel",handler:()=>{}},{text:"Salir",cssClass:"botonalerta",handler:()=>Object(a.a)(this,void 0,void 0,function*(){const e=yield this.almacenamiento.obtenerToken();if(e){let i=this.pedidos.filter(e=>e._id===t)[0].accesos;i=i.map(t=>t._id),i=i.filter(t=>t!==e._id),console.log(i),this.apiPedidos.editarPedido(e.token,{id:t,accesos:i}).subscribe(t=>{t.exe?(this.toast.Especial("Saliste del pedido"),this.pedidosListar()):this.toast.toastError("No se pudo realizar la petici\xf3n, int\xe9ntelo m\xe1s tarde")},t=>{this.toast.toastError("No se pudo realizar la petici\xf3n, int\xe9ntelo m\xe1s tarde")})}})}]});yield e.present()})}}return t.\u0275fac=function(e){return new(e||t)(l.Lb(s.g),l.Lb(r.b),l.Lb(b.a),l.Lb(p.a),l.Lb(h.a),l.Lb(r.qb))},t.\u0275cmp=l.Fb({type:t,selectors:[["app-pedidos-inicio"]],decls:12,vars:3,consts:[["color","oscuro"],["slot","start","icon","chevron-back-outline","defaultHref","/central/menu"],["slot","fixed","pullFactor","0.5","pullMin","50","pullMax","150",3,"ionRefresh"],["pullingIcon","arrow-dropdown","refreshingSpinner","circles"],["class","flcenter ion-padding",4,"ngIf"],[1,"divider","light"],[4,"ngIf"],["vertical","bottom","horizontal","end","slot","fixed",4,"ngIf"],[1,"flcenter","ion-padding"],["name","crescent","color","oscuro"],["class","flcenter ion-padding ",4,"ngIf"],["class"," ",4,"ngIf"],[1,"ct"],["src","/assets/Estados.png","width","80px","alt",""],[1,""],[4,"ngFor","ngForOf"],[3,"click"],["slot","start"],["src","/assets/Estados.png"],[1,"ion-text-wrap"],["class","carga",4,"ngIf"],["side","end"],["color","barra",3,"click",4,"ngIf"],["color","primary",3,"click"],["name","chatbubble-outline","slot","icon-only"],["color","danger",3,"click"],["name","trash-outline","slot","icon-only"],[1,"carga"],["name","crescent"],["color","barra",3,"click"],["name","add-outline","slot","icon-only"],["vertical","bottom","horizontal","end","slot","fixed"],["color","oscuro",3,"click"],["name","add"]],template:function(t,e){1&t&&(l.Ob(0,"ion-header"),l.Ob(1,"ion-toolbar",0),l.Mb(2,"ion-back-button",1),l.Ob(3,"ion-title"),l.wc(4,"Pedidos"),l.Nb(),l.Nb(),l.Nb(),l.Ob(5,"ion-content"),l.Ob(6,"ion-refresher",2),l.Wb("ionRefresh",function(t){return e.refrescando(t)}),l.Mb(7,"ion-refresher-content",3),l.Nb(),l.vc(8,f,7,1,"div",4),l.Mb(9,"div",5),l.vc(10,E,3,2,"div",6),l.vc(11,N,3,0,"ion-fab",7),l.Nb()),2&t&&(l.Ab(8),l.fc("ngIf",!e.cargado),l.Ab(2),l.fc("ngIf",e.cargado),l.Ab(1),l.fc("ngIf","USER_ROLE"===e.role))},directives:[r.z,r.lb,r.g,r.h,r.jb,r.t,r.Q,r.R,o.j,r.cb,r.L,o.i,r.J,r.F,r.f,r.K,r.I,r.H,r.A,r.v,r.w],pipes:[u.a],styles:[".flcenter[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;align-items:center;font-size:20px;text-align:center}ion-card[_ngcontent-%COMP%]{position:relative}.carga[_ngcontent-%COMP%], .ct[_ngcontent-%COMP%]{display:flex;align-items:center}.ct[_ngcontent-%COMP%]{flex-direction:column;justify-content:center;font-size:20px;font-weight:300}.msg[_ngcontent-%COMP%]{position:absolute;top:0;right:0;text-align:center;padding:5px 10px;border-radius:10px}"]}),t})()}];let y=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=l.Jb({type:t}),t.\u0275inj=l.Ib({imports:[[s.j.forChild(j)],s.j]}),t})();var I=i("iTUp");let M=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=l.Jb({type:t}),t.\u0275inj=l.Ib({imports:[[o.b,n.e,r.mb,y,I.a]]}),t})()},r3ab:function(t,e,i){"use strict";i.d(e,"a",function(){return s});var o=i("mrSG"),n=i("fXoL"),r=i("TEn/");let s=(()=>{class t{constructor(t){this.loadingCtrl=t}cargaProcesos(t){return Object(o.a)(this,void 0,void 0,function*(){return this.loading=yield this.loadingCtrl.create({message:t}),this.loading.present()})}finalizarCargado(){this.loading.dismiss()}}return t.\u0275fac=function(e){return new(e||t)(n.Sb(r.ob))},t.\u0275prov=n.Hb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})()}}]);