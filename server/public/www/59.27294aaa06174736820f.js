(window.webpackJsonp=window.webpackJsonp||[]).push([[59],{SpuA:function(t,o,n){"use strict";n.d(o,"a",function(){return r});var e=n("wd/R"),i=n("fXoL");let r=(()=>{class t{transform(t){console.log(t,"fechin");let o=e.utc(t).toDate();return e(o).format("dddd, DD MMMM YYYY h:mm:a")}}return t.\u0275fac=function(o){return new(o||t)},t.\u0275pipe=i.Ib({name:"cambioUTC",type:t,pure:!0}),t})()},xVeN:function(t,o,n){"use strict";n.r(o),n.d(o,"ListaGruaPageModule",function(){return w});var e=n("ofXK"),i=n("3Pt+"),r=n("TEn/"),a=n("tyNb"),c=n("mrSG"),s=n("HDdC"),b=n("fXoL"),l=n("fsfq"),d=n("0xwK"),u=n("fmoy"),p=n("7JkF"),m=n("F6wp"),g=n("SpuA");function f(t,o){1&t&&(b.Mb(0,"div",8),b.Mb(1,"h3",9),b.rc(2,"No tienes ninguna solicitud activa en este momento"),b.Lb(),b.Lb())}function h(t,o){if(1&t){const t=b.Nb();b.Mb(0,"ion-card",12),b.Mb(1,"ion-card-header"),b.Kb(2,"app-mapas",13),b.Lb(),b.Mb(3,"strong",14),b.rc(4),b.Xb(5,"cambioUTC"),b.Lb(),b.Mb(6,"ion-card-title",15),b.rc(7),b.Lb(),b.Mb(8,"div",16),b.Mb(9,"p"),b.rc(10),b.Lb(),b.Kb(11,"div",17),b.Mb(12,"div"),b.Mb(13,"strong"),b.rc(14),b.Lb(),b.Lb(),b.Mb(15,"div"),b.Mb(16,"strong"),b.rc(17,"Tel\xe9fono: "),b.Lb(),b.rc(18),b.Lb(),b.Mb(19,"div"),b.Mb(20,"strong"),b.rc(21,"Correo: "),b.Lb(),b.rc(22),b.Lb(),b.Kb(23,"br"),b.Lb(),b.Mb(24,"ion-button",18),b.Ub("click",function(){b.lc(t);const n=o.$implicit;return b.Wb(2).tomar(n)}),b.rc(25,"TOMAR SOLICITUD"),b.Lb(),b.Lb()}if(2&t){const t=o.$implicit;b.zb(2),b.dc("lng",t.ubicacion.lng)("lat",t.ubicacion.lat),b.zb(2),b.sc(b.Yb(5,9,t.fecha)),b.zb(3),b.tc("",t.creador.nombrecompleto," "),b.zb(3),b.sc(t.descripcion),b.zb(4),b.uc("Ubicado en ",t.creador.ciudad,", ",t.creador.pais,""),b.zb(4),b.tc(" ",t.creador.tel,""),b.zb(4),b.tc(" ",t.creador.correo,"")}}function M(t,o){if(1&t&&(b.Mb(0,"div",10),b.qc(1,h,26,11,"ion-card",11),b.Lb()),2&t){const t=b.Wb();b.zb(1),b.dc("ngForOf",t.gruas)}}const L=[{path:"",component:(()=>{class t{constructor(t,o,n,e,i,r){this.router=t,this.almacenamiento=o,this.apiMonitoreo=n,this.toast=e,this.socket=i,this.alert=r,this.cargado=!1,this.gruas=[],this.escuchareliminados().subscribe(t=>{this.gruas=this.gruas.filter(o=>o._id!==t.id)})}ngOnInit(){}ionViewWillEnter(){this.comprobar()}refrescando(){this.comprobar()}crear(){this.router.navigate(["/central/menu/monitoreo/grua/crear/"])}escuchareliminados(){return new s.a(t=>{this.socket.on("gruachao",o=>{t.next(o)})})}comprobar(){return Object(c.a)(this,void 0,void 0,function*(){const t=yield this.almacenamiento.obtenerToken();t&&this.apiMonitoreo.consultarGrua(t.token).subscribe(t=>{console.log(t,"DATON"),this.cargado=!0,t.exe?this.gruas=t.response:this.toast.toastError("No se pudo completar la petici\xf3n, int\xe9ntelo m\xe1s tarde")},t=>{this.toast.toastError("No se pudo completar la petici\xf3n, int\xe9ntelo m\xe1s tarde")})})}tomar(t){return Object(c.a)(this,void 0,void 0,function*(){const o=yield this.alert.create({header:"Atenci\xf3n!",message:"\xbfQuieres ayudar al usuario con su solicitud.",buttons:[{text:"Cancelar",cssClass:"cancelarAlerta",role:"cancel",handler:()=>{}},{text:"Acepto",cssClass:"botonalerta",handler:()=>Object(c.a)(this,void 0,void 0,function*(){const o=yield this.almacenamiento.obtenerToken();o&&this.apiMonitoreo.GruaEditar(o.token,{id:t._id}).subscribe(n=>{console.log(n,"DATON",t,o.nombre),this.cargado=!0,n.exe?(this.socket.emit("gruatomar",{info:{chat:n.chat,personas:n.response},usuario:t.creador._id,nombre:o.nombre}),this.router.navigate(["/central/menu/monitoreo/listado-agregados"])):this.toast.toastError("No se pudo completar la petici\xf3n, int\xe9ntelo m\xe1s tarde")},t=>{this.toast.toastError("No se pudo completar la petici\xf3n, int\xe9ntelo m\xe1s tarde")})})}]});yield o.present()})}}return t.\u0275fac=function(o){return new(o||t)(b.Jb(a.g),b.Jb(l.a),b.Jb(d.a),b.Jb(u.a),b.Jb(p.a),b.Jb(r.b))},t.\u0275cmp=b.Db({type:t,selectors:[["app-lista-grua"]],decls:11,vars:2,consts:[[1,"ion-no-border"],["color","oscuro"],["slot","start","icon","chevron-back-outline","defaultHref","/central/menu/monitoreo"],["slot","end"],[3,"click"],["name","reload-outline","slot","icon-only"],["class","flex",4,"ngIf"],["class","opts",4,"ngIf"],[1,"flex"],[1,"titulo"],[1,"opts"],["color","light","mode","ios",4,"ngFor","ngForOf"],["color","light","mode","ios"],[3,"lng","lat"],[1,"gris"],[1,"tit"],[1,"info"],[1,"separador"],["color","barra","mode","ios","expand","block",3,"click"]],template:function(t,o){1&t&&(b.Mb(0,"ion-header",0),b.Mb(1,"ion-toolbar",1),b.Kb(2,"ion-back-button",2),b.Mb(3,"ion-title"),b.rc(4,"Listado de solicitudes"),b.Lb(),b.Mb(5,"ion-buttons",3),b.Mb(6,"ion-button",4),b.Ub("click",function(){return o.refrescando()}),b.Kb(7,"ion-icon",5),b.Lb(),b.Lb(),b.Lb(),b.Lb(),b.Mb(8,"ion-content"),b.qc(9,f,3,0,"div",6),b.qc(10,M,2,1,"div",7),b.Lb()),2&t&&(b.zb(9),b.dc("ngIf",o.cargado&&0===o.gruas.length),b.zb(1),b.dc("ngIf",o.cargado))},directives:[r.z,r.kb,r.g,r.h,r.ib,r.k,r.j,r.A,r.t,e.j,e.i,r.l,r.n,m.a,r.p],pipes:[g.a],styles:[".flex[_ngcontent-%COMP%]{display:flex;justify-content:center;flex-direction:column;align-items:center;margin:100px 0}.titulo[_ngcontent-%COMP%]{text-align:center;max-width:300px;font-size:18px;font-weight:300}.mapa[_ngcontent-%COMP%]{width:100%;height:300px}.tit[_ngcontent-%COMP%]{font-size:18px}.gris[_ngcontent-%COMP%], .tit[_ngcontent-%COMP%]{padding:10px}.gris[_ngcontent-%COMP%]{color:var(--ion-color-medium)}.info[_ngcontent-%COMP%]{padding:10px}"]}),t})()}];let v=(()=>{class t{}return t.\u0275mod=b.Hb({type:t}),t.\u0275inj=b.Gb({factory:function(o){return new(o||t)},imports:[[a.i.forChild(L)],a.i]}),t})();var x=n("iTUp"),k=n("zon2");let w=(()=>{class t{}return t.\u0275mod=b.Hb({type:t}),t.\u0275inj=b.Gb({factory:function(o){return new(o||t)},imports:[[e.b,i.e,r.lb,v,x.a,k.a]]}),t})()}}]);