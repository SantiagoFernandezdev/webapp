(window.webpackJsonp=window.webpackJsonp||[]).push([[38],{gUiv:function(t,e,o){"use strict";o.r(e),o.d(e,"InterfazGrupoCHatsPageModule",function(){return B});var i=o("ofXK"),s=o("3Pt+"),n=o("TEn/"),r=o("tyNb"),a=o("mrSG"),c=o("R0Ic"),l=o("HDdC"),h=o("ypew"),d=o("fXoL"),p=o("fsfq"),b=o("oQG1"),u=o("fmoy"),f=o("vLoH"),g=o("a/9d"),m=o("r3ab"),v=o("Gq8O"),O=o("7JkF");function j(t,e){1&t&&(d.Ob(0,"ion-title"),d.wc(1,"Integrantes"),d.Nb())}function w(t,e){1&t&&(d.Ob(0,"div",6),d.Mb(1,"img",7),d.Ob(2,"h3"),d.wc(3,"No tiene acceso para ver esta informaci\xf3n, env\xede una invitaci\xf3n a este grupo"),d.Nb(),d.Nb())}function x(t,e){1&t&&(d.Ob(0,"div",16),d.Ob(1,"strong"),d.wc(2,"Creador de\xf1 grupo"),d.Nb(),d.Nb())}function k(t,e){if(1&t){const t=d.Pb();d.Ob(0,"ion-item",9),d.Ob(1,"ion-avatar",10),d.Mb(2,"img",11),d.Nb(),d.Ob(3,"ion-label",12),d.Ob(4,"strong",13),d.wc(5),d.Nb(),d.Mb(6,"br"),d.Ob(7,"div"),d.wc(8),d.Nb(),d.vc(9,x,3,0,"div",14),d.Nb(),d.Ob(10,"ion-checkbox",15),d.Wb("ionChange",function(o){d.pc(t);const i=e.$implicit;return d.Yb(2).seleccion(o,i)}),d.Nb(),d.Nb()}if(2&t){const t=e.$implicit,o=d.Yb(2);d.Ab(2),d.hc("src","https://motocaliapp.com/",t.imagen[0].path,"",d.qc),d.Ab(3),d.xc(t.nombrecompleto),d.Ab(3),d.yc("@",t.nombreusuario,""),d.Ab(1),d.fc("ngIf",t._id===o.grupo.creador)}}function N(t,e){if(1&t&&(d.Ob(0,"ion-list"),d.vc(1,k,11,4,"ion-item",8),d.Nb()),2&t){const t=d.Yb();d.Ab(1),d.fc("ngForOf",t.grupo.integrantes)}}function E(t,e){if(1&t){const t=d.Pb();d.Ob(0,"ion-footer"),d.Ob(1,"ion-toolbar",17),d.Wb("click",function(){return d.pc(t),d.Yb().crear()}),d.Ob(2,"ion-title"),d.wc(3,"Crear Chat"),d.Nb(),d.Ob(4,"ion-buttons",18),d.Ob(5,"ion-button"),d.Mb(6,"ion-icon",19),d.Nb(),d.Nb(),d.Nb(),d.Nb()}}let C=(()=>{class t{constructor(t,e,o,i,s,n,r,a,c,l,h,d,p){this.almacenamiento=t,this.apiUsuario=e,this.toast=o,this.apiGrupos=i,this.router=s,this.active=n,this.actionCtrl=r,this.camera=a,this.loadingService=c,this.seguimientoService=l,this.socket=h,this.alert=d,this.modal=p,this.cargado=!1,this.solicitudEnviada=!1,this.cargarInformacion=!1,this.mostrar=!1,this.accesos=[],this.dp=[]}ngOnInit(){}ionViewWillEnter(){this.listar()}refrescando(t){this.solicitudEnviada=!1,this.cargado=!1,this.listar().then(()=>{t.target.complete()}).catch(()=>{t.target.complete()})}seleccion(t,e){t.detail.checked?0===this.accesos.filter(t=>t===e._id).length&&(this.accesos.push(e._id),this.dp.push(e.usuarioID)):(this.accesos=this.accesos.filter(t=>t!==e._id),this.dp=this.dp.filter(t=>t!==e.usuarioID)),console.log(t,this.accesos,this.dp)}listar(){return Object(a.a)(this,void 0,void 0,function*(){const t=yield this.almacenamiento.obtenerToken();t&&(this.id=t._id,this.apiGrupos.integrantes(t.token,{id:this.grupoid}).subscribe(t=>{console.log(t),t.exe?(this.grupo=t.response[0],this.mostrar=this.grupo.integrantes.filter(t=>t._id===this.id).length>0,console.log(t)):this.toast.toastError("No se pudo consultar la informaci\xf3n, int\xe9ntelo m\xe1s tarde"),this.cargado=!0},t=>{this.toast.toastError("No se pudo consultar la informaci\xf3n, int\xe9ntelo m\xe1s tarde"),this.cargado=!0}))})}eliminari(t,e){return Object(a.a)(this,void 0,void 0,function*(){const o=yield this.alert.create({header:"Atenci\xf3n!",message:"\xbfQuieres sacar a este usuario del grupo?",buttons:[{text:"Cancelar",role:"cancel",cssClass:"cancelarAlerta"},{text:"Sacar",cssClass:"botonalerta",handler:()=>{this.almacenamiento.obtenerToken().then(o=>{console.log(t),this.seguimientoService.cancelarSolicitudGrupoAdmin(o.token,this.grupo.usuario,{grupo:this.grupo._id,usuario:t}).subscribe(t=>{console.log(t),t.exe&&this.grupo.integrantes.splice(e,1)},t=>{console.log(t),this.toast.alertApplication(t.message,!1)})}).catch(t=>{this.toast.alertApplication(t,!1)})}}]});yield o.present()})}crear(){return Object(a.a)(this,void 0,void 0,function*(){const t=yield this.almacenamiento.obtenerToken();t&&(this.id=t._id,this.dp=this.dp.filter(t=>""!==t),this.apiGrupos.chat(t.token,{grupoid:this.grupoid,gruponombre:this.nombre,grupousuario:this.grupousuario,accesos:this.accesos,dp:this.dp}).subscribe(t=>{console.log(t),t.exe?(this.toast.toastExitoso("Chat creado"),this.modal.dismiss()):this.toast.toastError("No se pudo consultar la informaci\xf3n, int\xe9ntelo m\xe1s tarde"),this.cargado=!0},t=>{this.toast.toastError("No se pudo consultar la informaci\xf3n, int\xe9ntelo m\xe1s tarde"),this.cargado=!0}))})}}return t.\u0275fac=function(e){return new(e||t)(d.Lb(p.a),d.Lb(b.a),d.Lb(u.a),d.Lb(f.a),d.Lb(r.g),d.Lb(r.a),d.Lb(n.a),d.Lb(g.a),d.Lb(m.a),d.Lb(v.a),d.Lb(O.a),d.Lb(n.b),d.Lb(n.qb))},t.\u0275cmp=d.Fb({type:t,selectors:[["app-chatsgrupo"]],inputs:{grupoid:"grupoid",nombre:"nombre",grupousuario:"grupousuario"},decls:10,vars:4,consts:[["color","oscuro"],["icon","chevron-back-outline","defaultHref","/interactivo/grupos","slot","start"],[4,"ngIf"],["slot","fixed","pullFactor","0.5","pullMin","50","pullMax","150",3,"ionRefresh"],["pullingIcon","arrow-dropdown","refreshingSpinner","circles"],["class","fcenter",4,"ngIf"],[1,"fcenter"],["src","/assets/No.png","width","100px","alt",""],["color","blanco",4,"ngFor","ngForOf"],["color","blanco"],["slot","start"],["width","100%","height","100%",3,"src"],[1,"ion-text-wrap"],[1,"small"],["class","creador",4,"ngIf"],["slot","end","mode","ios","color","warning",3,"ionChange"],[1,"creador"],["color","masoscuro",3,"click"],["slot","end"],["slot","icon-only","name","chevron-forward-outline"]],template:function(t,e){1&t&&(d.Ob(0,"ion-header"),d.Ob(1,"ion-toolbar",0),d.Mb(2,"ion-back-button",1),d.vc(3,j,2,0,"ion-title",2),d.Nb(),d.Nb(),d.Ob(4,"ion-content"),d.Ob(5,"ion-refresher",3),d.Wb("ionRefresh",function(t){return e.refrescando(t)}),d.Mb(6,"ion-refresher-content",4),d.Nb(),d.vc(7,w,4,0,"div",5),d.vc(8,N,2,1,"ion-list",2),d.Nb(),d.vc(9,E,7,0,"ion-footer",2)),2&t&&(d.Ab(3),d.fc("ngIf",e.grupo),d.Ab(4),d.fc("ngIf",e.cargado&&!e.mostrar),d.Ab(1),d.fc("ngIf",e.cargado&&e.mostrar),d.Ab(1),d.fc("ngIf",e.accesos.length>1))},directives:[n.z,n.lb,n.g,n.h,i.j,n.t,n.Q,n.R,n.jb,n.L,i.i,n.F,n.f,n.K,n.q,n.d,n.x,n.k,n.j,n.A],styles:[""]}),t})();var y=o("HavB"),A=o("SpuA");const I=["inifinito"],M=["contenido"];function _(t,e){if(1&t&&(d.Ob(0,"div",13),d.Mb(1,"ion-spinner",14),d.Ob(2,"div"),d.wc(3," Cargando chats... "),d.Mb(4,"br"),d.Ob(5,"strong"),d.wc(6),d.Nb(),d.Nb(),d.Nb()),2&t){const t=d.Yb(2);d.Ab(6),d.yc(" ",t.usuario,"")}}function $(t,e){1&t&&(d.Ob(0,"div",13),d.Ob(1,"div",17),d.Mb(2,"img",18),d.Mb(3,"br"),d.wc(4," A\xfan no tiene chats creados "),d.Mb(5,"br"),d.Nb(),d.Nb())}function L(t,e){if(1&t&&(d.Ob(0,"ion-avatar",31),d.Mb(1,"img",32),d.Nb()),2&t){const t=d.Yb().$implicit;d.fc("@escribiendo",t.escribiendo?"activo":"noactivo"),d.Ab(1),d.hc("src","https://www.motocaliapp.com/",t.taller.imagen[0].path,"",d.qc)}}function P(t,e){if(1&t&&(d.Ob(0,"ion-avatar",31),d.Mb(1,"img",32),d.Nb()),2&t){const t=d.Yb().$implicit;d.fc("@escribiendo",t.escribiendo?"activo":"noactivo"),d.Ab(1),d.hc("src","https://www.motocaliapp.com/",t.creador.imagen[0].path,"",d.qc)}}function z(t,e){if(1&t&&(d.Ob(0,"strong"),d.wc(1),d.Nb()),2&t){const t=d.Yb().$implicit;d.Ab(1),d.yc(" ",t.creador.nombrecompleto,"")}}function Y(t,e){if(1&t&&(d.Ob(0,"strong"),d.wc(1),d.Nb()),2&t){const t=d.Yb().$implicit;d.Ab(1),d.yc(" ",t.taller.nombrecompleto,"")}}function T(t,e){1&t&&(d.Ob(0,"span"),d.wc(1," Escribiendo..."),d.Nb())}function S(t,e){if(1&t&&(d.Ob(0,"div",33),d.wc(1),d.Nb()),2&t){const t=d.Yb().$implicit;d.Ab(1),d.xc(t.novistos)}}function G(t,e){if(1&t){const t=d.Pb();d.Ob(0,"ion-item-option",34),d.Wb("click",function(){d.pc(t);const e=d.Yb().$implicit;return d.Yb(4).agregar(e)}),d.Mb(1,"ion-icon",35),d.Nb()}}function F(t,e){if(1&t){const t=d.Pb();d.Ob(0,"ion-item-sliding"),d.Ob(1,"ion-item",21),d.Wb("click",function(){d.pc(t);const o=e.$implicit;return d.Yb(4).entrar(o)}),d.vc(2,L,2,2,"ion-avatar",22),d.vc(3,P,2,2,"ion-avatar",22),d.Ob(4,"ion-label",23),d.Ob(5,"div",24),d.vc(6,z,2,1,"strong",2),d.vc(7,Y,2,1,"strong",2),d.Nb(),d.Ob(8,"strong"),d.wc(9),d.Nb(),d.Ob(10,"div"),d.wc(11),d.Zb(12,"cambioUTC"),d.Nb(),d.Ob(13,"div",25),d.vc(14,T,2,0,"span",2),d.Nb(),d.vc(15,S,2,1,"div",26),d.Nb(),d.Nb(),d.Ob(16,"ion-item-options",27),d.vc(17,G,2,0,"ion-item-option",28),d.Ob(18,"ion-item-option",29),d.Wb("click",function(){d.pc(t);const o=e.$implicit;return d.Yb(4).quitar(o._id)}),d.Mb(19,"ion-icon",30),d.Nb(),d.Nb(),d.Nb()}if(2&t){const t=e.$implicit,o=d.Yb(4);d.Ab(2),d.fc("ngIf",t.creador._id===o.id),d.Ab(1),d.fc("ngIf",t.creador._id!==o.id),d.Ab(2),d.fc("@escribiendo",t.escribiendo?"activo":"noactivo"),d.Ab(1),d.fc("ngIf",t.creador._id!==o.id),d.Ab(1),d.fc("ngIf",t.creador._id===o.id),d.Ab(1),d.Db("ticket","ticket"===t.tipo)("pedido","pedido"===t.tipo)("hoja","hoja"===t.tipo),d.fc("@escribiendo",t.escribiendo?"activo":"noactivo"),d.Ab(1),d.yc("Chat Tipo: ",t.tipo,""),d.Ab(1),d.fc("@escribiendo",t.escribiendo?"activo":"noactivo"),d.Ab(1),d.xc(d.ac(12,18,t.fecha)),d.Ab(3),d.fc("ngIf",t.escribiendo),d.Ab(1),d.fc("ngIf",t.novistos>0),d.Ab(2),d.fc("ngIf",t.taller._id===o.id||"TALLER_ROLE"===o.role)}}function R(t,e){if(1&t&&(d.Ob(0,"div",19),d.Ob(1,"ion-list"),d.vc(2,F,20,20,"ion-item-sliding",20),d.Nb(),d.Nb()),2&t){const t=d.Yb(3);d.Ab(2),d.fc("ngForOf",t.salas)}}function q(t,e){if(1&t&&(d.Ob(0,"div"),d.vc(1,$,6,0,"div",15),d.vc(2,R,3,1,"div",16),d.Nb()),2&t){const t=d.Yb(2);d.Ab(1),d.fc("ngIf",0===t.salas.length),d.Ab(1),d.fc("ngIf",t.salas.length>0)}}function W(t,e){if(1&t){const t=d.Pb();d.Ob(0,"ion-infinite-scroll",36,37),d.Wb("ionInfinite",function(e){return d.pc(t),d.Yb(2).loadData(e)}),d.Mb(2,"ion-infinite-scroll-content",38),d.Nb()}}function H(t,e){if(1&t){const t=d.Pb();d.Ob(0,"ion-content",null,3),d.Ob(2,"ion-refresher",4),d.Wb("ionRefresh",function(e){return d.pc(t),d.Yb().refrescando(e)}),d.Mb(3,"ion-refresher-content",5),d.Nb(),d.Ob(4,"ion-searchbar",6),d.Wb("ionChange",function(e){return d.pc(t),d.Yb().buscar(e)}),d.Nb(),d.vc(5,_,7,1,"div",7),d.Mb(6,"div",8),d.vc(7,q,3,2,"div",2),d.vc(8,W,3,0,"ion-infinite-scroll",9),d.Ob(9,"ion-fab",10),d.Ob(10,"ion-fab-button",11),d.Wb("click",function(){return d.pc(t),d.Yb().crearChat()}),d.Mb(11,"ion-icon",12),d.Nb(),d.Nb(),d.Nb()}if(2&t){const t=d.Yb();d.Ab(5),d.fc("ngIf",!t.cargado),d.Ab(2),d.fc("ngIf",t.cargado),d.Ab(1),d.fc("ngIf",t.cargado)}}const U=[{path:"",component:(()=>{class t{constructor(t,e,o,i,s,n,r,c,l,h,d){this.router=t,this.alert=e,this.almacenamiento=o,this.toast=i,this.apiPedidos=s,this.socket=n,this.modal=r,this.plt=c,this.active=l,this.nav=h,this.apiGrupos=d,this.configurando=!1,this.usuario="",this.habilitado=!1,this.cargado=!1,this.id="",this.salas=[],this.desde=0,this.patron="",this.scroll=!0,this.role="",this.parar=!1,this.mostrar=!1,this.plt.backButton.subscribe(()=>{}),this.escucharEscritoss().subscribe(t=>{console.log("escribiendo...",t),t.exe&&this.salas.forEach(e=>{e._id===t.idsala&&(console.log("existe"),e.escribiendo=!0,setTimeout(()=>{e.escribiendo=!1},500))})}),this.escucharMensaje().subscribe(t=>Object(a.a)(this,void 0,void 0,function*(){if(console.log("mensaje",t),t.exe){const e=yield this.almacenamiento.obtenerToken();if(e){const o=this.salas.filter(e=>e._id===t.resp.sala._id);this.apiPedidos.mensajes(e.token,{idsala:o[0]._id}).subscribe(e=>{this.salas=this.salas.filter(e=>e._id!==t.resp.sala._id),o[0].novistos=e.exe?e.response.length:0,this.salas.unshift(o[0])},e=>{this.salas=this.salas.filter(e=>e._id!==t.resp.sala._id),o[0].novistos=0,this.salas.unshift(o[0])})}}}))}ngOnInit(){}ionViewWillEnter(){this.parar=!1,this.listar()}listar(){return Object(a.a)(this,void 0,void 0,function*(){const t=yield this.almacenamiento.obtenerToken();t&&(this.id=t._id,this.apiGrupos.integrantes(t.token,{id:this.active.snapshot.paramMap.get("id")}).subscribe(t=>{console.log(t),t.exe?(this.grupo=t.response[0],this.grupo.integrantes.filter(t=>t._id===this.id).length>0?(this.mostrar=!0,this.pedidosListar()):this.mostrar=!1,console.log(t)):this.toast.toastError("No se pudo consultar la informaci\xf3n, int\xe9ntelo m\xe1s tarde"),this.cargado=!0},t=>{this.toast.toastError("No se pudo consultar la informaci\xf3n, int\xe9ntelo m\xe1s tarde"),this.cargado=!0}))})}refrescando(t){this.listar().then(()=>{t.detail.complete()}).catch(()=>{t.detail.complete()})}pedidosListar(){return Object(a.a)(this,void 0,void 0,function*(){this.salas=[];const t=yield this.almacenamiento.obtenerToken();t&&(this.role=t.role,this.id=t._id,this.usuario=t.nombre,this.apiPedidos.misChatsGrupos(t.token,{patron:"",desde:this.desde}).subscribe(e=>{if(e.exe){let o=e.response.length;e.response.forEach(i=>Object(a.a)(this,void 0,void 0,function*(){i.escribiendo=!1,this.socket.emit("iniciochat",{id:i._id}),(yield new Promise((e,o)=>{this.apiPedidos.mensajes(t.token,{idsala:i._id}).subscribe(t=>{t.exe?(console.log(t,"RESPUESTA DEL TODO"),i.fechamsg=t.response.lemgth>0?t.response[t.response.length-1]:i.fecha,i.novistos=t.response.length,e(!0)):(i.novistos=0,e(!0))},t=>{i.novistos=0,e(!0)})}))&&(o-=1,0===o&&(this.salas=e.response,console.log(this.salas,"salas",o),this.salas.sort((t,e)=>(console.log(t.novistos),t.novistos<e.novistos?(console.log("meno"),1):t.novistos>e.novistos?(console.log("mayor"),-1):0))),this.cargado=!0)})),0===e.response.length&&(this.cargado=!0)}else this.toast.toastError("No se pudo consultar los pedidos, int\xe9ntelo m\xe1s tarde"),this.router.navigate(["/central/menu/"]),this.cargado=!0},t=>{this.toast.toastError("No se pudo consultar los pedidos, int\xe9ntelo m\xe1s tarde"),this.router.navigate(["/central/menu/"])}))})}crear(){return Object(a.a)(this,void 0,void 0,function*(){const t=yield this.alert.create({header:"Crear Pedido",message:"Los pedidos puedes realizarlos para comprar los repuestos o productos que necesites para tu veh\xedculo.",buttons:[{text:"Cancelar",cssClass:"cancelarAlerta",role:"cancel",handler:()=>{}},{text:"Crear",cssClass:"botonalerta",handler:t=>{this.router.navigate(["/central/menu/control-mapas"])}}]});yield t.present()})}escucharEscritoss(){return new l.a(t=>{this.socket.on("escribiendoChat",e=>{t.next(e)})})}escucharMensaje(){return new l.a(t=>{this.socket.on("mensajeChat",e=>{t.next(e)})})}entrar(t){this.almacenamiento.insertarChat(t).then(()=>{this.nav.navigateRoot(["/interfaz-grupo",this.active.snapshot.paramMap.get("id"),"apps",this.active.snapshot.paramMap.get("id"),"chats",this.active.snapshot.paramMap.get("id"),"chat",this.active.snapshot.paramMap.get("id")])}).catch(()=>{this.toast.toastError("No se puede acceder al chat, int\xe9ntelo m\xe1s tarde")})}agregar(t){return Object(a.a)(this,void 0,void 0,function*(){const e=yield this.modal.create({component:h.a,componentProps:{sala:t}});yield e.present()})}quitar(t){return Object(a.a)(this,void 0,void 0,function*(){const e=yield this.alert.create({header:"Atenci\xf3n!",message:"\xbfEstas seguro de abandonar esta sala? No podras visualizar de nuevo la  informaci\xf3n dentro de ella",buttons:[{text:"Cancelar",cssClass:"cancelarAlerta",role:"cancel",handler:()=>{}},{text:"Salir",cssClass:"botonalerta",handler:()=>Object(a.a)(this,void 0,void 0,function*(){const e=yield this.almacenamiento.obtenerToken();if(e){let o=this.salas.filter(e=>e._id===t)[0].accesos;o=o.map(t=>t._id),o=o.filter(t=>t!==e._id),console.log(o," eliminado"),console.log(o),this.apiPedidos.editarChat(e.token,{id:t,accesos:o}).subscribe(t=>{t.exe?(this.toast.Especial("Saliste de la sala"),this.pedidosListar()):this.toast.toastError("No se pudo realizar la petici\xf3n, int\xe9ntelo m\xe1s tarde")},t=>{this.toast.toastError("No se pudo realizar la petici\xf3n, int\xe9ntelo m\xe1s tarde")})}})}]});yield e.present()})}buscar(t){return Object(a.a)(this,void 0,void 0,function*(){if(""!==t.detail.value){this.desde=0,this.infinite.disabled=!1,this.patron=t.detail.value;const e=yield this.almacenamiento.obtenerToken();e&&this.apiPedidos.misChatsGrupos(e.token,{desde:this.desde,patron:this.patron}).subscribe(t=>{t.exe?(this.salas=t.response,0===t.response.length&&(this.desde=0)):this.toast.toastError("No se pudo realizar la consulta, intentelo m\xe1s tarde")},t=>{this.toast.toastError("No se pudo realizar la consulta, intentelo m\xe1s tarde")})}else this.desde=0,this.pedidosListar()})}loadData(t){return Object(a.a)(this,void 0,void 0,function*(){this.desde=this.desde+15;const e=yield this.almacenamiento.obtenerToken();e&&(""===this.patron?this.apiPedidos.misChatsGrupos(e.token,{desde:this.desde,patron:this.patron}).subscribe(e=>{e.exe?e.response.length>0?(e.response.forEach(t=>{this.salas.push(t)}),t.target.complete()):(t.target.disabled=!0,this.desde=0):this.toast.toastError("No se pudo traer los chats, int\xe9ntelo m\xe1s tarde.")},t=>{this.toast.toastError("No se pudo traer los chats, int\xe9ntelo m\xe1s tarde.")}):this.apiPedidos.misChatsGrupos(e.token,{desde:this.desde,patron:this.patron}).subscribe(e=>{e.exe?e.response.length>0?(e.response.forEach(t=>{this.salas.push(t)}),t.target.complete()):(t.target.disabled=!0,this.desde=0):this.toast.toastError("No se pudo realizar la consulta, intentelo m\xe1s tarde")},t=>{this.toast.toastError("No se pudo realizar la consulta, intentelo m\xe1s tarde")}))})}crearChat(){return Object(a.a)(this,void 0,void 0,function*(){const t=yield this.modal.create({component:C,componentProps:{grupoid:this.active.snapshot.paramMap.get("id"),nombre:this.grupo.nombre,grupousuario:this.grupo.usuario}});yield t.present()})}ionViewWillLeave(){this.parar=!0,this.salas.forEach(t=>{this.socket.emit("salidachat",{id:t._id})})}}return t.\u0275fac=function(e){return new(e||t)(d.Lb(r.g),d.Lb(n.b),d.Lb(p.a),d.Lb(u.a),d.Lb(y.a),d.Lb(O.a),d.Lb(n.qb),d.Lb(n.tb),d.Lb(r.a),d.Lb(n.rb),d.Lb(f.a))},t.\u0275cmp=d.Fb({type:t,selectors:[["app-interfaz-grupo-chats"]],viewQuery:function(t,e){if(1&t&&(d.Ac(I,1),d.Ac(M,1)),2&t){let t;d.oc(t=d.Xb())&&(e.infinite=t.first),d.oc(t=d.Xb())&&(e.contenido=t.first)}},decls:6,vars:1,consts:[["color","oscuro"],["slot","start","icon","chevron-back-outline","defaultHref","/central/menu"],[4,"ngIf"],["contenido",""],["slot","fixed","pullFactor","0.5","pullMin","50","pullMax","150",3,"ionRefresh"],["pullingIcon","arrow-dropdown","refreshingSpinner","circles"],["debounce","300","mode","ios","placeholder","Buscar chats por tipo",3,"ionChange"],["class","flcenter ion-padding",4,"ngIf"],[1,"divider","light"],["threshold","100px",3,"ionInfinite",4,"ngIf"],["vertical","bottom","horizontal","end","slot","fixed"],["color","oscuro",3,"click"],["name","add-outline"],[1,"flcenter","ion-padding"],["name","crescent","color","oscuro"],["class","flcenter ion-padding ",4,"ngIf"],["class"," ",4,"ngIf"],[1,"ct"],["src","/assets/Chats.png","width","80px","alt",""],[1,""],[4,"ngFor","ngForOf"],[3,"click"],["slot","start",4,"ngIf"],[1,"relativo"],[1,"info"],[1,"escribiendo"],["class","nv",4,"ngIf"],["side","end"],["color","barra",3,"click",4,"ngIf"],["color","danger",3,"click"],["name","trash-outline","slot","icon-only"],["slot","start"],[3,"src"],[1,"nv"],["color","barra",3,"click"],["name","add-outline","slot","icon-only"],["threshold","100px",3,"ionInfinite"],["inifinito",""],["loadingSpinner","bubbles","loadingText","Cargando Chats..."]],template:function(t,e){1&t&&(d.Ob(0,"ion-header"),d.Ob(1,"ion-toolbar",0),d.Mb(2,"ion-back-button",1),d.Ob(3,"ion-title"),d.wc(4,"Chats"),d.Nb(),d.Nb(),d.Nb(),d.vc(5,H,12,3,"ion-content",2)),2&t&&(d.Ab(5),d.fc("ngIf",e.scroll))},directives:[n.z,n.lb,n.g,n.h,n.jb,i.j,n.t,n.Q,n.R,n.U,n.yb,n.v,n.w,n.A,n.cb,n.L,i.i,n.J,n.F,n.K,n.I,n.H,n.f,n.C,n.D],pipes:[A.a],styles:[".flcenter[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;align-items:center;font-size:20px;text-align:center}ion-card[_ngcontent-%COMP%]{position:relative}.tp[_ngcontent-%COMP%]{z-index:10;background-color:initial}.ct[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;font-size:20px;font-weight:300}.msg[_ngcontent-%COMP%]{position:absolute;top:0;right:0;text-align:center;padding:5px 10px;border-radius:10px}.escribiendo[_ngcontent-%COMP%]{color:#627e42;font-weight:700;font-size:14px;height:20px}.relativo[_ngcontent-%COMP%]{position:relative}.nv[_ngcontent-%COMP%]{position:absolute;bottom:5px;right:5px;background-color:#627e42;color:#fff;text-align:center;min-width:20px;min-height:20px;max-width:50px;max-height:50px;border-radius:100%}.info[_ngcontent-%COMP%]{width:70%}.ticket[_ngcontent-%COMP%]{color:#e53935}.pedido[_ngcontent-%COMP%]{color:orange}.hoja[_ngcontent-%COMP%]{color:#4a4a4a}"],data:{animation:[Object(c.m)("escribiendo",[Object(c.j)("activo",Object(c.k)({opacity:.5})),Object(c.j)("noactivo",Object(c.k)({opacity:1})),Object(c.l)("activo <=> noactivo",[Object(c.e)("300ms")])])]}}),t})()}];let D=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=d.Jb({type:t}),t.\u0275inj=d.Ib({imports:[[r.j.forChild(U)],r.j]}),t})();var J=o("iTUp");let B=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=d.Jb({type:t}),t.\u0275inj=d.Ib({imports:[[i.b,s.e,n.mb,D,J.a]]}),t})()},r3ab:function(t,e,o){"use strict";o.d(e,"a",function(){return r});var i=o("mrSG"),s=o("fXoL"),n=o("TEn/");let r=(()=>{class t{constructor(t){this.loadingCtrl=t}cargaProcesos(t){return Object(i.a)(this,void 0,void 0,function*(){return this.loading=yield this.loadingCtrl.create({message:t}),this.loading.present()})}finalizarCargado(){this.loading.dismiss()}}return t.\u0275fac=function(e){return new(e||t)(s.Sb(n.ob))},t.\u0275prov=s.Hb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})()},vLoH:function(t,e,o){"use strict";o.d(e,"a",function(){return g});var i=o("tk/3"),s=o("PqYM"),n=o("Cfvw"),r=o("coGc"),a=o("lJxs"),c=o("IzEk"),l=o("MtjB"),h=o("JIr8"),d=o("AytR"),p=o("fXoL"),b=o("B7Rs"),u=o("fsfq"),f=o("TEn/");let g=(()=>{class t{constructor(t,e,o,i){this.http=t,this.transfer=e,this.almacenamiento=o,this.navCtrl=i}hanflerError(t){let e=0;return t.pipe(Object(r.a)(()=>Object(s.a)(5e3)),Object(a.a)(t=>{if(e++,console.log("Entramos a intentos"),t instanceof ErrorEvent){if(3===e)throw new Error("Error de Red")}else{if(!(t instanceof ProgressEvent))throw 404===t.status?new Error(" al realizar la solicictud "):401===t.status?(this.almacenamiento.terminarPartida().then(()=>{this.navCtrl.navigateRoot("/home")}),new Error("No tiene permisos para realizar la petici\xf3n ")):(console.log(t,"Error de servidor"),new Error(" No se pudo realizar la petici\xf3n, intentalo m\xe1s tarde "));if(3===e)throw new Error("Error de Red")}}),Object(c.a)(3))}crearGrupo(t,e){const o={headers:new i.c({"x-token":t})};return this.http.post(`${d.a}/grupos/crear`,e,o).pipe(Object(l.a)(t=>this.hanflerError(t)))}listarGrupos(t,e){const o={headers:new i.c({"x-token":t})};return this.http.put(`${d.a}/grupos/lista`,e,o).pipe(Object(l.a)(t=>this.hanflerError(t)))}info(t,e){const o={headers:new i.c({"x-token":t})};return this.http.put(`${d.a}/grupos/info`,e,o).pipe(Object(l.a)(t=>this.hanflerError(t)))}integrantes(t,e){const o={headers:new i.c({"x-token":t})};return this.http.put(`${d.a}/grupos/integrantes`,e,o).pipe(Object(l.a)(t=>this.hanflerError(t)))}fotoPerfilUsuarioMoto(t,e,o,i){const s={fileKey:"archivo",httpMethod:"PUT",headers:{"x-token":t,"x-id":i},params:{tipo:o}},r=this.transfer.create();return Object(n.a)(r.upload(e,`${d.a}/upload/grupos`,s)).pipe(Object(h.a)(t=>{throw console.log("No se pudo subir la imagen "),new Error("No se pudo subir la imagen ")}))}subirweb(t,e,o){const s={headers:new i.c({"x-token":t,"x-id":o})};return this.http.put(`${d.a}/upload/grupos`,e,s).pipe(Object(l.a)(t=>this.hanflerError(t)))}leerProducto(t,e){const o={headers:new i.c({"x-token":t})};return this.http.put(`${d.a}/grupos/filtrar`,e,o).pipe(Object(l.a)(t=>this.hanflerError(t)))}chat(t,e){const o={headers:new i.c({"x-token":t})};return this.http.put(`${d.a}/grupos/chat`,e,o).pipe(Object(l.a)(t=>this.hanflerError(t)))}descarga(t,e){return this.http.get(`https://api.mapbox.com/directions/v5/mapbox/driving-traffic/${e.coordsIniciales.lng},${e.coordsIniciales.lat};${e.coordsFinales.lng},${e.coordsFinales.lat}?geometries=geojson&steps=true&language=es&access_token=${t}`).pipe(Object(l.a)(t=>this.hanflerError(t)))}dibujar(t,e){return this.http.get(`https://api.mapbox.com/directions/v5/mapbox/driving-traffic/${e.lng},${e.lat};${e.lngf},${e.latf}?geometries=geojson&steps=true&language=es&access_token=${t}`).pipe(Object(l.a)(t=>this.hanflerError(t)))}viaje(t,e){const o={headers:new i.c({"x-token":t})};return this.http.post(`${d.a}/grupos/viajes`,e,o).pipe(Object(l.a)(t=>this.hanflerError(t)))}irgrupo(t,e){const o={headers:new i.c({"x-token":t})};return this.http.put(`${d.a}/grupos/bu`,e,o).pipe(Object(l.a)(t=>this.hanflerError(t)))}podio(t,e){const o={headers:new i.c({"x-token":t})};return this.http.put(`${d.a}/grupos/podio`,e,o).pipe(Object(l.a)(t=>this.hanflerError(t)))}tabla(t,e){const o={headers:new i.c({"x-token":t})};return this.http.put(`${d.a}/grupos/tabla`,e,o).pipe(Object(l.a)(t=>this.hanflerError(t)))}viajechao(t,e){const o={headers:new i.c({"x-token":t})};return this.http.put(`${d.a}/grupos/viajes/eliminar`,e,o).pipe(Object(l.a)(t=>this.hanflerError(t)))}fotospodio(t,e){const o={headers:new i.c({"x-token":t})};return this.http.put(`${d.a}/grupos/podio/fotos`,e,o).pipe(Object(l.a)(t=>this.hanflerError(t)))}viajeBuscarUno(t,e){const o={headers:new i.c({"x-token":t})};return this.http.put(`${d.a}/grupos/buscar`,e,o).pipe(Object(l.a)(t=>this.hanflerError(t)))}viajeBuscar(t,e){const o={headers:new i.c({"x-token":t})};return this.http.put(`${d.a}/grupos/viajes/filtrar`,e,o).pipe(Object(l.a)(t=>this.hanflerError(t)))}fotoviaje(t,e,o){const i={fileKey:"archivo",httpMethod:"PUT",headers:{"x-token":e,"x-viaje":o}},s=this.transfer.create();return Object(n.a)(s.upload(t,`${d.a}/grupos/viaje/upload`,i)).pipe(Object(h.a)(t=>{throw new Error("No se pudo subir la imagen ")}))}subirweb2(t,e,o){const s={headers:new i.c({"x-token":t,"x-viaje":o})};return this.http.put(`${d.a}/grupos/viaje/upload`,e,s).pipe(Object(l.a)(t=>this.hanflerError(t)))}fotosviaje(t,e){const o={headers:new i.c({"x-token":t})};return this.http.put(`${d.a}/grupos/viaje/fotos`,e,o).pipe(Object(l.a)(t=>this.hanflerError(t)))}destino(t,e){const o={headers:new i.c({"x-token":t})};return this.http.put(`${d.a}/grupos/viaje/destino`,e,o).pipe(Object(l.a)(t=>this.hanflerError(t)))}eliminarviaje(t,e){const o={headers:new i.c({"x-token":t})};return this.http.put(`${d.a}/grupos/viaje/eliminar`,e,o).pipe(Object(l.a)(t=>this.hanflerError(t)))}eliminarFoto(t,e){const o={headers:new i.c({"x-token":t})};return this.http.put(`${d.a}/grupos/viaje/eliminarfoto`,e,o).pipe(Object(l.a)(t=>this.hanflerError(t)))}km(t,e){const o={headers:new i.c({"x-token":t})};return this.http.put(`${d.a}/grupos/km`,e,o).pipe(Object(l.a)(t=>this.hanflerError(t)))}}return t.\u0275fac=function(e){return new(e||t)(p.Sb(i.a),p.Sb(b.a),p.Sb(u.a),p.Sb(f.rb))},t.\u0275prov=p.Hb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})()}}]);