(window.webpackJsonp=window.webpackJsonp||[]).push([[47],{DvUB:function(t,e,r){"use strict";r.r(e),r.d(e,"BuscargruposPageModule",function(){return w});var o=r("ofXK"),s=r("3Pt+"),i=r("TEn/"),n=r("tyNb"),a=r("mrSG"),c=r("fXoL"),p=r("fsfq"),h=r("oQG1"),u=r("fmoy"),l=r("vLoH");const d=["inifinito"];function b(t,e){if(1&t){const t=c.Nb();c.Mb(0,"ion-searchbar",9),c.Ub("ionChange",function(e){return c.lc(t),c.Wb().buscar(e)}),c.Lb()}}function f(t,e){if(1&t&&(c.Mb(0,"ion-avatar",15),c.Kb(1,"img",16),c.Lb()),2&t){const t=c.Wb().$implicit;c.zb(1),c.fc("src","https://motocaliapp.com/",t.usuario.imagen[0].path,"",c.mc)}}function g(t,e){1&t&&(c.Mb(0,"ion-avatar",15),c.Kb(1,"img",17),c.Lb())}function m(t,e){if(1&t){const t=c.Nb();c.Mb(0,"ion-item",10),c.Ub("click",function(){c.lc(t);const r=e.$implicit;return c.Wb().interfaz(r._id)}),c.qc(1,f,2,1,"ion-avatar",11),c.qc(2,g,2,0,"ion-avatar",11),c.Mb(3,"ion-label",12),c.Mb(4,"div",13),c.rc(5),c.Lb(),c.Mb(6,"div",14),c.Mb(7,"strong"),c.rc(8),c.Lb(),c.Lb(),c.Mb(9,"div"),c.Mb(10,"strong"),c.rc(11),c.Lb(),c.Lb(),c.Lb(),c.Lb()}if(2&t){const t=e.$implicit;c.zb(1),c.dc("ngIf",t.usuario.imagen.length>0&&"notfound.png"!==t.usuario.imagen[0].path),c.zb(1),c.dc("ngIf","notfound.png"===t.usuario.imagen[0].path),c.zb(3),c.sc(t.nombre),c.zb(3),c.tc("",t.kilometros," Km"),c.zb(3),c.uc("",t.ciudad,", ",t.pais,"")}}function v(t,e){if(1&t){const t=c.Nb();c.Mb(0,"ion-infinite-scroll",18,19),c.Ub("ionInfinite",function(e){return c.lc(t),c.Wb().loadData(e)}),c.Kb(2,"ion-infinite-scroll-content",20),c.Lb()}}const j=[{path:"",component:(()=>{class t{constructor(t,e,r,o,s){this.almacenamiento=t,this.apiUsuario=e,this.toast=r,this.apiGrupos=o,this.router=s,this.grupos=[],this.cargado=!1,this.patron="",this.desde=0,this.prod=!0,this.load=!1}ngOnInit(){}ionViewWillEnter(){this.listar()}refrescando(t){this.cargado=!1,this.listar().then(()=>{t.target.complete()}).catch(()=>{t.target.complete()})}interfaz(t){this.router.navigate(["/interfaz-grupo",t,"inicio",t])}listar(){return Object(a.a)(this,void 0,void 0,function*(){const t=yield this.almacenamiento.obtenerToken();t&&(this.load=!0,this.apiGrupos.leerProducto(t.token,{desde:this.desde}).subscribe(t=>{console.log(t),t.exe?this.grupos=t.response:this.toast.toastError("No se pudo consultar los grupos, int\xe9ntelo m\xe1s tarde"),this.cargado=!0},t=>{this.toast.toastError("No se pudo consultar los grupos, int\xe9ntelo m\xe1s tarde"),this.cargado=!0}))})}buscar(t){return Object(a.a)(this,void 0,void 0,function*(){if(""!==t.detail.value){this.desde=0,this.infinite.disabled=!1,this.patron=t.detail.value;const e=yield this.almacenamiento.obtenerToken();e&&this.apiGrupos.leerProducto(e.token,{desde:this.desde,patron:this.patron}).subscribe(t=>{t.exe?(this.grupos=t.response,0===t.response.length&&(this.desde=0)):this.toast.toastError("No se pudo realizar la b\xfasqueda, intentelo m\xe1s tarde")},t=>{this.toast.toastError("No se pudo realizar la b\xfasqueda, intentelo m\xe1s tarde")})}else this.desde=0,this.listar()})}loadData(t){return Object(a.a)(this,void 0,void 0,function*(){this.desde=this.desde+5;const e=yield this.almacenamiento.obtenerToken();e&&(""===this.patron?this.apiGrupos.leerProducto(e.token,{desde:this.desde}).subscribe(e=>{e.exe?e.response.length>0?(e.response.forEach(t=>{this.grupos.push(t)}),t.target.complete()):(t.target.disabled=!0,this.desde=0):this.toast.toastError("No se pudo traer los grupos, int\xe9ntelo m\xe1s tarde.")},t=>{this.toast.toastError("No se pudo traer los grupos, int\xe9ntelo m\xe1s tarde.")}):this.apiGrupos.leerProducto(e.token,{desde:this.desde}).subscribe(e=>{e.exe?e.response.length>0?(e.response.forEach(t=>{this.grupos.push(t)}),t.target.complete()):(t.target.disabled=!0,this.desde=0):this.toast.toastError("No se pudo realizar la b\xfasqueda, intentelo m\xe1s tarde")},t=>{this.toast.toastError("No se pudo realizar la b\xfasqueda, intentelo m\xe1s tarde")}))})}}return t.\u0275fac=function(e){return new(e||t)(c.Jb(p.a),c.Jb(h.a),c.Jb(u.a),c.Jb(l.a),c.Jb(n.g))},t.\u0275cmp=c.Db({type:t,selectors:[["app-buscargrupos"]],viewQuery:function(t,e){if(1&t&&c.vc(d,1),2&t){let t;c.kc(t=c.Vb())&&(e.infinite=t.first)}},decls:12,vars:3,consts:[[1,""],["color","oscuro"],["slot","fixed","pullFactor","0.5","pullMin","50","pullMax","150",3,"ionRefresh"],["pullingIcon","arrow-dropdown","refreshingSpinner","circles"],["debounce","300","mode","ios","placeholder","Buscar Grupos",3,"ionChange",4,"ngIf"],[1,"divider","light"],[1,"divider"],[3,"click",4,"ngFor","ngForOf"],["threshold","100px",3,"ionInfinite",4,"ngIf"],["debounce","300","mode","ios","placeholder","Buscar Grupos",3,"ionChange"],[3,"click"],["slot","start",4,"ngIf"],[1,"ion-text-wrap"],[1,"nombre"],[1,"az"],["slot","start"],[3,"src"],["src","/assets/Grupos.png"],["threshold","100px",3,"ionInfinite"],["inifinito",""],["loadingSpinner","bubbles","loadingText","Cargando Hojas de Vida..."]],template:function(t,e){1&t&&(c.Mb(0,"ion-header",0),c.Mb(1,"ion-toolbar",1),c.Mb(2,"ion-title"),c.rc(3,"Mis Grupos"),c.Lb(),c.Lb(),c.Lb(),c.Mb(4,"ion-content"),c.Mb(5,"ion-refresher",2),c.Ub("ionRefresh",function(t){return e.refrescando(t)}),c.Kb(6,"ion-refresher-content",3),c.Lb(),c.qc(7,b,1,0,"ion-searchbar",4),c.Kb(8,"div",5),c.Kb(9,"div",6),c.qc(10,m,12,6,"ion-item",7),c.qc(11,v,3,0,"ion-infinite-scroll",8),c.Lb()),2&t&&(c.zb(7),c.dc("ngIf",e.prod),c.zb(3),c.dc("ngForOf",e.grupos),c.zb(1),c.dc("ngIf",e.load))},directives:[i.z,i.kb,i.ib,i.t,i.Q,i.R,o.j,o.i,i.U,i.xb,i.F,i.K,i.f,i.C,i.D],styles:[".az[_ngcontent-%COMP%]{color:var(--ion-color-verde)}"]}),t})()}];let E=(()=>{class t{}return t.\u0275mod=c.Hb({type:t}),t.\u0275inj=c.Gb({factory:function(e){return new(e||t)},imports:[[n.i.forChild(j)],n.i]}),t})(),w=(()=>{class t{}return t.\u0275mod=c.Hb({type:t}),t.\u0275inj=c.Gb({factory:function(e){return new(e||t)},imports:[[o.b,s.e,i.lb,E]]}),t})()},vLoH:function(t,e,r){"use strict";r.d(e,"a",function(){return g});var o=r("tk/3"),s=r("PqYM"),i=r("Cfvw"),n=r("coGc"),a=r("lJxs"),c=r("IzEk"),p=r("MtjB"),h=r("JIr8"),u=r("AytR"),l=r("fXoL"),d=r("B7Rs"),b=r("fsfq"),f=r("TEn/");let g=(()=>{class t{constructor(t,e,r,o){this.http=t,this.transfer=e,this.almacenamiento=r,this.navCtrl=o}hanflerError(t){let e=0;return t.pipe(Object(n.a)(()=>Object(s.a)(5e3)),Object(a.a)(t=>{if(e++,console.log("Entramos a intentos"),t instanceof ErrorEvent){if(3===e)throw new Error("Error de Red")}else{if(!(t instanceof ProgressEvent))throw 404===t.status?new Error(" al realizar la solicictud "):401===t.status?(this.almacenamiento.terminarPartida().then(()=>{this.navCtrl.navigateRoot("/home")}),new Error("No tiene permisos para realizar la petici\xf3n ")):(console.log(t,"Error de servidor"),new Error(" No se pudo realizar la petici\xf3n, intentalo m\xe1s tarde "));if(3===e)throw new Error("Error de Red")}}),Object(c.a)(3))}crearGrupo(t,e){const r={headers:new o.c({"x-token":t})};return this.http.post(`${u.a}/grupos/crear`,e,r).pipe(Object(p.a)(t=>this.hanflerError(t)))}listarGrupos(t,e){const r={headers:new o.c({"x-token":t})};return this.http.put(`${u.a}/grupos/lista`,e,r).pipe(Object(p.a)(t=>this.hanflerError(t)))}info(t,e){const r={headers:new o.c({"x-token":t})};return this.http.put(`${u.a}/grupos/info`,e,r).pipe(Object(p.a)(t=>this.hanflerError(t)))}integrantes(t,e){const r={headers:new o.c({"x-token":t})};return this.http.put(`${u.a}/grupos/integrantes`,e,r).pipe(Object(p.a)(t=>this.hanflerError(t)))}fotoPerfilUsuarioMoto(t,e,r,o){const s={fileKey:"archivo",httpMethod:"PUT",headers:{"x-token":t,"x-id":o},params:{tipo:r}},n=this.transfer.create();return Object(i.a)(n.upload(e,`${u.a}/upload/grupos`,s)).pipe(Object(h.a)(t=>{throw console.log("No se pudo subir la imagen "),new Error("No se pudo subir la imagen ")}))}subirweb(t,e,r){const s={headers:new o.c({"x-token":t,"x-id":r})};return this.http.put(`${u.a}/upload/grupos`,e,s).pipe(Object(p.a)(t=>this.hanflerError(t)))}leerProducto(t,e){const r={headers:new o.c({"x-token":t})};return this.http.put(`${u.a}/grupos/filtrar`,e,r).pipe(Object(p.a)(t=>this.hanflerError(t)))}chat(t,e){const r={headers:new o.c({"x-token":t})};return this.http.put(`${u.a}/grupos/chat`,e,r).pipe(Object(p.a)(t=>this.hanflerError(t)))}descarga(t,e){return this.http.get(`https://api.mapbox.com/directions/v5/mapbox/driving-traffic/${e.coordsIniciales.lng},${e.coordsIniciales.lat};${e.coordsFinales.lng},${e.coordsFinales.lat}?geometries=geojson&steps=true&language=es&access_token=${t}`).pipe(Object(p.a)(t=>this.hanflerError(t)))}dibujar(t,e){return this.http.get(`https://api.mapbox.com/directions/v5/mapbox/driving-traffic/${e.lng},${e.lat};${e.lngf},${e.latf}?geometries=geojson&steps=true&language=es&access_token=${t}`).pipe(Object(p.a)(t=>this.hanflerError(t)))}viaje(t,e){const r={headers:new o.c({"x-token":t})};return this.http.post(`${u.a}/grupos/viajes`,e,r).pipe(Object(p.a)(t=>this.hanflerError(t)))}irgrupo(t,e){const r={headers:new o.c({"x-token":t})};return this.http.put(`${u.a}/grupos/bu`,e,r).pipe(Object(p.a)(t=>this.hanflerError(t)))}podio(t,e){const r={headers:new o.c({"x-token":t})};return this.http.put(`${u.a}/grupos/podio`,e,r).pipe(Object(p.a)(t=>this.hanflerError(t)))}tabla(t,e){const r={headers:new o.c({"x-token":t})};return this.http.put(`${u.a}/grupos/tabla`,e,r).pipe(Object(p.a)(t=>this.hanflerError(t)))}viajechao(t,e){const r={headers:new o.c({"x-token":t})};return this.http.put(`${u.a}/grupos/viajes/eliminar`,e,r).pipe(Object(p.a)(t=>this.hanflerError(t)))}fotospodio(t,e){const r={headers:new o.c({"x-token":t})};return this.http.put(`${u.a}/grupos/podio/fotos`,e,r).pipe(Object(p.a)(t=>this.hanflerError(t)))}viajeBuscarUno(t,e){const r={headers:new o.c({"x-token":t})};return this.http.put(`${u.a}/grupos/buscar`,e,r).pipe(Object(p.a)(t=>this.hanflerError(t)))}viajeBuscar(t,e){const r={headers:new o.c({"x-token":t})};return this.http.put(`${u.a}/grupos/viajes/filtrar`,e,r).pipe(Object(p.a)(t=>this.hanflerError(t)))}fotoviaje(t,e,r){const o={fileKey:"archivo",httpMethod:"PUT",headers:{"x-token":e,"x-viaje":r}},s=this.transfer.create();return Object(i.a)(s.upload(t,`${u.a}/grupos/viaje/upload`,o)).pipe(Object(h.a)(t=>{throw new Error("No se pudo subir la imagen ")}))}subirweb2(t,e,r){const s={headers:new o.c({"x-token":t,"x-viaje":r})};return this.http.put(`${u.a}/grupos/viaje/upload`,e,s).pipe(Object(p.a)(t=>this.hanflerError(t)))}fotosviaje(t,e){const r={headers:new o.c({"x-token":t})};return this.http.put(`${u.a}/grupos/viaje/fotos`,e,r).pipe(Object(p.a)(t=>this.hanflerError(t)))}destino(t,e){const r={headers:new o.c({"x-token":t})};return this.http.put(`${u.a}/grupos/viaje/destino`,e,r).pipe(Object(p.a)(t=>this.hanflerError(t)))}eliminarviaje(t,e){const r={headers:new o.c({"x-token":t})};return this.http.put(`${u.a}/grupos/viaje/eliminar`,e,r).pipe(Object(p.a)(t=>this.hanflerError(t)))}eliminarFoto(t,e){const r={headers:new o.c({"x-token":t})};return this.http.put(`${u.a}/grupos/viaje/eliminarfoto`,e,r).pipe(Object(p.a)(t=>this.hanflerError(t)))}km(t,e){const r={headers:new o.c({"x-token":t})};return this.http.put(`${u.a}/grupos/km`,e,r).pipe(Object(p.a)(t=>this.hanflerError(t)))}}return t.\u0275fac=function(e){return new(e||t)(l.Qb(o.a),l.Qb(d.a),l.Qb(b.a),l.Qb(f.qb))},t.\u0275prov=l.Fb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})()}}]);