(window.webpackJsonp=window.webpackJsonp||[]).push([[64],{SpuA:function(t,o,n){"use strict";n.d(o,"a",function(){return r});var e=n("wd/R"),i=n("fXoL");let r=(()=>{class t{transform(t){console.log(t,"fechin");let o=e.utc(t).toDate();return e(o).format("dddd, DD MMMM YYYY h:mm:a")}}return t.\u0275fac=function(o){return new(o||t)},t.\u0275pipe=i.Kb({name:"cambioUTC",type:t,pure:!0}),t})()},xVeN:function(t,o,n){"use strict";n.r(o),n.d(o,"ListaGruaPageModule",function(){return M});var e=n("ofXK"),i=n("3Pt+"),r=n("TEn/"),a=n("tyNb"),c=n("mrSG"),s=n("HDdC"),b=n("fXoL"),l=n("fsfq"),d=n("0xwK"),u=n("fmoy"),p=n("7JkF"),m=n("F6wp"),f=n("SpuA");function g(t,o){1&t&&(b.Ob(0,"div",8),b.Ob(1,"h3",9),b.wc(2,"No tienes ninguna solicitud activa en este momento"),b.Nb(),b.Nb())}function h(t,o){if(1&t){const t=b.Pb();b.Ob(0,"ion-card",12),b.Ob(1,"ion-card-header"),b.Mb(2,"app-mapas",13),b.Nb(),b.Ob(3,"strong",14),b.wc(4),b.Zb(5,"cambioUTC"),b.Nb(),b.Ob(6,"ion-card-title",15),b.wc(7),b.Nb(),b.Ob(8,"div",16),b.Ob(9,"p"),b.wc(10),b.Nb(),b.Mb(11,"div",17),b.Ob(12,"div"),b.Ob(13,"strong"),b.wc(14),b.Nb(),b.Nb(),b.Ob(15,"div"),b.Ob(16,"strong"),b.wc(17,"Tel\xe9fono: "),b.Nb(),b.wc(18),b.Nb(),b.Ob(19,"div"),b.Ob(20,"strong"),b.wc(21,"Correo: "),b.Nb(),b.wc(22),b.Nb(),b.Mb(23,"br"),b.Nb(),b.Ob(24,"ion-button",18),b.Wb("click",function(){b.pc(t);const n=o.$implicit;return b.Yb(2).tomar(n)}),b.wc(25,"TOMAR SOLICITUD"),b.Nb(),b.Nb()}if(2&t){const t=o.$implicit;b.Ab(2),b.fc("lng",t.ubicacion.lng)("lat",t.ubicacion.lat),b.Ab(2),b.xc(b.ac(5,9,t.fecha)),b.Ab(3),b.yc("",t.creador.nombrecompleto," "),b.Ab(3),b.xc(t.descripcion),b.Ab(4),b.zc("Ubicado en ",t.creador.ciudad,", ",t.creador.pais,""),b.Ab(4),b.yc(" ",t.creador.tel,""),b.Ab(4),b.yc(" ",t.creador.correo,"")}}function O(t,o){if(1&t&&(b.Ob(0,"div",10),b.vc(1,h,26,11,"ion-card",11),b.Nb()),2&t){const t=b.Yb();b.Ab(1),b.fc("ngForOf",t.gruas)}}const N=[{path:"",component:(()=>{class t{constructor(t,o,n,e,i,r){this.router=t,this.almacenamiento=o,this.apiMonitoreo=n,this.toast=e,this.socket=i,this.alert=r,this.cargado=!1,this.gruas=[],this.escuchareliminados().subscribe(t=>{this.gruas=this.gruas.filter(o=>o._id!==t.id)})}ngOnInit(){}ionViewWillEnter(){this.comprobar()}refrescando(){this.comprobar()}crear(){this.router.navigate(["/central/menu/monitoreo/grua/crear/"])}escuchareliminados(){return new s.a(t=>{this.socket.on("gruachao",o=>{t.next(o)})})}comprobar(){return Object(c.a)(this,void 0,void 0,function*(){const t=yield this.almacenamiento.obtenerToken();t&&this.apiMonitoreo.consultarGrua(t.token).subscribe(t=>{console.log(t,"DATON"),this.cargado=!0,t.exe?this.gruas=t.response:this.toast.toastError("No se pudo completar la petici\xf3n, int\xe9ntelo m\xe1s tarde")},t=>{this.toast.toastError("No se pudo completar la petici\xf3n, int\xe9ntelo m\xe1s tarde")})})}tomar(t){return Object(c.a)(this,void 0,void 0,function*(){const o=yield this.alert.create({header:"Atenci\xf3n!",message:"\xbfQuieres ayudar al usuario con su solicitud.",buttons:[{text:"Cancelar",cssClass:"cancelarAlerta",role:"cancel",handler:()=>{}},{text:"Acepto",cssClass:"botonalerta",handler:()=>Object(c.a)(this,void 0,void 0,function*(){const o=yield this.almacenamiento.obtenerToken();o&&this.apiMonitoreo.GruaEditar(o.token,{id:t._id}).subscribe(n=>{console.log(n,"DATON",t,o.nombre),this.cargado=!0,n.exe?(this.socket.emit("gruatomar",{info:{chat:n.chat,personas:n.response},usuario:t.creador._id,nombre:o.nombre}),this.router.navigate(["/central/menu/monitoreo/listado-agregados"])):this.toast.toastError("No se pudo completar la petici\xf3n, int\xe9ntelo m\xe1s tarde")},t=>{this.toast.toastError("No se pudo completar la petici\xf3n, int\xe9ntelo m\xe1s tarde")})})}]});yield o.present()})}}return t.\u0275fac=function(o){return new(o||t)(b.Lb(a.g),b.Lb(l.a),b.Lb(d.a),b.Lb(u.a),b.Lb(p.a),b.Lb(r.b))},t.\u0275cmp=b.Fb({type:t,selectors:[["app-lista-grua"]],decls:11,vars:2,consts:[[1,"ion-no-border"],["color","oscuro"],["slot","start","icon","chevron-back-outline","defaultHref","/central/menu/monitoreo"],["slot","end"],[3,"click"],["name","reload-outline","slot","icon-only"],["class","flex",4,"ngIf"],["class","opts",4,"ngIf"],[1,"flex"],[1,"titulo"],[1,"opts"],["color","light","mode","ios",4,"ngFor","ngForOf"],["color","light","mode","ios"],[3,"lng","lat"],[1,"gris"],[1,"tit"],[1,"info"],[1,"separador"],["color","barra","mode","ios","expand","block",3,"click"]],template:function(t,o){1&t&&(b.Ob(0,"ion-header",0),b.Ob(1,"ion-toolbar",1),b.Mb(2,"ion-back-button",2),b.Ob(3,"ion-title"),b.wc(4,"Listado de solicitudes"),b.Nb(),b.Ob(5,"ion-buttons",3),b.Ob(6,"ion-button",4),b.Wb("click",function(){return o.refrescando()}),b.Mb(7,"ion-icon",5),b.Nb(),b.Nb(),b.Nb(),b.Nb(),b.Ob(8,"ion-content"),b.vc(9,g,3,0,"div",6),b.vc(10,O,2,1,"div",7),b.Nb()),2&t&&(b.Ab(9),b.fc("ngIf",o.cargado&&0===o.gruas.length),b.Ab(1),b.fc("ngIf",o.cargado))},directives:[r.z,r.lb,r.g,r.h,r.jb,r.k,r.j,r.A,r.t,e.j,e.i,r.l,r.n,m.a,r.p],pipes:[f.a],styles:[".flex[_ngcontent-%COMP%]{display:flex;justify-content:center;flex-direction:column;align-items:center;margin:100px 0}.titulo[_ngcontent-%COMP%]{text-align:center;max-width:300px;font-size:18px;font-weight:300}.mapa[_ngcontent-%COMP%]{width:100%;height:300px}.tit[_ngcontent-%COMP%]{font-size:18px}.gris[_ngcontent-%COMP%], .tit[_ngcontent-%COMP%]{padding:10px}.gris[_ngcontent-%COMP%]{color:var(--ion-color-medium)}.info[_ngcontent-%COMP%]{padding:10px}"]}),t})()}];let w=(()=>{class t{}return t.\u0275fac=function(o){return new(o||t)},t.\u0275mod=b.Jb({type:t}),t.\u0275inj=b.Ib({imports:[[a.j.forChild(N)],a.j]}),t})();var v=n("iTUp"),x=n("zon2");let M=(()=>{class t{}return t.\u0275fac=function(o){return new(o||t)},t.\u0275mod=b.Jb({type:t}),t.\u0275inj=b.Ib({imports:[[e.b,i.e,r.mb,w,v.a,x.a]]}),t})()}}]);