(window.webpackJsonp=window.webpackJsonp||[]).push([[35],{"Qv/D":function(t,e,i){"use strict";i.r(e),i.d(e,"HistoriasModalPageModule",function(){return k});var n=i("ofXK"),o=i("3Pt+"),s=i("TEn/"),r=i("tyNb"),a=i("mrSG"),c=i("fXoL"),d=i("VYYF"),h=i("fsfq"),l=i("WGaO"),p=i("fmoy"),b=i("EvSv");const f=["slide"],g=["miSlide"];function u(t,e){if(1&t&&(c.Mb(0,"div",19),c.Mb(1,"h3"),c.rc(2),c.Lb(),c.Lb()),2&t){const t=c.Wb().$implicit;c.zb(2),c.sc(t.dibujo.texto)}}function m(t,e){if(1&t&&c.Kb(0,"img",12),2&t){const t=c.Wb().$implicit;c.fc("src","https://www.motocaliapp.com/11927613401/",t.archivos[0].ruta,"",c.mc)}}function w(t,e){if(1&t){const t=c.Nb();c.Mb(0,"div",20),c.Mb(1,"div",21),c.Ub("click",function(){c.lc(t);const e=c.Wb().index,i=c.Wb().index;return c.Wb(2).abrir(i,e)}),c.rc(2," Ver m\xe1s... "),c.Lb(),c.Lb()}}function M(t,e){if(1&t){const t=c.Nb();c.Mb(0,"ion-item",29),c.Ub("click",function(){c.lc(t);const i=e.$implicit;return c.Wb(6).perfilNavegar(i.nombreusuario)}),c.Mb(1,"ion-avatar",30),c.Kb(2,"img",31),c.Lb(),c.Mb(3,"ion-label"),c.Mb(4,"div"),c.rc(5),c.Lb(),c.Mb(6,"strong"),c.rc(7),c.Lb(),c.Lb(),c.Lb()}if(2&t){const t=e.$implicit;c.zb(2),c.fc("src","https://www.motocaliapp.com/",t.imagen[0].path,"",c.mc),c.zb(3),c.sc(t.nombrecompleto),c.zb(2),c.tc("@",t.nombreusuario,"")}}function x(t,e){if(1&t&&(c.Mb(0,"ion-list"),c.Mb(1,"ion-item-divider",27),c.rc(2,"Usuarios etiquetados"),c.Lb(),c.qc(3,M,8,3,"ion-item",28),c.Lb()),2&t){const t=c.Wb(2).$implicit;c.zb(3),c.dc("ngForOf",t.etiquetas)}}function O(t,e){if(1&t){const t=c.Nb();c.Mb(0,"div",22),c.Mb(1,"div",23),c.Mb(2,"div",24),c.Ub("click",function(){c.lc(t);const e=c.Wb().index,i=c.Wb().index;return c.Wb(2).cerrar2(i,e)}),c.rc(3,"x"),c.Lb(),c.Mb(4,"div",25),c.rc(5),c.Lb(),c.qc(6,x,4,1,"ion-list",26),c.Lb(),c.Lb()}if(2&t){const t=c.Wb().$implicit;c.zb(5),c.sc(t.comentario),c.zb(1),c.dc("ngIf",t.etiquetas.length>0)}}function v(t,e){if(1&t){const t=c.Nb();c.Mb(0,"ion-slide",9),c.Ub("swipe",function(){c.lc(t);const i=e.index,n=c.Wb().index;return c.Wb(2).saludar(n,i)}),c.Xb(1,"colores"),c.Mb(2,"div",10),c.Mb(3,"div",11),c.Mb(4,"ion-avatar"),c.Kb(5,"img",12),c.Lb(),c.Mb(6,"div",13),c.Mb(7,"span"),c.rc(8),c.Lb(),c.Kb(9,"br"),c.Mb(10,"strong"),c.rc(11),c.Lb(),c.Lb(),c.Lb(),c.Mb(12,"h1",14),c.Ub("click",function(){c.lc(t);const i=e.index,n=c.Wb().index;return c.Wb(2).cerrar(n,i)}),c.rc(13,"x"),c.Lb(),c.Lb(),c.qc(14,u,3,1,"div",15),c.qc(15,m,1,1,"img",16),c.qc(16,w,3,0,"div",17),c.qc(17,O,7,2,"div",18),c.Lb()}if(2&t){const t=e.$implicit,i=c.Wb().$implicit,n=c.Wb(2);c.oc(c.Yb(1,12,t)),c.Bb("one",1===i.length),c.zb(5),c.ec("src",i[0].image,c.mc),c.zb(3),c.sc(n.info.nombre),c.zb(3),c.tc("@",n.info.usuario,""),c.zb(3),c.dc("ngIf","dibujar"===t.tipo),c.zb(1),c.dc("ngIf","multimedia"===t.tipo),c.zb(1),c.dc("ngIf",""!==t.comentario||t.etiquetas.length>0),c.zb(1),c.dc("ngIf",t.etiqueta)}}function P(t,e){if(1&t&&(c.Mb(0,"ion-slide",5),c.Mb(1,"ion-slides",6,7),c.qc(3,v,18,14,"ion-slide",8),c.Lb(),c.Lb()),2&t){const t=e.$implicit,i=c.Wb(2);c.zb(1),c.dc("options",i.opt),c.zb(2),c.dc("ngForOf",t)}}function C(t,e){if(1&t&&(c.Mb(0,"ion-slides",2,3),c.qc(2,P,4,2,"ion-slide",4),c.Lb()),2&t){const t=c.Wb();c.dc("options",t.slideopts),c.zb(2),c.dc("ngForOf",t.historiasbase)}}const $=[{path:"",component:(()=>{class t{constructor(t,e,i,n,o,s){this.modalCtrl=t,this.statusbar=e,this.router=i,this.almacenamiento=n,this.IGTMApi=o,this.toast=s,this.ht=["fsdf","asdfasf","asfas"],this.slideopts={grabCursor:!0,cubeEffect:{shadow:!0,slideShadows:!0,shadowOffset:20,shadowScale:.94},on:{beforeInit:function(){const t=this;t.classNames.push(`${t.params.containerModifierClass}cube`),t.classNames.push(`${t.params.containerModifierClass}3d`);const e={slidesPerView:1,slidesPerColumn:1,slidesPerGroup:1,watchSlidesProgress:!0,resistanceRatio:0,spaceBetween:0,centeredSlides:!1,virtualTranslate:!0};this.params=Object.assign(this.params,e),this.originalParams=Object.assign(this.originalParams,e)},setTranslate:function(){const t=this,{$el:e,$wrapperEl:i,slides:n,width:o,height:s,rtlTranslate:r,size:a}=t,c=t.params.cubeEffect,d=t.isHorizontal(),h=t.virtual&&t.params.virtual.enabled;let l,p=0;c.shadow&&(d?(l=i.find(".swiper-cube-shadow"),0===l.length&&(l=t.$('<div class="swiper-cube-shadow"></div>'),i.append(l)),l.css({height:`${o}px`})):(l=e.find(".swiper-cube-shadow"),0===l.length&&(l=t.$('<div class="swiper-cube-shadow"></div>'),e.append(l))));for(let b=0;b<n.length;b+=1){const e=n.eq(b);let i=b;h&&(i=parseInt(e.attr("data-swiper-slide-index"),10));let o=90*i,s=Math.floor(o/360);r&&(o=-o,s=Math.floor(-o/360));const l=Math.max(Math.min(e[0].progress,1),-1);let f=0,g=0,u=0;i%4==0?(f=4*-s*a,u=0):(i-1)%4==0?(f=0,u=4*-s*a):(i-2)%4==0?(f=a+4*s*a,u=a):(i-3)%4==0&&(f=-a,u=3*a+4*a*s),r&&(f=-f),d||(g=f,f=0);const m=`rotateX(${d?0:-o}deg) rotateY(${d?o:0}deg) translate3d(${f}px, ${g}px, ${u}px)`;if(l<=1&&l>-1&&(p=90*i+90*l,r&&(p=90*-i-90*l)),e.transform(m),c.slideShadows){let i=e.find(d?".swiper-slide-shadow-left":".swiper-slide-shadow-top"),n=e.find(d?".swiper-slide-shadow-right":".swiper-slide-shadow-bottom");0===i.length&&(i=t.$(`<div class="swiper-slide-shadow-${d?"left":"top"}"></div>`),e.append(i)),0===n.length&&(n=t.$(`<div class="swiper-slide-shadow-${d?"right":"bottom"}"></div>`),e.append(n)),i.length&&(i[0].style.opacity=Math.max(-l,0)),n.length&&(n[0].style.opacity=Math.max(l,0))}}if(i.css({"-webkit-transform-origin":`50% 50% -${a/2}px`,"-moz-transform-origin":`50% 50% -${a/2}px`,"-ms-transform-origin":`50% 50% -${a/2}px`,"transform-origin":`50% 50% -${a/2}px`}),c.shadow)if(d)l.transform(`translate3d(0px, ${o/2+c.shadowOffset}px, ${-o/2}px) rotateX(90deg) rotateZ(0deg) scale(${c.shadowScale})`);else{const t=Math.abs(p)-90*Math.floor(Math.abs(p)/90),e=1.5-(Math.sin(2*t*Math.PI/360)/2+Math.cos(2*t*Math.PI/360)/2),i=c.shadowScale/e;l.transform(`scale3d(${c.shadowScale}, 1, ${i}) translate3d(0px, ${s/2+c.shadowOffset}px, ${-s/2/i}px) rotateX(-90deg)`)}i.transform(`translate3d(0px,0,${t.browser.isSafari||t.browser.isUiWebView?-a/2:0}px) rotateX(${t.isHorizontal()?0:p}deg) rotateY(${t.isHorizontal()?-p:0}deg)`)},setTransition:function(t){const e=this,{$el:i,slides:n}=e;n.transition(t).find(".swiper-slide-shadow-top, .swiper-slide-shadow-right, .swiper-slide-shadow-bottom, .swiper-slide-shadow-left").transition(t),e.params.cubeEffect.shadow&&!e.isHorizontal()&&i.find(".swiper-cube-shadow").transition(t)}}},this.opt={direction:"vertical"},this.historiasbase=[],this.estilos="",this.cargo=!0}ngOnInit(){}ionViewWillEnter(){this.historiasbase=this.historias,this.miSlide.slideTo(this.info.idx,0).then(()=>{})}saludar(t,e){this.vistos(this.historiasbase[t][e]._id)}rotar(){this.miSlide.getActiveIndex().then(t=>{this.slide.getActiveIndex().then(e=>{this.vistos(this.historiasbase[t][e]._id)})})}vistos(t){return Object(a.a)(this,void 0,void 0,function*(){const e=yield this.almacenamiento.obtenerToken();e&&this.IGTMApi.vistos(e.token,{id:t}).subscribe(t=>{},t=>{})})}cerrar(t,e){this.vistos(this.historiasbase[t][e]._id),this.modalCtrl.dismiss(),this.historias=[],this.info={}}cambio(t,e){this.slide.getActiveIndex().then(t=>{})}ver(t){}abrir(t,e){this.historias[t][e].etiqueta=!0}cerrar2(t,e){this.historias[t][e].etiqueta=!1}perfilNavegar(t){this.modalCtrl.dismiss(),this.router.navigate(["/visita/",t,"s"])}ionViewWillLeave(){}}return t.\u0275fac=function(e){return new(e||t)(c.Jb(s.ob),c.Jb(d.a),c.Jb(r.g),c.Jb(h.a),c.Jb(l.a),c.Jb(p.a))},t.\u0275cmp=c.Db({type:t,selectors:[["app-historias-modal"]],viewQuery:function(t,e){if(1&t&&(c.vc(f,1),c.vc(g,1)),2&t){let t;c.kc(t=c.Vb())&&(e.slide=t.first),c.kc(t=c.Vb())&&(e.miSlide=t.first)}},inputs:{info:"info",historias:"historias"},decls:2,vars:1,consts:[["color","darkgold"],[3,"options",4,"ngIf"],[3,"options"],["miSlide",""],["class","red",4,"ngFor","ngForOf"],[1,"red"],[1,"sl",3,"options"],["slide",""],[3,"one","style","swipe",4,"ngFor","ngForOf"],[3,"swipe"],[1,"encabezado"],[1,"data"],["alt","",3,"src"],[1,"titulo"],[3,"click"],["class","texto",4,"ngIf"],["alt","",3,"src",4,"ngIf"],["class","pie",4,"ngIf"],["class","etiquetados",4,"ngIf"],[1,"texto"],[1,"pie"],[1,"data",3,"click"],[1,"etiquetados"],[1,"dataa"],[1,"cerrarr",3,"click"],[1,"com"],[4,"ngIf"],[1,"cc"],["color","oscuro",3,"click",4,"ngFor","ngForOf"],["color","oscuro",3,"click"],["slot","start"],[3,"src"]],template:function(t,e){1&t&&(c.Mb(0,"ion-content",0),c.qc(1,C,3,2,"ion-slides",1),c.Lb()),2&t&&(c.zb(1),c.dc("ngIf",e.cargo))},directives:[s.t,n.j,s.ab,n.i,s.Z,s.f,s.L,s.G,s.F,s.K],pipes:[b.a],styles:[".contenedor[_ngcontent-%COMP%]{width:100%;min-height:100vh;height:auto}.encabezado[_ngcontent-%COMP%]{padding:5px 10px;top:0;touch-action:auto!important}.encabezado[_ngcontent-%COMP%], .pie[_ngcontent-%COMP%]{width:100%;position:absolute;left:0;font-size:20px;display:flex;justify-content:space-between;align-items:center;z-index:10}.pie[_ngcontent-%COMP%]{bottom:0}.pie[_ngcontent-%COMP%]   .data[_ngcontent-%COMP%]{width:150px;background:#333;color:#fff!important;text-align:center;padding:5px 10px;font-size:14px}.encabezado[_ngcontent-%COMP%]   .data[_ngcontent-%COMP%]{width:80%;display:flex;align-items:center;color:#fff}.encabezado[_ngcontent-%COMP%]   .data[_ngcontent-%COMP%]   .titulo[_ngcontent-%COMP%]{padding-left:10px;text-align:left}.encabezado[_ngcontent-%COMP%]   .data[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:14px;font-weight:400}.encabezado[_ngcontent-%COMP%]   .data[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{font-size:12px}ion-slides[_ngcontent-%COMP%]{width:100%;min-height:100vh;height:auto}ion-slide[_ngcontent-%COMP%]{width:100%;height:100%}ion-slide[_ngcontent-%COMP%]   ion-slides[_ngcontent-%COMP%]{width:100%;height:100vh}.one[_ngcontent-%COMP%]{height:100vh!important}.sl[_ngcontent-%COMP%]{width:100%;min-height:100%;height:auto}.sl[_ngcontent-%COMP%]   ion-slide[_ngcontent-%COMP%]{width:100%;max-width:600px;margin:auto;height:100%;position:relative}.sl[_ngcontent-%COMP%]   ion-slide[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%}.texto[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:22px;word-wrap:break-word;white-space:pre-wrap;font-weight:700}.etiquetados[_ngcontent-%COMP%]{width:100%;height:100%;padding:5px 10px;position:absolute;top:0;left:0;font-size:20px;z-index:20}.etiquetados[_ngcontent-%COMP%], .etiquetados[_ngcontent-%COMP%]   ion-list[_ngcontent-%COMP%]{background:#3b4b54}.etiquetados[_ngcontent-%COMP%]   .dataa[_ngcontent-%COMP%]{position:relative;width:100%;height:100%}.etiquetados[_ngcontent-%COMP%]   .dataa[_ngcontent-%COMP%]   .cerrarr[_ngcontent-%COMP%]{text-align:right;color:#fff;z-index:30;font-size:18px;padding:5px}.etiquetados[_ngcontent-%COMP%]   .dataa[_ngcontent-%COMP%]   .com[_ngcontent-%COMP%]{margin-top:50px;color:#fff;font-size:16px;padding:10px}.cc[_ngcontent-%COMP%]{background:#536169;color:#ccc}"]}),t})()}];let _=(()=>{class t{}return t.\u0275mod=c.Hb({type:t}),t.\u0275inj=c.Gb({factory:function(e){return new(e||t)},imports:[[r.i.forChild($)],r.i]}),t})();var z=i("iTUp");let k=(()=>{class t{}return t.\u0275mod=c.Hb({type:t}),t.\u0275inj=c.Gb({factory:function(e){return new(e||t)},imports:[[n.b,o.e,s.kb,_,z.a]]}),t})()},WGaO:function(t,e,i){"use strict";i.d(e,"a",function(){return f});var n=i("AytR"),o=i("tk/3"),s=i("coGc"),r=i("lJxs"),a=i("IzEk"),c=i("MtjB"),d=i("JIr8"),h=i("PqYM"),l=i("Cfvw"),p=i("fXoL"),b=i("B7Rs");let f=(()=>{class t{constructor(t,e){this.http=t,this.MmyTransfer=e}hanflerError(t){return t.pipe(Object(s.a)(()=>Object(h.a)(3e3)),Object(r.a)(t=>{if(console.log("Entramos a intentos"),t instanceof ErrorEvent)throw new Error("Error de Red");if(404===t.status)throw new Error(" P\xe1gina no encontrada")}),Object(a.a)(3))}BuscarUsuarios(t,e){const i={headers:new o.c({"x-token":t})};return this.http.put(`${n.a}/empleados/buscar/`,{patron:e},i).pipe(Object(c.a)(t=>this.hanflerError(t)))}crearPublicacion(t,e){const i={headers:new o.c({"x-token":t})};return this.http.post(`${n.a}/igtm/crear/`,e,i).pipe(Object(c.a)(t=>this.hanflerError(t)))}leerPublicacion(t,e){const i={headers:new o.c({"x-token":t})};return this.http.put(`${n.a}/igtm/leer/`,e,i).pipe(Object(c.a)(t=>this.hanflerError(t)))}leerPublicacionUsuario(t,e){const i={headers:new o.c({"x-token":t})};return this.http.put(`${n.a}/igtm/leer/usuario`,e,i).pipe(Object(c.a)(t=>this.hanflerError(t)))}subirArchivosChat(t,e,i,o,s,r,a,c){console.log("archivo",i);const h={fileKey:"archivo",fileName:a,mimeType:c,httpMethod:"POST",headers:{"x-token":t,"x-idpublicacion":e,"x-final":o,"x-cont":s,"x-historia":r}},p=this.MmyTransfer.create();return Object(l.a)(p.upload(i,`${n.a}/igtm/upload`,h)).pipe(Object(d.a)(t=>{throw console.log("No se pudo subir la imagen ",t),new Error("No se pudo subir la imagen ")}))}leerFotos(t,e){const i={headers:new o.c({"x-token":t})};return this.http.put(`${n.a}/igtm/fotos/leer/`,e,i).pipe(Object(c.a)(t=>this.hanflerError(t)))}vistos(t,e){const i={headers:new o.c({"x-token":t})};return this.http.post(`${n.a}/igtm/historias/vistos/`,e,i).pipe(Object(c.a)(t=>this.hanflerError(t)))}eliminar(t,e){const i={headers:new o.c({"x-token":t})};return this.http.put(`${n.a}/igtm/eliminar/`,e,i).pipe(Object(c.a)(t=>this.hanflerError(t)))}meGusta(t,e){const i={headers:new o.c({"x-token":t})};return this.http.put(`${n.a}/igtm/megusta/`,e,i).pipe(Object(c.a)(t=>this.hanflerError(t)))}saber(t,e){const i={headers:new o.c({"x-token":t})};return this.http.put(`${n.a}/igtm/publicacion/seguidos/`,e,i).pipe(Object(c.a)(t=>this.hanflerError(t)))}saberHistorias(t,e){const i={headers:new o.c({"x-token":t})};return this.http.put(`${n.a}/igtm/historias/seguidos/`,e,i).pipe(Object(c.a)(t=>this.hanflerError(t)))}leerUna(t,e){const i={headers:new o.c({"x-token":t})};return this.http.put(`${n.a}/igtm/leer/uno/`,e,i).pipe(Object(c.a)(t=>this.hanflerError(t)))}leerUna2(t,e){const i={headers:new o.c({"x-token":t})};return this.http.put(`${n.a}/igtm/leer/uno/historia`,e,i).pipe(Object(c.a)(t=>this.hanflerError(t)))}crearComentario(t,e){const i={headers:new o.c({"x-token":t})};return this.http.post(`${n.a}/igtm/comentarios/`,e,i).pipe(Object(c.a)(t=>this.hanflerError(t)))}crearCompartida(t,e){const i={headers:new o.c({"x-token":t})};return this.http.post(`${n.a}/igtm/compartir/`,e,i).pipe(Object(c.a)(t=>this.hanflerError(t)))}crearGuardado(t,e){const i={headers:new o.c({"x-token":t})};return this.http.post(`${n.a}/igtm/guardado/`,e,i).pipe(Object(c.a)(t=>this.hanflerError(t)))}}return t.\u0275fac=function(e){return new(e||t)(p.Qb(o.a),p.Qb(b.a))},t.\u0275prov=p.Fb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})()}}]);