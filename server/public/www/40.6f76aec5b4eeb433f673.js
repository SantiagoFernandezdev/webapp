(window.webpackJsonp=window.webpackJsonp||[]).push([[40],{Fe5k:function(t,o,i){"use strict";i.r(o),i.d(o,"HojaPageModule",function(){return J});var e=i("ofXK"),a=i("3Pt+"),n=i("TEn/"),r=i("tyNb"),s=i("mrSG"),c=i("fXoL"),l=i("fsfq"),d=i("fmoy"),b=i("AQLj"),f=i("VYYF"),h=i("r3ab"),u=i("SpuA");const p=["inifinito"];function g(t,o){1&t&&(c.Ob(0,"ion-item"),c.Ob(1,"ion-avatar",12),c.Mb(2,"ion-skeleton-text",13),c.Nb(),c.Ob(3,"ion-label"),c.Mb(4,"ion-skeleton-text",14),c.Mb(5,"ion-skeleton-text",15),c.Nb(),c.Nb())}const m=function(){return[1,1,1,1]};function v(t,o){1&t&&(c.Ob(0,"ion-list"),c.vc(1,g,6,0,"ion-item",11),c.Nb()),2&t&&(c.Ab(1),c.fc("ngForOf",c.kc(1,m)))}function O(t,o){1&t&&(c.Ob(0,"div",16),c.Mb(1,"img",17),c.Ob(2,"h3",18),c.wc(3,"Mis hojas de vida"),c.Nb(),c.Nb())}function j(t,o){if(1&t&&(c.Ob(0,"div",36),c.wc(1),c.Nb()),2&t){const t=c.Yb(2).$implicit;c.Ab(1),c.xc(t.placa)}}function N(t,o){if(1&t&&(c.Ob(0,"div",29),c.Ob(1,"strong"),c.wc(2,"Trabajador: "),c.Nb(),c.Ob(3,"span",31),c.wc(4),c.Nb(),c.Nb()),2&t){const t=c.Yb(2).$implicit;c.Ab(4),c.xc(t.trabajador.nombrecompleto)}}function x(t,o){1&t&&(c.Ob(0,"div",37),c.wc(1,"HOJA DE VIDA TERMINADA"),c.Nb())}function w(t,o){1&t&&(c.Ob(0,"div",38),c.wc(1,"HOJA DE VIDA SIN TERMINAR"),c.Nb())}function A(t,o){if(1&t&&(c.Ob(0,"ion-label",27),c.vc(1,j,2,1,"div",28),c.Ob(2,"div",29),c.Ob(3,"strong"),c.wc(4,"Taller: "),c.Nb(),c.Ob(5,"span",30),c.wc(6),c.Nb(),c.Nb(),c.Ob(7,"div",29),c.Ob(8,"strong"),c.wc(9,"Cliente: "),c.Nb(),c.Ob(10,"span",31),c.wc(11),c.Nb(),c.Nb(),c.Mb(12,"br"),c.vc(13,N,5,1,"div",32),c.Mb(14,"br"),c.Ob(15,"div",33),c.Ob(16,"strong"),c.wc(17,"Fecha: "),c.Nb(),c.Ob(18,"span",31),c.wc(19),c.Zb(20,"cambioUTC"),c.Nb(),c.Nb(),c.vc(21,x,2,0,"div",34),c.vc(22,w,2,0,"div",35),c.Nb()),2&t){const t=c.Yb().$implicit;c.Ab(1),c.fc("ngIf",t.placa),c.Ab(5),c.yc(" ",t.idtaller.nombrecompleto,""),c.Ab(5),c.xc(t.idusuario.nombrecompleto),c.Ab(2),c.fc("ngIf",t.trabajador),c.Ab(6),c.xc(c.ac(20,7,t.fecha)),c.Ab(2),c.fc("ngIf",t.terminado),c.Ab(1),c.fc("ngIf",!t.terminado)}}function I(t,o){if(1&t&&(c.Ob(0,"div",36),c.wc(1),c.Nb()),2&t){const t=c.Yb(2).$implicit;c.Ab(1),c.xc(t.placa)}}function C(t,o){if(1&t&&(c.Ob(0,"div",29),c.Ob(1,"strong"),c.wc(2,"Cliente: "),c.Nb(),c.Ob(3,"span",31),c.wc(4),c.Nb(),c.Nb()),2&t){const t=c.Yb(2).$implicit;c.Ab(4),c.yc(" ",t.nusuario,"")}}function E(t,o){if(1&t&&(c.Ob(0,"div",29),c.Ob(1,"strong"),c.wc(2,"Cliente: "),c.Nb(),c.Ob(3,"span",31),c.wc(4),c.Nb(),c.Nb()),2&t){const t=c.Yb(2).$implicit;c.Ab(4),c.yc(" ",t.idusuario.nombrecompleto,"")}}function k(t,o){if(1&t&&(c.Ob(0,"div",29),c.Ob(1,"strong"),c.wc(2,"Tel\xe9fono: "),c.Nb(),c.Ob(3,"span",31),c.wc(4),c.Nb(),c.Nb()),2&t){const t=c.Yb(2).$implicit;c.Ab(4),c.yc(" ",t.idusuario.tel,"")}}function M(t,o){if(1&t&&(c.Ob(0,"div",29),c.Ob(1,"strong"),c.wc(2,"Trabajador: "),c.Nb(),c.Ob(3,"span",31),c.wc(4),c.Nb(),c.Nb()),2&t){const t=o.$implicit;c.Ab(4),c.xc(t.nombrecompleto)}}function y(t,o){if(1&t&&(c.Ob(0,"div"),c.vc(1,M,5,1,"div",39),c.Nb()),2&t){const t=c.Yb(2).$implicit;c.Ab(1),c.fc("ngForOf",t.trabajador)}}function H(t,o){1&t&&(c.Ob(0,"div",37),c.wc(1,"HOJA DE VIDA TERMINADA"),c.Nb())}function P(t,o){1&t&&(c.Ob(0,"div",38),c.wc(1,"HOJA DE VIDA SIN TERMINAR"),c.Nb())}function T(t,o){if(1&t&&(c.Ob(0,"ion-label",27),c.vc(1,I,2,1,"div",28),c.Ob(2,"div",29),c.Ob(3,"strong"),c.wc(4,"Taller: "),c.Nb(),c.Ob(5,"span",30),c.wc(6),c.Nb(),c.Nb(),c.vc(7,C,5,1,"div",32),c.vc(8,E,5,1,"div",32),c.vc(9,k,5,1,"div",32),c.Mb(10,"br"),c.vc(11,y,2,1,"div",7),c.Mb(12,"br"),c.Ob(13,"div",33),c.Ob(14,"strong"),c.wc(15,"Fecha: "),c.Nb(),c.Ob(16,"span",31),c.wc(17),c.Zb(18,"cambioUTC"),c.Nb(),c.Nb(),c.vc(19,H,2,0,"div",34),c.vc(20,P,2,0,"div",35),c.Nb()),2&t){const t=c.Yb().$implicit;c.Ab(1),c.fc("ngIf",""!==t.placa),c.Ab(5),c.yc(" ",t.idtaller.nombrecompleto,""),c.Ab(1),c.fc("ngIf",t.idusuario&&""===t.idusuario),c.Ab(1),c.fc("ngIf",t.idusuario&&""!==t.idusuario),c.Ab(1),c.fc("ngIf",t.idusuario&&""!==t.idusuario),c.Ab(2),c.fc("ngIf",t.trabajador),c.Ab(6),c.xc(c.ac(18,9,t.fecha)),c.Ab(2),c.fc("ngIf",t.terminado),c.Ab(1),c.fc("ngIf",!t.terminado)}}function Y(t,o){if(1&t){const t=c.Pb();c.Ob(0,"ion-item-option",40),c.Wb("click",function(){c.pc(t);const o=c.Yb().$implicit;return c.Yb(2).correo(o)}),c.Mb(1,"ion-icon",41),c.Nb()}}function _(t,o){if(1&t){const t=c.Pb();c.Ob(0,"ion-item-option",42),c.Wb("click",function(){c.pc(t);const o=c.Yb().$implicit;return c.Yb(2).eli(o._id)}),c.Mb(1,"ion-icon",43),c.Nb()}}function D(t,o){if(1&t){const t=c.Pb();c.Ob(0,"ion-item-sliding"),c.Ob(1,"ion-item",19),c.Wb("click",function(){c.pc(t);const i=o.$implicit;return c.Yb(2).navegar(i)}),c.Ob(2,"ion-avatar",12),c.Mb(3,"img",20),c.Nb(),c.vc(4,A,23,9,"ion-label",21),c.vc(5,T,21,11,"ion-label",21),c.Nb(),c.Ob(6,"ion-item-options",22),c.vc(7,Y,2,0,"ion-item-option",23),c.Ob(8,"ion-item-option",24),c.Wb("click",function(){c.pc(t);const i=o.$implicit;return c.Yb(2).pdf(i)}),c.Mb(9,"ion-icon",25),c.Nb(),c.vc(10,_,2,0,"ion-item-option",26),c.Nb(),c.Nb()}if(2&t){const t=o.$implicit,i=c.Yb(2);c.Ab(4),c.fc("ngIf",!t.tipo||"cita"===t.tipo),c.Ab(1),c.fc("ngIf",t.tipo&&"hoja"===t.tipo),c.Ab(2),c.fc("ngIf",t.idtaller._id===i.id),c.Ab(3),c.fc("ngIf",t.idtaller._id===i.id)}}function F(t,o){if(1&t&&(c.Ob(0,"ion-list"),c.vc(1,D,11,4,"ion-item-sliding",11),c.Nb()),2&t){const t=c.Yb();c.Ab(1),c.fc("ngForOf",t.hojas)}}function L(t,o){if(1&t){const t=c.Pb();c.Ob(0,"ion-infinite-scroll",44,45),c.Wb("ionInfinite",function(o){return c.pc(t),c.Yb().loadData(o)}),c.Mb(2,"ion-infinite-scroll-content",46),c.Nb()}}function $(t,o){if(1&t){const t=c.Pb();c.Ob(0,"ion-fab",47),c.Ob(1,"ion-fab-button",48),c.Wb("click",function(){return c.pc(t),c.Yb().abrir()}),c.Mb(2,"ion-icon",49),c.Nb(),c.Nb()}}const z=[{path:"",component:(()=>{class t{constructor(t,o,i,e,a,n,r){this.almacenamiento=t,this.toast=o,this.apiHoja=i,this.router=e,this.statusbar=a,this.alertCtrl=n,this.loading=r,this.desde=0,this.hojas=[],this.cargado=!0,this.patron="",this.textoBuscar="",this.role="",this.id=""}ngOnInit(){}ionViewWillEnter(){this.desde=0,this.hojas=[],this.inifinito.disabled=!1,this.cargarHojas()}refrescando(t){this.desde=0,this.cargarHojas().then(()=>{t.target.complete()}).catch(()=>{t.target.complete()})}cargarHojas(){return Object(s.a)(this,void 0,void 0,function*(){const t=yield this.almacenamiento.obtenerToken();t&&(this.role=t.role,this.id=t._id,this.textoBuscar="TALLER_ROLE"===t.role?"Buscar por cliente":"Buscar por taller",this.apiHoja.buscarHojas(t.token,{desde:this.desde}).subscribe(t=>{t.exe?this.hojas=t.response:(this.hojas=[],this.toast.toastError("No se pudo traer las hojas de vida, int\xe9ntelo m\xe1s tarde.")),this.cargado=!0},t=>{this.cargado=!0,this.hojas=[],this.toast.toastError("No se pudo traer las hojas de vida, int\xe9ntelo m\xe1s tarde.")}))})}buscar(t){return Object(s.a)(this,void 0,void 0,function*(){if(""!==t.detail.value){this.desde=0,this.patron=t.detail.value;const o=yield this.almacenamiento.obtenerToken();o&&this.apiHoja.buscarHojasFiltro(o.token,{desde:this.desde,patron:this.patron}).subscribe(t=>{t.exe?this.hojas=t.response:this.toast.toastError("No se pudo realizar la b\xfasqueda, intentelo m\xe1s tarde")},t=>{this.toast.toastError("No se pudo realizar la b\xfasqueda, intentelo m\xe1s tarde")})}else this.inifinito.disabled=!1,this.cargarHojas()})}loadData(t){return Object(s.a)(this,void 0,void 0,function*(){this.desde=this.desde+5;const o=yield this.almacenamiento.obtenerToken();o&&(""===this.patron?this.apiHoja.buscarHojas(o.token,{desde:this.desde}).subscribe(o=>{o.exe?o.response.length>0?(o.response.forEach(t=>{this.hojas.push(t)}),t.target.complete()):(t.target.disabled=!0,this.desde=0):this.toast.toastError("No se pudo traer las hojas de vida, int\xe9ntelo m\xe1s tarde.")},t=>{this.toast.toastError("No se pudo traer las hojas de vida, int\xe9ntelo m\xe1s tarde.")}):this.apiHoja.buscarHojasFiltro(o.token,{desde:this.desde,patron:this.patron}).subscribe(o=>{o.exe?o.response.length>0?(o.response.forEach(t=>{this.hojas.push(t)}),t.target.complete()):(t.target.disabled=!0,this.desde=0):this.toast.toastError("No se pudo realizar la b\xfasqueda, intentelo m\xe1s tarde")},t=>{this.toast.toastError("No se pudo realizar la b\xfasqueda, intentelo m\xe1s tarde")}))})}navegar(t){this.router.navigate(["/central/menu/hoja/mihoja",t._id,"hoja"])}abrir(){return Object(s.a)(this,void 0,void 0,function*(){const t=yield this.alertCtrl.create({header:"Crear Hoja de vida",message:"\xbfQuieres crear una nueva hoja de vida?",inputs:[{type:"text",placeholder:"Nombre del cliente",name:"cliente"},{type:"text",placeholder:"Placa del Veh\xedculo",name:"placa"}],buttons:[{text:"Cancelar",role:"cancel"},{text:"Crear Hoja",handler:t=>{""===t.cliente||""===t.placa?this.toast.toastError("Debe llenar todos los campos"):this.crear(t)}}]});yield t.present()})}eli(t){return Object(s.a)(this,void 0,void 0,function*(){const o=yield this.alertCtrl.create({header:"Atenci\xf3n!",message:"\xbfEstas seguro de eliminar esta hoja de vida? No podr\xe1 recuperarla de nuevo",buttons:[{text:"Cancelar",cssClass:"cancelarAlerta",role:"cancel",handler:()=>{}},{text:"Aceptar",cssClass:"botonalerta",handler:()=>Object(s.a)(this,void 0,void 0,function*(){const o=yield this.almacenamiento.obtenerToken();o&&this.apiHoja.eliminarHoja(o.token,{id:t}).subscribe(t=>{t.exe?(this.toast.Especial("Hoja Borrada"),this.cargarHojas()):this.toast.toastError("No se pudo eliminar la hoja, int\xe9ntelo m\xe1s tarde")},t=>{this.toast.toastError("No se pudo eliminar la hoja, int\xe9ntelo m\xe1s tarde")})})}]});yield o.present()})}pdf(t){return Object(s.a)(this,void 0,void 0,function*(){this.loading.cargaProcesos("Exportando PDF, por faovr espere...");const o=yield this.almacenamiento.obtenerToken();o&&this.apiHoja.pdfHoja(o.token,{id:t._id}).subscribe(o=>{console.log(o),o.exe?(this.toast.Especial("PDF generado"),window.open("https://www.motocaliapp.com/hojas/download?path="+o.nombre+"&name=hoja-de-vida-"+t.placa+".pdf","_self")):this.toast.toastError("No se pudo eliminar la hoja, int\xe9ntelo m\xe1s tarde"),this.loading.finalizarCargado()},t=>{this.toast.toastError("No se pudo eliminar la hoja, int\xe9ntelo m\xe1s tarde"),this.loading.finalizarCargado()})})}correo(t){return Object(s.a)(this,void 0,void 0,function*(){const o=yield this.alertCtrl.create({header:"Enviar hoja de vida al correo electr\xf3nico",message:"Se enviar\xe1 la hoja de vida al correo electr\xf3nico registrado por el cliente, en caso de no tener o querer cambiar \xe9l correo puede actualizarlo con el sigueinte campo",inputs:[{type:"email",name:"correo",value:t.idusuario?t.idusuario.correo:""}],buttons:[{text:"Cancelar",cssClass:"cancelarAlerta",role:"cancel",handler:()=>{}},{text:"Enviar",cssClass:"botonalerta",handler:o=>Object(s.a)(this,void 0,void 0,function*(){if(o.correo){this.loading.cargaProcesos("Enviando correo, por faovr espere...");const i=yield this.almacenamiento.obtenerToken();i&&this.apiHoja.pdfHoja(i.token,{id:t._id,correo:o.correo}).subscribe(t=>{t.exe?this.toast.Especial("PDF generado y enviado al correo electr\xf3nico"):this.toast.toastError("No se pudo eliminar la hoja, int\xe9ntelo m\xe1s tarde"),this.loading.finalizarCargado()},t=>{this.toast.toastError("No se pudo eliminar la hoja, int\xe9ntelo m\xe1s tarde"),this.loading.finalizarCargado()})}else this.toast.toastError("Debe diligenciar un correo v\xe1lido")})}]});yield o.present()})}crear(t){return Object(s.a)(this,void 0,void 0,function*(){const o=yield this.almacenamiento.obtenerToken();o&&this.apiHoja.crearHoja(o.token,{usuario:"",placa:t.placa,nusuario:t.cliente,cita:"",trabajador:t.trabajador}).subscribe(t=>{t.exe?(this.toast.toastExitoso("Hoja de vida creada"),this.cargarHojas()):this.toast.toastError("No se pudo crear la hoja de vida, intentelo m\xe1s tarde")},t=>{this.toast.toastError("No se pudo crear la hoja de vida, intentelo m\xe1s tarde")})})}}return t.\u0275fac=function(o){return new(o||t)(c.Lb(l.a),c.Lb(d.a),c.Lb(b.a),c.Lb(r.g),c.Lb(f.a),c.Lb(n.b),c.Lb(h.a))},t.\u0275cmp=c.Fb({type:t,selectors:[["app-hoja"]],viewQuery:function(t,o){if(1&t&&c.Ac(p,1),2&t){let t;c.oc(t=c.Xb())&&(o.inifinito=t.first)}},decls:15,vars:6,consts:[[1,"ion-no-border"],["color","oscuro"],["icon","chevron-back-outline","slot","start","defaultHref","/central/menu/"],["slot","fixed","pullFactor","0.5","pullMin","50","pullMax","150",3,"ionRefresh"],["pullingIcon","arrow-dropdown","refreshingSpinner","circles"],["mode","ios",3,"placeholder","ionChange"],[1,"divider","light"],[4,"ngIf"],["class","flexbet",4,"ngIf"],["threshold","100px",3,"ionInfinite",4,"ngIf"],["vertical","bottom","horizontal","end","slot","fixed",4,"ngIf"],[4,"ngFor","ngForOf"],["slot","start"],["animted","",2,"width","100%","height","100%"],["animted","",2,"width","100%","height","20px"],["animted","",2,"width","50%","height","20px"],[1,"flexbet"],["src","/assets/Hojas.png","width","70px","alt",""],[1,"tituloGrande"],[1,"item","sinfondo",3,"click"],["src","/assets/Hoja.png","width","100%","height","100%","alt",""],["class","ion-text-wrap",4,"ngIf"],["side","start"],["color","masoscuro",3,"click",4,"ngIf"],["color","medium",3,"click"],["name","document","slot","icon-only"],["color","danger",3,"click",4,"ngIf"],[1,"ion-text-wrap"],["class","placa",4,"ngIf"],[1,"flex"],[1,"cll"],[1,"cl"],["class","flex",4,"ngIf"],[1,"flex","fl"],["class","terminado","color","barra",4,"ngIf"],["class","terminado2","color","barra",4,"ngIf"],[1,"placa"],["color","barra",1,"terminado"],["color","barra",1,"terminado2"],["class","flex",4,"ngFor","ngForOf"],["color","masoscuro",3,"click"],["name","send","slot","icon-only"],["color","danger",3,"click"],["name","trash","slot","icon-only"],["threshold","100px",3,"ionInfinite"],["inifinito",""],["loadingSpinner","bubbles","loadingText","Cargando Hojas de Vida..."],["vertical","bottom","horizontal","end","slot","fixed"],["color","oscuro",3,"click"],["name","add-outline"]],template:function(t,o){1&t&&(c.Ob(0,"ion-header",0),c.Ob(1,"ion-toolbar",1),c.Mb(2,"ion-back-button",2),c.Ob(3,"ion-title"),c.wc(4,"Hojas de Vida"),c.Nb(),c.Nb(),c.Nb(),c.Ob(5,"ion-content"),c.Ob(6,"ion-refresher",3),c.Wb("ionRefresh",function(t){return o.refrescando(t)}),c.Mb(7,"ion-refresher-content",4),c.Nb(),c.Ob(8,"ion-searchbar",5),c.Wb("ionChange",function(t){return o.buscar(t)}),c.Nb(),c.Mb(9,"div",6),c.vc(10,v,2,2,"ion-list",7),c.vc(11,O,4,0,"div",8),c.vc(12,F,2,1,"ion-list",7),c.vc(13,L,3,0,"ion-infinite-scroll",9),c.vc(14,$,3,0,"ion-fab",10),c.Nb()),2&t&&(c.Ab(8),c.gc("placeholder",o.textoBuscar),c.Ab(2),c.fc("ngIf",!o.cargado),c.Ab(1),c.fc("ngIf",o.cargado&&0===o.hojas.length),c.Ab(1),c.fc("ngIf",o.hojas.length>0),c.Ab(1),c.fc("ngIf",o.cargado),c.Ab(1),c.fc("ngIf","TALLER_ROLE"===o.role))},directives:[n.z,n.lb,n.g,n.h,n.jb,n.t,n.Q,n.R,n.U,n.yb,e.j,n.L,e.i,n.F,n.f,n.Z,n.K,n.J,n.I,n.H,n.A,n.C,n.D,n.v,n.w],pipes:[u.a],styles:[".flexbet[_ngcontent-%COMP%]{margin-top:15px;text-align:center}.tituloGrande[_ngcontent-%COMP%]{opacity:.3}.flex[_ngcontent-%COMP%]{display:flex;justify-content:space-between}.fl[_ngcontent-%COMP%]{align-items:flex-start}.cl[_ngcontent-%COMP%], .cll[_ngcontent-%COMP%]{text-align:right}.separador[_ngcontent-%COMP%]{margin-top:5px;background:#e9e9e9;padding:5px}.item[_ngcontent-%COMP%]:nth-child(2n){--background:#f7f7f7!important}.terminado[_ngcontent-%COMP%]{background-color:#d9e2c6}.terminado[_ngcontent-%COMP%], .terminado2[_ngcontent-%COMP%]{width:100%;padding:10px;text-align:center;font-weight:700}.terminado2[_ngcontent-%COMP%]{background-color:#f2c9c5}.placa[_ngcontent-%COMP%]{width:150px;background-color:#ffa800;color:#000;font-size:18px;text-align:center;padding:5px 10;border-radius:5px;font-weight:700;border:3px solid #000;margin-bottom:5px}"]}),t})()}];let R=(()=>{class t{}return t.\u0275fac=function(o){return new(o||t)},t.\u0275mod=c.Jb({type:t}),t.\u0275inj=c.Ib({imports:[[r.j.forChild(z)],r.j]}),t})();var S=i("iTUp");let J=(()=>{class t{}return t.\u0275fac=function(o){return new(o||t)},t.\u0275mod=c.Jb({type:t}),t.\u0275inj=c.Ib({imports:[[e.b,a.e,n.mb,R,S.a]]}),t})()},SpuA:function(t,o,i){"use strict";i.d(o,"a",function(){return n});var e=i("wd/R"),a=i("fXoL");let n=(()=>{class t{transform(t){console.log(t,"fechin");let o=e.utc(t).toDate();return e(o).format("dddd, DD MMMM YYYY h:mm:a")}}return t.\u0275fac=function(o){return new(o||t)},t.\u0275pipe=a.Kb({name:"cambioUTC",type:t,pure:!0}),t})()},r3ab:function(t,o,i){"use strict";i.d(o,"a",function(){return r});var e=i("mrSG"),a=i("fXoL"),n=i("TEn/");let r=(()=>{class t{constructor(t){this.loadingCtrl=t}cargaProcesos(t){return Object(e.a)(this,void 0,void 0,function*(){return this.loading=yield this.loadingCtrl.create({message:t}),this.loading.present()})}finalizarCargado(){this.loading.dismiss()}}return t.\u0275fac=function(o){return new(o||t)(a.Sb(n.ob))},t.\u0275prov=a.Hb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})()}}]);