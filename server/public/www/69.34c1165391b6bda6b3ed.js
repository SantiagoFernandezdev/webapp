(window.webpackJsonp=window.webpackJsonp||[]).push([[69],{"AqZ+":function(i,t,e){"use strict";e.r(t),e.d(t,"SANcreadorPageModule",function(){return W});var o=e("ofXK"),n=e("3Pt+"),a=e("TEn/"),c=e("tyNb"),r=e("mrSG"),s=e("rE7l"),l=e("fXoL"),b=e("fsfq"),d=e("WGaO"),h=e("fmoy"),u=e("a/9d"),f=e("/sJY"),m=e("r3ab"),p=e("7JkF"),g=e("VYYF");const v=["lienzo"],O=["fileUpload"];function F(i,t){1&i&&(l.Ob(0,"ion-title"),l.wc(1,"Crear publicaci\xf3n"),l.Nb())}function x(i,t){1&i&&(l.Ob(0,"ion-title"),l.wc(1,"Crear Noticia"),l.Nb())}function N(i,t){if(1&i){const i=l.Pb();l.Ob(0,"div",24),l.Wb("click",function(){l.pc(i);const e=t.$implicit;return l.Yb(2).cambiarColor(e)}),l.Ob(1,"span"),l.wc(2,"ssfsdfsfs"),l.Nb(),l.Nb()}2&i&&l.tc("background",t.$implicit.color)}function w(i,t){if(1&i){const i=l.Pb();l.Ob(0,"ion-textarea",25),l.Wb("ngModelChange",function(t){return l.pc(i),l.Yb(2).valort=t})("ionChange",function(t){return l.pc(i),l.Yb(2).cambiarTexto(t)}),l.Nb()}if(2&i){const i=l.Yb(2);l.fc("ngModel",i.valort)("autoGrow",!0)}}function C(i,t){if(1&i){const i=l.Pb();l.Ob(0,"ion-item-sliding"),l.Ob(1,"ion-item"),l.Ob(2,"ion-avatar",28),l.Mb(3,"img",29),l.Nb(),l.Ob(4,"ion-label"),l.Ob(5,"strong"),l.wc(6),l.Nb(),l.Mb(7,"br"),l.wc(8),l.Nb(),l.Nb(),l.Ob(9,"ion-item-options",30),l.Ob(10,"ion-item-option",31),l.Wb("click",function(){l.pc(i);const e=t.index;return l.Yb(3).eliminar(e)}),l.Mb(11,"ion-icon",32),l.Nb(),l.Nb(),l.Nb()}if(2&i){const i=t.$implicit;l.Ab(3),l.fc("src",i.imagen,l.qc),l.Ab(3),l.xc(i.nombrecompleto),l.Ab(2),l.yc(" @",i.nombreusuario," ")}}function y(i,t){if(1&i&&(l.Ob(0,"div",26),l.vc(1,C,12,3,"ion-item-sliding",27),l.Nb()),2&i){const i=l.Yb(2);l.Ab(1),l.fc("ngForOf",i.etiquetados)}}function A(i,t){if(1&i){const i=l.Pb();l.Ob(0,"div",12),l.Ob(1,"ion-segment",13),l.vc(2,N,3,2,"div",14),l.Nb(),l.Ob(3,"div",15,16),l.vc(5,w,1,2,"ion-textarea",17),l.Nb(),l.Ob(6,"ion-list"),l.Ob(7,"ion-item-divider",18),l.Ob(8,"ion-label"),l.wc(9,"A\xf1adir Etiquetas"),l.Nb(),l.Ob(10,"ion-buttons",19),l.Ob(11,"ion-button",5),l.Wb("click",function(){return l.pc(i),l.Yb().etiquetar()}),l.Mb(12,"ion-icon",20),l.Nb(),l.Nb(),l.Nb(),l.vc(13,y,2,1,"div",21),l.Nb(),l.Ob(14,"ion-item",22),l.Ob(15,"ion-textarea",23),l.Wb("ionChange",function(t){return l.pc(i),l.Yb().cambiar(t)}),l.Nb(),l.Nb(),l.Nb()}if(2&i){const i=l.Yb();l.Ab(2),l.fc("ngForOf",i.colores),l.Ab(1),l.tc("background",i.colorSelect.color)("color",i.colorSelect.letra),l.Ab(2),l.fc("ngIf",i.cargan),l.Ab(8),l.fc("ngIf",i.etiquetados.length>0),l.Ab(2),l.fc("autoGrow",!0)("value",i.comentario)}}function M(i,t){1&i&&(l.Ob(0,"div",36),l.Ob(1,"div",37),l.Mb(2,"img",38),l.Mb(3,"br"),l.Ob(4,"h3",39),l.wc(5,"No Hay archivos agregados para publicar."),l.Nb(),l.Nb(),l.Nb())}function P(i,t){if(1&i&&l.Mb(0,"img",43),2&i){const i=l.Yb().$implicit;l.gc("src",i,l.qc)}}function k(i,t){if(1&i){const i=l.Pb();l.Ob(0,"ion-slide"),l.vc(1,P,1,1,"img",40),l.Ob(2,"div",41),l.Wb("click",function(){l.pc(i);const e=t.index;return l.Yb(3).eliminardelcarrete(e)}),l.Ob(3,"ion-chip",42),l.wc(4,"Eliminar"),l.Nb(),l.Nb(),l.Nb()}if(2&i){const i=t.$implicit;l.Ab(1),l.fc("ngIf",i)}}function j(i,t){if(1&i&&(l.Ob(0,"ion-slides"),l.vc(1,k,5,1,"ion-slide",27),l.Nb()),2&i){const i=l.Yb(2);l.Ab(1),l.fc("ngForOf",i.filesRendering)}}function I(i,t){if(1&i){const i=l.Pb();l.Ob(0,"ion-item-sliding"),l.Ob(1,"ion-item"),l.Ob(2,"ion-avatar",28),l.Mb(3,"img",29),l.Nb(),l.Ob(4,"ion-label"),l.Ob(5,"strong"),l.wc(6),l.Nb(),l.Mb(7,"br"),l.wc(8),l.Nb(),l.Nb(),l.Ob(9,"ion-item-options",30),l.Ob(10,"ion-item-option",31),l.Wb("click",function(){l.pc(i);const e=t.index;return l.Yb(3).eliminar(e)}),l.Mb(11,"ion-icon",32),l.Nb(),l.Nb(),l.Nb()}if(2&i){const i=t.$implicit;l.Ab(3),l.fc("src",i.imagen,l.qc),l.Ab(3),l.xc(i.nombrecompleto),l.Ab(2),l.yc(" @",i.nombreusuario," ")}}function q(i,t){if(1&i&&(l.Ob(0,"div",26),l.vc(1,I,12,3,"ion-item-sliding",27),l.Nb()),2&i){const i=l.Yb(2);l.Ab(1),l.fc("ngForOf",i.etiquetados)}}function E(i,t){if(1&i){const i=l.Pb();l.Ob(0,"div",12),l.Ob(1,"div"),l.Mb(2,"input",33,34),l.vc(4,M,6,0,"div",35),l.vc(5,j,2,1,"ion-slides",3),l.Nb(),l.Ob(6,"ion-list"),l.vc(7,q,2,1,"div",21),l.Nb(),l.Ob(8,"ion-item",22),l.Ob(9,"ion-textarea",23),l.Wb("ionChange",function(t){return l.pc(i),l.Yb().cambiar(t)}),l.Nb(),l.Nb(),l.Nb()}if(2&i){const i=l.Yb();l.Ab(4),l.fc("ngIf",0===i.filesRendering.length),l.Ab(1),l.fc("ngIf",i.filesRendering.length>0),l.Ab(2),l.fc("ngIf",i.etiquetados.length>0),l.Ab(2),l.fc("autoGrow",!0)("value",i.comentario)}}function L(i,t){if(1&i){const i=l.Pb();l.Ob(0,"ion-fab",44),l.Ob(1,"ion-fab-button",31),l.Wb("click",function(){return l.pc(i),l.Yb().opciones()}),l.Mb(2,"ion-icon",45),l.Nb(),l.Nb()}}const R=[{path:"",component:(()=>{class i{constructor(i,t,e,o,n,a,c,r,s,l,b,d,h){this.almacenamiento=i,this.modalCtrl=t,this.IGTMApi=e,this.toast=o,this.router=n,this.actionCtrl=a,this.camera=c,this.media=r,this.myLoading=s,this.socket=l,this.statusbar=b,this.activeRoute=d,this.nav=h,this.tipoPublicacion="dibujar",this.historia=!1,this.cargado=!1,this.colorSelect={color:"#fafafa",letra:"#333333"},this.colores=[{color:"#fafafa",letra:"#333333"},{color:"#000000",letra:"#FFFFFF"},{color:"#8854DA",letra:"#FFFFFF"},{color:"#FFD000",letra:"#FFFFFF"},{color:"#BAB417",letra:"#FFFFFF"},{color:"#AAD9F0",letra:"#FFFFFF"},{color:"#F5AD45",letra:"#FFFFFF"},{color:"#DD5347",letra:"#FFFFFF"},{color:"#F8C883",letra:"#333333"},{color:"#1ABCFE",letra:"#333333"},{color:"#0ACF83",letra:"#333333"},{color:"#ED576B",letra:"#ffffff"},{color:"#FFA300",letra:"#333333"},{color:"#555555",letra:"#ffffff"},{color:"#CC924E",letra:"#ffffff"},{color:"#D69624",letra:"#ffffff"},{color:"#FF7262",letra:"#ffffff"}],this.texto="",this.valort="",this.etiquetados=[],this.comentario="",this.archivos=[],this.carrete=[],this.carreteRoot=[],this.video=!1,this.tipo="",this.cargan=!0,this.files=[],this.filesRendering=[]}ngOnInit(){}ionViewWillEnter(){this.carrete=[],this.carreteRoot=[],this.etiquetados=[],this.comentario="",this.texto="",this.valort="",this.tipo=this.activeRoute.snapshot.paramMap.get("tipo"),"historia"===this.activeRoute.snapshot.paramMap.get("tipo")&&(this.historia=!0),this.iniciar()}cambiarColor(i){this.colorSelect=i}detectar(i){}cambio(i){this.tipoPublicacion=i.detail.value,this.carrete=[],this.carreteRoot=[]}iniciar(){return Object(r.a)(this,void 0,void 0,function*(){this.cargado=!0,yield this.almacenamiento.obtenerToken()})}etiquetar(){return Object(r.a)(this,void 0,void 0,function*(){const i=yield this.modalCtrl.create({component:s.a,componentProps:{tipo:"etiquetar"}});yield i.present();const t=yield i.onWillDismiss();t&&t.data&&t.data.exe&&(this.etiquetados.find(i=>i.nombreusuario===t.data.persona.nombreusuario)||this.etiquetados.push(t.data.persona))})}eliminar(i){this.etiquetados.splice(i,1)}cambiar(i){this.comentario=i.detail.value}cambiarTexto(i){this.texto=i.detail.value}entrada(i){return Object(r.a)(this,void 0,void 0,function*(){const t=this.comentario;if("@"===i.detail.data){const i=t.charAt(t.length-1);if(" "===i||""===i){const i=yield this.modalCtrl.create({component:s.a,componentProps:{tipo:"mencionar"}});yield i.present();const t=yield i.onWillDismiss();t&&t.data.exe&&(this.comentario=this.comentario+t.data.persona.nombreusuario)}}})}opciones(){return Object(r.a)(this,void 0,void 0,function*(){const i=yield this.actionCtrl.create({header:"Escoge una opci\xf3n",buttons:[{icon:"image-outline",text:"Subir foto de galer\xeda",handler:()=>{if(this.historia&&1===this.files.length)this.toast.toastError("Solo puedes subir una foto por historia");else{const i=this.fileUpload.nativeElement;i.onchange=t=>{for(let e=0;e<i.files.length;e++){const o=i.files[e];console.log(o,o.name),this.files.push({data:o,inProgress:!1,progress:0,mime:"image"});let n,a=new FileReader;a.readAsDataURL(t.target.files[0]),a.onload=function(){console.log(a.result),n=a.result},setTimeout(()=>{this.filesRendering.push(n)},1500)}},i.click()}}},{icon:"people-outline",text:"Etiquetas",handler:()=>{this.etiquetar()}}]});yield i.present()})}eliminardelcarrete(i){this.filesRendering.splice(i,1),this.files.splice(i,1)}tomarFoto(i,t){this.camera.getPicture({quality:100,allowEdit:!0,correctOrientation:!0,destinationType:this.camera.DestinationType.FILE_URI,mediaType:"image"===t?this.camera.MediaType.PICTURE:this.camera.MediaType.VIDEO,sourceType:i}).then(i=>Object(r.a)(this,void 0,void 0,function*(){let t="",e="";i.includes("jpg")?(t="image/jpg",e="image.jpg"):i.includes("png")?(t="image/png",e="image.png"):i.includes("jpeg")?(t="image/jpeg",e="image.jpeg"):i.includes("gif")?(t="image/gif",e="image.gif"):(e="video.mp4",t="video/mp4"),this.carrete.push({path:i,name:e,mime:t,cont:this.carrete.length+1});const o=window.Ionic.WebView.convertFileSrc(i);this.carreteRoot.push({path:o,mime:t}),this.camera.cleanup().then(()=>{})}))}capturarVideo(){this.media.captureVideo({limit:1,duration:30}).then(i=>{this.carrete.push({path:i[0].fullPath,name:i[0].name,mime:i[0].type,cont:this.carrete.length+1});const t=window.Ionic.WebView.convertFileSrc(i[0].fullPath);this.carreteRoot.push({path:t,mime:i[0].type})})}eliminardelCarrete(i){this.carrete.splice(i,1),this.carreteRoot.splice(i,1),this.carrete.find(i=>i.mime.includes("video")||i.mime.includes("Video"))||(this.video=!1)}crear(){return Object(r.a)(this,void 0,void 0,function*(){const i=yield this.almacenamiento.obtenerToken();i&&("dibujar"===this.tipoPublicacion?""!==this.texto&&this.publicacion(i.token,{tipo:"dibujar",grafico:this.colorSelect,texto:this.texto,comentario:this.comentario,etiquetas:this.etiquetados,historia:this.historia}):"multimedia"===this.tipoPublicacion&&this.enviarMensaje())})}enviarMensaje(){return Object(r.a)(this,void 0,void 0,function*(){if(this.files.length>0){const i=yield this.almacenamiento.obtenerToken();this.myLoading.cargaProcesos("Subiendo mensaje con archivos media, por favor espere"),i&&this.IGTMApi.crearPublicacion(i.token,{tipo:"multimedia",comentario:this.comentario,etiquetas:this.etiquetados,historia:this.historia}).subscribe(t=>{if(t.exe){const e=t.response._id;let o=this.files.length,n=1===this.files.length;this.files.forEach(t=>{const a=new FormData;a.append("archivo",t.data),t.inProgress=!0,this.IGTMApi.subirweb(i.token,e,n,o,this.historia,a).subscribe(i=>{console.log(i,"eeeee"),i.exe&&(o--,1===o&&(n=!0),0===o&&(i.response.tipo="file",this.myLoading.finalizarCargado(),t.mime.includes("video")||t.mime.includes("Video")?(this.socket.emit("subirvideo",{nameSecret:i.response.response.ruta,nameConvert:i.response.response.nuevo,creador:i.response.response.creador,mime:i.response.response.nombre,_id:e,historia:this.historia}),this.toast.toastExitoso("La publicaci\xf3n estar\xe1 disponible en unos momentos.")):this.toast.toastExitoso("Contenido publicado."),this.nav.navigateRoot(["/interactivo"])))},i=>{this.myLoading.finalizarCargado(),this.toast.alertApplication("No se pudo subir el archivo de v\xeddeo o imagen",!0)})})}})}})}publicacion(i,t){this.IGTMApi.crearPublicacion(i,t).subscribe(i=>{i.exe?(this.valort="",this.texto="",this.toast.toastExitoso("Contenido publicado."),this.router.navigate(["/central/iniciosan"])):this.toast.toastError("No se pudo crear la publicaci\xf3n, intentelo m\xe1s tarde")},i=>{this.toast.toastError("No se pudo crear la publicaci\xf3n, intentelo m\xe1s tarde")})}ionViewWillLeave(){this.carrete=[],this.carreteRoot=[],this.etiquetados=[],this.comentario="",this.texto="",this.valort=""}}return i.\u0275fac=function(t){return new(t||i)(l.Lb(b.a),l.Lb(a.qb),l.Lb(d.a),l.Lb(h.a),l.Lb(c.g),l.Lb(a.a),l.Lb(u.a),l.Lb(f.a),l.Lb(m.a),l.Lb(p.a),l.Lb(g.a),l.Lb(c.a),l.Lb(a.rb))},i.\u0275cmp=l.Fb({type:i,selectors:[["app-sancreador"]],viewQuery:function(i,t){if(1&i&&(l.Ac(v,1),l.Ac(O,1)),2&i){let i;l.oc(i=l.Xb())&&(t.p=i.first),l.oc(i=l.Xb())&&(t.fileUpload=i.first)}},decls:19,vars:5,consts:[[1,"ion-no-border"],["color","oscuro"],["slot","start","icon","chevron-back-outline","defaultHref","/central/iniciosan"],[4,"ngIf"],["mode","ios","slot","end"],[3,"click"],["color","blanco"],["value","dibujar","okayText","Aceptar","cancelText","Cancelar",3,"ionChange"],["value","dibujar"],["value","multimedia"],["class","",4,"ngIf"],["vertical","bottom","horizontal","end","slot","fixed",4,"ngIf"],[1,""],["scrollable","true"],["class","color",3,"background","click",4,"ngFor","ngForOf"],[1,"lienzo"],["lienzo",""],["inputmode","text","maxlength","120","class","text-lienzo","placeholder","Escribe un texto para la publicaci\xf3n","value","",3,"ngModel","autoGrow","ngModelChange","ionChange",4,"ngIf"],["color","light"],["slot","end"],["name","chevron-forward-outline","slot","icon-only"],["class","etiquetados",4,"ngIf"],["mode","ios",1,"sinfondo"],["inputmode","text","maxlength","120","placeholder","Escribe un comentario",1,"comentario",3,"autoGrow","value","ionChange"],[1,"color",3,"click"],["inputmode","text","maxlength","120","placeholder","Escribe un texto para la publicaci\xf3n","value","",1,"text-lienzo",3,"ngModel","autoGrow","ngModelChange","ionChange"],[1,"etiquetados"],[4,"ngFor","ngForOf"],["slot","start"],["width","100%","height","100%","alt","",3,"src"],["side","end"],["color","danger",3,"click"],["slot","icon-only","name","trash-outline"],["type","file","id","fileUpload","name","archivo","accept","image/*",2,"display","none"],["fileUpload",""],["class","none",4,"ngIf"],[1,"none"],[1,"flexc"],["src","/assets/Camara.png","width","70px","alt",""],[1,"tituloGrande"],["width","70px",3,"src",4,"ngIf"],[1,"eliminar",3,"click"],["color","danger"],["width","70px",3,"src"],["vertical","bottom","horizontal","end","slot","fixed"],["name","add"]],template:function(i,t){1&i&&(l.Ob(0,"ion-header",0),l.Ob(1,"ion-toolbar",1),l.Mb(2,"ion-back-button",2),l.vc(3,F,2,0,"ion-title",3),l.vc(4,x,2,0,"ion-title",3),l.Ob(5,"ion-buttons",4),l.Ob(6,"ion-button",5),l.Wb("click",function(){return t.crear()}),l.wc(7,"Publicar"),l.Nb(),l.Nb(),l.Nb(),l.Nb(),l.Ob(8,"ion-content"),l.Ob(9,"ion-list"),l.Ob(10,"ion-item",6),l.Ob(11,"ion-select",7),l.Wb("ionChange",function(i){return t.cambio(i)}),l.Ob(12,"ion-select-option",8),l.wc(13,"Dibujar"),l.Nb(),l.Ob(14,"ion-select-option",9),l.wc(15,"Multimedia"),l.Nb(),l.Nb(),l.Nb(),l.Nb(),l.vc(16,A,16,9,"div",10),l.vc(17,E,10,5,"div",10),l.vc(18,L,3,0,"ion-fab",11),l.Nb()),2&i&&(l.Ab(3),l.fc("ngIf",!t.historia),l.Ab(1),l.fc("ngIf",t.historia),l.Ab(12),l.fc("ngIf","dibujar"===t.tipoPublicacion),l.Ab(1),l.fc("ngIf","multimedia"===t.tipoPublicacion),l.Ab(1),l.fc("ngIf","multimedia"===t.tipoPublicacion))},directives:[a.z,a.lb,a.g,a.h,o.j,a.k,a.j,a.t,a.L,a.F,a.X,a.xb,a.Y,a.jb,a.V,o.i,a.G,a.K,a.A,a.hb,a.yb,n.f,n.i,n.k,a.J,a.f,a.I,a.H,a.bb,a.ab,a.r,a.v,a.w],styles:[".flex[_ngcontent-%COMP%]{display:flex;justify-content:space-around;align-items:center;padding:10px}ion-slide[_ngcontent-%COMP%], ion-slides[_ngcontent-%COMP%]{width:100%;min-height:100%}ion-slide[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap}div[_ngcontent-%COMP%]{width:100%}.color[_ngcontent-%COMP%]{margin:5px;width:50px;height:50px;border-radius:10px}.color[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{opacity:0}.lienzo[_ngcontent-%COMP%]{margin-top:10px;width:100%;max-height:auto;padding:10px}.text-lienzo[_ngcontent-%COMP%]{width:100%;text-align:center;min-height:100%!important;font-size:24px;font-weight:700;line-height:1.7}.comentario[_ngcontent-%COMP%]{width:100%;text-align:left}.amarillo[_ngcontent-%COMP%]{--background:#fef1a7!important}.flexc[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center}.tituloGrande[_ngcontent-%COMP%]{text-align:center;width:300px}"]}),i})()}];let T=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=l.Jb({type:i}),i.\u0275inj=l.Ib({imports:[[c.j.forChild(R)],c.j]}),i})();var Y=e("J1J0");let W=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=l.Jb({type:i}),i.\u0275inj=l.Ib({imports:[[o.b,n.e,a.mb,T,Y.a]]}),i})()},r3ab:function(i,t,e){"use strict";e.d(t,"a",function(){return c});var o=e("mrSG"),n=e("fXoL"),a=e("TEn/");let c=(()=>{class i{constructor(i){this.loadingCtrl=i}cargaProcesos(i){return Object(o.a)(this,void 0,void 0,function*(){return this.loading=yield this.loadingCtrl.create({message:i}),this.loading.present()})}finalizarCargado(){this.loading.dismiss()}}return i.\u0275fac=function(t){return new(t||i)(n.Sb(a.ob))},i.\u0275prov=n.Hb({token:i,factory:i.\u0275fac,providedIn:"root"}),i})()}}]);