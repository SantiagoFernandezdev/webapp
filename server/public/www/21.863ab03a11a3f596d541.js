(window.webpackJsonp=window.webpackJsonp||[]).push([[21],{"4kKk":function(t,i,e){"use strict";e.d(i,"a",function(){return y});var s=e("mrSG"),n=e("fXoL"),o=e("fsfq"),a=e("TEn/"),c=e("fmoy"),r=e("WGaO");let d=(()=>{class t{constructor(t,i,e,s,n,o){this.almacenamiento=t,this.modalCtrl=i,this.toast=e,this.apiIgtm=s,this.alert=n,this.popover=o}ngOnInit(){}alerta(){return Object(s.a)(this,void 0,void 0,function*(){const t=yield this.alert.create({header:"\xbfEsta seguro de eliminar esta historia?",message:"esta acci\xf3n ser\xe1 de forma permanente",buttons:[{text:"Cancelar",cssClass:"cancelarAlerta",role:"cancel",handler:()=>{this.cancelar()}},{text:"Aceptar",cssClass:"botonalerta",handler:()=>{this.eliminar()}}]});yield t.present()})}cancelar(){this.popover.dismiss()}eliminar(){return Object(s.a)(this,void 0,void 0,function*(){const t=yield this.almacenamiento.obtenerToken();t&&this.apiIgtm.eliminarHistoria(t.token,{id:this.id}).subscribe(t=>{t.exe?this.popover.dismiss({exe:!0}):this.toast.toastError("No se pudo eliminar la historia, intentelo mpas tarde")},t=>{this.toast.toastError("No se pudo eliminar la historia, intentelo mpas tarde")})})}}return t.\u0275fac=function(i){return new(i||t)(n.Lb(o.a),n.Lb(a.qb),n.Lb(c.a),n.Lb(r.a),n.Lb(a.b),n.Lb(a.ub))},t.\u0275cmp=n.Fb({type:t,selectors:[["app-alert-historias"]],inputs:{id:"id"},decls:5,vars:0,consts:[[3,"click"],["slot","start","name","trash-outline","color","danger"]],template:function(t,i){1&t&&(n.Ob(0,"ion-list"),n.Ob(1,"ion-item",0),n.Wb("click",function(){return i.alerta()}),n.Mb(2,"ion-icon",1),n.Ob(3,"ion-label"),n.wc(4,"Eliminar"),n.Nb(),n.Nb(),n.Nb())},directives:[a.L,a.F,a.A,a.K],styles:[""]}),t})();var l=e("VYYF"),b=e("tyNb"),h=e("ofXK");let p=(()=>{class t{transform(t){if("dibujar"===t.tipo)return`background-color: ${t.dibujo.fondo}; color: ${t.dibujo.color};`}}return t.\u0275fac=function(i){return new(i||t)},t.\u0275pipe=n.Kb({name:"colores",type:t,pure:!0}),t})();const f=["slide"],g=["miSlide"];function u(t,i){if(1&t){const t=n.Pb();n.Ob(0,"ion-button",14),n.Wb("click",function(i){n.pc(t);const e=n.Yb().index,s=n.Yb().index;return n.Yb(2).opciones(i,s,e)}),n.Mb(1,"ion-icon",21),n.Nb()}}function m(t,i){if(1&t&&(n.Ob(0,"div",22),n.Ob(1,"h3"),n.wc(2),n.Nb(),n.Nb()),2&t){const t=n.Yb().$implicit;n.Ab(2),n.xc(t.dibujo.texto)}}function v(t,i){if(1&t&&n.Mb(0,"img",12),2&t){const t=n.Yb().$implicit;n.hc("src","https://www.motocaliapp.com/11927613401/",t.archivos[0].ruta,"",n.qc)}}function O(t,i){if(1&t){const t=n.Pb();n.Ob(0,"div",23),n.Ob(1,"div",24),n.Wb("click",function(){n.pc(t);const i=n.Yb().index,e=n.Yb().index;return n.Yb(2).abrir(e,i)}),n.wc(2," Ver m\xe1s... "),n.Nb(),n.Nb()}}function w(t,i){if(1&t&&(n.Ob(0,"div",30),n.wc(1),n.Nb()),2&t){const t=n.Yb(2).$implicit;n.Ab(1),n.xc(t.comentario)}}function x(t,i){if(1&t){const t=n.Pb();n.Ob(0,"ion-item",33),n.Wb("click",function(){n.pc(t);const e=i.$implicit;return n.Yb(6).perfilNavegar(e.nombreusuario)}),n.Ob(1,"ion-avatar",34),n.Mb(2,"img",35),n.Nb(),n.Ob(3,"ion-label"),n.Ob(4,"div"),n.wc(5),n.Nb(),n.Ob(6,"strong"),n.wc(7),n.Nb(),n.Nb(),n.Nb()}if(2&t){const t=i.$implicit;n.Ab(2),n.hc("src","https://www.motocaliapp.com/",t.imagen[0].path,"",n.qc),n.Ab(3),n.xc(t.nombrecompleto),n.Ab(2),n.yc("@",t.nombreusuario,"")}}function M(t,i){if(1&t&&(n.Ob(0,"ion-list"),n.Ob(1,"ion-item-divider",31),n.wc(2,"Usuarios etiquetados"),n.Nb(),n.vc(3,x,8,3,"ion-item",32),n.Nb()),2&t){const t=n.Yb(2).$implicit;n.Ab(3),n.fc("ngForOf",t.etiquetas)}}function P(t,i){if(1&t){const t=n.Pb();n.Ob(0,"ion-item",33),n.Wb("click",function(){n.pc(t);const e=i.$implicit;return n.Yb(6).perfilNavegar(e.nombreusuario)}),n.Ob(1,"ion-avatar",34),n.Mb(2,"img",35),n.Nb(),n.Ob(3,"ion-label"),n.Ob(4,"div"),n.wc(5),n.Nb(),n.Ob(6,"strong"),n.wc(7),n.Nb(),n.Nb(),n.Nb()}if(2&t){const t=i.$implicit;n.Ab(2),n.hc("src","https://www.motocaliapp.com/",t.imagen[0].path,"",n.qc),n.Ab(3),n.xc(t.nombrecompleto),n.Ab(2),n.yc("@",t.nombreusuario,"")}}function C(t,i){if(1&t&&(n.Ob(0,"ion-list"),n.Ob(1,"ion-item-divider",31),n.wc(2),n.Nb(),n.vc(3,P,8,3,"ion-item",32),n.Nb()),2&t){const t=n.Yb(2).$implicit;n.Ab(2),n.yc("Visto por ",t.vistos.length," "),n.Ab(1),n.fc("ngForOf",t.vistos)}}function _(t,i){if(1&t){const t=n.Pb();n.Ob(0,"div",25),n.Ob(1,"div",26),n.Ob(2,"div",27),n.Wb("click",function(){n.pc(t);const i=n.Yb().index,e=n.Yb().index;return n.Yb(2).cerrar2(e,i)}),n.wc(3,"x"),n.Nb(),n.vc(4,w,2,1,"div",28),n.vc(5,M,4,1,"ion-list",29),n.vc(6,C,4,2,"ion-list",29),n.Nb(),n.Nb()}if(2&t){const t=n.Yb().$implicit,i=n.Yb(3);n.Ab(4),n.fc("ngIf",""!==t.comentario),n.Ab(1),n.fc("ngIf",t.etiquetas.length>0),n.Ab(1),n.fc("ngIf",i.id===t.creador._id)}}function N(t,i){if(1&t){const t=n.Pb();n.Ob(0,"div",7),n.Zb(1,"colores"),n.Ob(2,"div",8),n.Wb("click",function(){n.pc(t);const e=i.index,s=n.Yb().index;return n.Yb(2).siguiente(s,e)}),n.Nb(),n.Ob(3,"div",9),n.Wb("click",function(){n.pc(t);const e=i.index,s=n.Yb().index;return n.Yb(2).anterior(s,e)}),n.Nb(),n.Ob(4,"div",10),n.Ob(5,"div",11),n.Ob(6,"ion-avatar"),n.Mb(7,"img",12),n.Nb(),n.Ob(8,"div",13),n.Ob(9,"span"),n.wc(10),n.Nb(),n.Mb(11,"br"),n.Ob(12,"strong"),n.wc(13),n.Nb(),n.Nb(),n.Nb(),n.Ob(14,"ion-buttons"),n.Ob(15,"ion-button",14),n.Wb("click",function(){n.pc(t);const e=i.index,s=n.Yb().index;return n.Yb(2).cerrar(s,e)}),n.Mb(16,"ion-icon",15),n.Nb(),n.vc(17,u,2,0,"ion-button",16),n.Nb(),n.Nb(),n.vc(18,m,3,1,"div",17),n.vc(19,v,1,1,"img",18),n.vc(20,O,3,0,"div",19),n.vc(21,_,7,3,"div",20),n.Nb()}if(2&t){const t=i.$implicit,e=n.Yb().$implicit,s=n.Yb(2);n.sc(n.ac(1,17,t)),n.Db("one",1===e.length)("ocultar",t.vista)("mostrar",!t.vista),n.Ab(7),n.gc("src",e[0].image,n.qc),n.Ab(3),n.xc(s.info.nombre),n.Ab(3),n.yc("@",s.info.usuario,""),n.Ab(4),n.fc("ngIf",s.id===t.creador._id),n.Ab(1),n.fc("ngIf","dibujar"===t.tipo),n.Ab(1),n.fc("ngIf","multimedia"===t.tipo),n.Ab(1),n.fc("ngIf",""!==t.comentario||t.etiquetas.length>0||s.id===t.creador._id),n.Ab(1),n.fc("ngIf",t.etiqueta)}}function $(t,i){if(1&t&&(n.Ob(0,"ion-slide",5),n.vc(1,N,22,19,"div",6),n.Nb()),2&t){const t=i.$implicit;n.Ab(1),n.fc("ngForOf",t)}}function k(t,i){if(1&t&&(n.Ob(0,"ion-slides",2,3),n.vc(2,$,2,1,"ion-slide",4),n.Nb()),2&t){const t=n.Yb();n.fc("options",t.slideopts),n.Ab(2),n.fc("ngForOf",t.historiasbase)}}let y=(()=>{class t{constructor(t,i,e,s,n,o,a){this.modalCtrl=t,this.statusbar=i,this.router=e,this.almacenamiento=s,this.IGTMApi=n,this.toast=o,this.popover=a,this.ht=["fsdf","asdfasf","asfas"],this.slideopts={grabCursor:!0,cubeEffect:{shadow:!0,slideShadows:!0,shadowOffset:20,shadowScale:.94},on:{beforeInit:function(){const t=this;t.classNames.push(`${t.params.containerModifierClass}cube`),t.classNames.push(`${t.params.containerModifierClass}3d`);const i={slidesPerView:1,slidesPerColumn:1,slidesPerGroup:1,watchSlidesProgress:!0,resistanceRatio:0,spaceBetween:0,centeredSlides:!1,virtualTranslate:!0};this.params=Object.assign(this.params,i),this.originalParams=Object.assign(this.originalParams,i)},setTranslate:function(){const t=this,{$el:i,$wrapperEl:e,slides:s,width:n,height:o,rtlTranslate:a,size:c}=t,r=t.params.cubeEffect,d=t.isHorizontal(),l=t.virtual&&t.params.virtual.enabled;let b,h=0;r.shadow&&(d?(b=e.find(".swiper-cube-shadow"),0===b.length&&(b=t.$('<div class="swiper-cube-shadow"></div>'),e.append(b)),b.css({height:`${n}px`})):(b=i.find(".swiper-cube-shadow"),0===b.length&&(b=t.$('<div class="swiper-cube-shadow"></div>'),i.append(b))));for(let p=0;p<s.length;p+=1){const i=s.eq(p);let e=p;l&&(e=parseInt(i.attr("data-swiper-slide-index"),10));let n=90*e,o=Math.floor(n/360);a&&(n=-n,o=Math.floor(-n/360));const b=Math.max(Math.min(i[0].progress,1),-1);let f=0,g=0,u=0;e%4==0?(f=4*-o*c,u=0):(e-1)%4==0?(f=0,u=4*-o*c):(e-2)%4==0?(f=c+4*o*c,u=c):(e-3)%4==0&&(f=-c,u=3*c+4*c*o),a&&(f=-f),d||(g=f,f=0);const m=`rotateX(${d?0:-n}deg) rotateY(${d?n:0}deg) translate3d(${f}px, ${g}px, ${u}px)`;if(b<=1&&b>-1&&(h=90*e+90*b,a&&(h=90*-e-90*b)),i.transform(m),r.slideShadows){let e=i.find(d?".swiper-slide-shadow-left":".swiper-slide-shadow-top"),s=i.find(d?".swiper-slide-shadow-right":".swiper-slide-shadow-bottom");0===e.length&&(e=t.$(`<div class="swiper-slide-shadow-${d?"left":"top"}"></div>`),i.append(e)),0===s.length&&(s=t.$(`<div class="swiper-slide-shadow-${d?"right":"bottom"}"></div>`),i.append(s)),e.length&&(e[0].style.opacity=Math.max(-b,0)),s.length&&(s[0].style.opacity=Math.max(b,0))}}if(e.css({"-webkit-transform-origin":`50% 50% -${c/2}px`,"-moz-transform-origin":`50% 50% -${c/2}px`,"-ms-transform-origin":`50% 50% -${c/2}px`,"transform-origin":`50% 50% -${c/2}px`}),r.shadow)if(d)b.transform(`translate3d(0px, ${n/2+r.shadowOffset}px, ${-n/2}px) rotateX(90deg) rotateZ(0deg) scale(${r.shadowScale})`);else{const t=Math.abs(h)-90*Math.floor(Math.abs(h)/90),i=1.5-(Math.sin(2*t*Math.PI/360)/2+Math.cos(2*t*Math.PI/360)/2),e=r.shadowScale/i;b.transform(`scale3d(${r.shadowScale}, 1, ${e}) translate3d(0px, ${o/2+r.shadowOffset}px, ${-o/2/e}px) rotateX(-90deg)`)}e.transform(`translate3d(0px,0,${t.browser.isSafari||t.browser.isUiWebView?-c/2:0}px) rotateX(${t.isHorizontal()?0:h}deg) rotateY(${t.isHorizontal()?-h:0}deg)`)},setTransition:function(t){const i=this,{$el:e,slides:s}=i;s.transition(t).find(".swiper-slide-shadow-top, .swiper-slide-shadow-right, .swiper-slide-shadow-bottom, .swiper-slide-shadow-left").transition(t),i.params.cubeEffect.shadow&&!i.isHorizontal()&&e.find(".swiper-cube-shadow").transition(t)}}},this.opt={direction:"vertical"},this.historiasbase=[],this.estilos="",this.cargo=!0,this.id=""}ngOnInit(){}ionViewWillEnter(){return Object(s.a)(this,void 0,void 0,function*(){const t=yield this.almacenamiento.obtenerToken();t&&(this.id=t._id,this.historiasbase=this.historias,this.historiasbase.forEach(i=>{let e=!1;i.forEach(i=>{i.vistos.filter(i=>i._id===t._id).length>0||e?i.vista=!0:(i.vista=!1,e=!0)}),0===i.filter(t=>!1===t.vista).length&&(i[0].vista=!1)}),console.log(this.historias,this.info),this.miSlide.slideTo(this.info.idx,0).then(()=>{}))})}saludar(t,i){}opciones(t,i,e){return Object(s.a)(this,void 0,void 0,function*(){const s=yield this.popover.create({component:d,componentProps:{id:this.historiasbase[i][e]._id},event:t});yield s.present();const n=yield s.onWillDismiss();n&&n.data&&n.data.exe&&(this.toast.toastExitoso("Historia eliminada"),this.historiasbase[i].splice(e,1),this.modalCtrl.dismiss())})}siguiente(t,i){return Object(s.a)(this,void 0,void 0,function*(){if(i===this.historiasbase[t].length-1)t===this.historiasbase.length-1?this.modalCtrl.dismiss():this.miSlide.slideNext().then(()=>{if(this.historiasbase[t+1]){let i=this.historiasbase[t+1].findIndex(t=>!1===t.vista);i>0&&this.vistos(this.historiasbase[t+1][i]._id)}});else{this.historiasbase[t][i].vista=!0,this.historiasbase[t][i+1].vista=!1;const e=yield this.almacenamiento.obtenerToken();e&&0===this.historiasbase[t][i].vistos.filter(t=>t._id===e._id).length&&this.vistos(this.historiasbase[t][i]._id),this.vistos(this.historiasbase[t][i+1]._id)}})}anterior(t,i){return Object(s.a)(this,void 0,void 0,function*(){0===i?0===t?this.modalCtrl.dismiss():this.miSlide.slidePrev().then(()=>{if(this.historiasbase[t-1]){let i=this.historiasbase[t-1].findIndex(t=>!1===t.vista);i>0&&this.vistos(this.historiasbase[t-1][i]._id)}}):(this.historiasbase[t][i].vista=!0,this.historiasbase[t][i-1].vista=!1)})}rotar(){this.miSlide.getActiveIndex().then(t=>{this.slide.getActiveIndex().then(i=>{this.vistos(this.historiasbase[t][i]._id)})})}vistos(t){return Object(s.a)(this,void 0,void 0,function*(){const i=yield this.almacenamiento.obtenerToken();i&&this.IGTMApi.vistos(i.token,{id:t}).subscribe(t=>{},t=>{})})}cerrar(t,i){this.vistos(this.historiasbase[t][i]._id),this.modalCtrl.dismiss(),this.historias=[],this.info={}}cambio(t,i){this.slide.getActiveIndex().then(t=>{})}ver(t){}abrir(t,i){this.historias[t][i].etiqueta=!0}cerrar2(t,i){this.historias[t][i].etiqueta=!1}perfilNavegar(t){this.modalCtrl.dismiss(),this.router.navigate(["/visita/",t,"s"])}ionViewWillLeave(){}}return t.\u0275fac=function(i){return new(i||t)(n.Lb(a.qb),n.Lb(l.a),n.Lb(b.g),n.Lb(o.a),n.Lb(r.a),n.Lb(c.a),n.Lb(a.ub))},t.\u0275cmp=n.Fb({type:t,selectors:[["app-historias-modal"]],viewQuery:function(t,i){if(1&t&&(n.Ac(f,1),n.Ac(g,1)),2&t){let t;n.oc(t=n.Xb())&&(i.slide=t.first),n.oc(t=n.Xb())&&(i.miSlide=t.first)}},inputs:{info:"info",historias:"historias"},decls:2,vars:1,consts:[["color","darkgold"],[3,"options",4,"ngIf"],[3,"options"],["miSlide",""],["class","red",4,"ngFor","ngForOf"],[1,"red"],["class"," divhistoria",3,"one","ocultar","mostrar","style",4,"ngFor","ngForOf"],[1,"divhistoria"],[1,"derecha",3,"click"],[1,"izquierda",3,"click"],[1,"encabezado"],[1,"data"],["alt","",3,"src"],[1,"titulo"],[3,"click"],["slot","icon-only","name","close"],[3,"click",4,"ngIf"],["class","texto",4,"ngIf"],["alt","",3,"src",4,"ngIf"],["class","pie",4,"ngIf"],["class","etiquetados",4,"ngIf"],["slot","icon-only","name","ellipsis-vertical"],[1,"texto"],[1,"pie"],[1,"data",3,"click"],[1,"etiquetados"],[1,"dataa"],[1,"cerrarr",3,"click"],["class","com",4,"ngIf"],[4,"ngIf"],[1,"com"],[1,"cc"],["color","oscuro",3,"click",4,"ngFor","ngForOf"],["color","oscuro",3,"click"],["slot","start"],[3,"src"]],template:function(t,i){1&t&&(n.Ob(0,"ion-content",0),n.vc(1,k,3,2,"ion-slides",1),n.Nb()),2&t&&(n.Ab(1),n.fc("ngIf",i.cargo))},directives:[a.t,h.j,a.bb,h.i,a.ab,a.f,a.k,a.j,a.A,a.L,a.G,a.F,a.K],pipes:[p],styles:[".contenedor[_ngcontent-%COMP%]{width:100%;min-height:100vh;height:auto}.encabezado[_ngcontent-%COMP%]{padding:5px 10px;top:0;touch-action:auto!important}.encabezado[_ngcontent-%COMP%], .pie[_ngcontent-%COMP%]{width:100%;position:absolute;left:0;font-size:20px;display:flex;justify-content:space-between;align-items:center;z-index:10}.pie[_ngcontent-%COMP%]{bottom:0}.pie[_ngcontent-%COMP%]   .data[_ngcontent-%COMP%]{width:150px;background:#333;color:#fff!important;text-align:center;padding:5px 10px;font-size:14px}.encabezado[_ngcontent-%COMP%]   .data[_ngcontent-%COMP%]{width:80%;display:flex;align-items:center}.encabezado[_ngcontent-%COMP%]   .data[_ngcontent-%COMP%]   .titulo[_ngcontent-%COMP%]{padding-left:10px;text-align:left}.encabezado[_ngcontent-%COMP%]   .data[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:14px;font-weight:400}.encabezado[_ngcontent-%COMP%]   .data[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{font-size:12px}ion-slides[_ngcontent-%COMP%]{width:100%;min-height:100vh;height:auto}ion-slide[_ngcontent-%COMP%]{width:100%;height:100%}ion-slide[_ngcontent-%COMP%]   ion-slides[_ngcontent-%COMP%]{width:100%;height:100vh}.one[_ngcontent-%COMP%]{height:100vh!important}.sl[_ngcontent-%COMP%]{min-height:100%;height:auto;max-width:600px;margin:auto;height:100%;position:relative}.sl[_ngcontent-%COMP%], .sl[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%}.texto[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:22px;word-wrap:break-word;white-space:pre-wrap;font-weight:700}.etiquetados[_ngcontent-%COMP%]{width:100%;height:100%;padding:5px 10px;position:absolute;top:0;left:0;font-size:20px;z-index:20}.etiquetados[_ngcontent-%COMP%], .etiquetados[_ngcontent-%COMP%]   ion-list[_ngcontent-%COMP%]{background:#3b4b54}.etiquetados[_ngcontent-%COMP%]   .dataa[_ngcontent-%COMP%]{position:relative;width:100%;height:100%}.etiquetados[_ngcontent-%COMP%]   .dataa[_ngcontent-%COMP%]   .cerrarr[_ngcontent-%COMP%]{text-align:right;color:#fff;z-index:30;font-size:18px;padding:5px}.etiquetados[_ngcontent-%COMP%]   .dataa[_ngcontent-%COMP%]   .com[_ngcontent-%COMP%]{margin-top:50px;color:#fff;font-size:16px;padding:10px}.cc[_ngcontent-%COMP%]{background:#536169;color:#ccc}.divhistoria[_ngcontent-%COMP%]{width:100%;height:100vh;position:relative}.derecha[_ngcontent-%COMP%]{right:0;width:calc(100% - 100px)}.derecha[_ngcontent-%COMP%], .izquierda[_ngcontent-%COMP%]{position:absolute;top:0;height:100%}.izquierda[_ngcontent-%COMP%]{left:0;width:100px}.ocultar[_ngcontent-%COMP%]{display:none}.mostrar[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center}ion-avatar[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:70px;height:70px;border-radius:100%}"]}),t})()},"Qv/D":function(t,i,e){"use strict";e.r(i),e.d(i,"HistoriasModalPageModule",function(){return h});var s=e("ofXK"),n=e("3Pt+"),o=e("TEn/"),a=e("tyNb"),c=e("4kKk"),r=e("fXoL");const d=[{path:"",component:c.a}];let l=(()=>{class t{}return t.\u0275fac=function(i){return new(i||t)},t.\u0275mod=r.Jb({type:t}),t.\u0275inj=r.Ib({imports:[[a.j.forChild(d)],a.j]}),t})();var b=e("iTUp");let h=(()=>{class t{}return t.\u0275fac=function(i){return new(i||t)},t.\u0275mod=r.Jb({type:t}),t.\u0275inj=r.Ib({imports:[[s.b,n.e,o.mb,l,b.a]]}),t})()}}]);