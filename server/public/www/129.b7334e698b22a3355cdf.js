(window.webpackJsonp=window.webpackJsonp||[]).push([[129],{glMB:function(t,e,n){"use strict";n.r(e),n.d(e,"TiendaInitPageModule",function(){return M});var o=n("ofXK"),a=n("3Pt+"),i=n("TEn/"),r=n("tyNb"),s=n("mrSG"),c=n("HDdC"),d=n("R0Ic"),b=n("fXoL"),l=n("fmoy"),p=n("8A7y"),h=n("fsfq"),m=n("FlrC"),g=n("7JkF"),O=n("LPYB");function f(t,e){if(1&t&&(b.Ob(0,"div",13),b.Mb(1,"img",14),b.Ob(2,"div",15),b.Ob(3,"span"),b.wc(4),b.Nb(),b.Mb(5,"br"),b.Ob(6,"span"),b.wc(7),b.Nb(),b.Nb(),b.Nb()),2&t){const t=e.$implicit;b.Ab(1),b.hc("src","https:www.motocaliapp.com/tienda/",t.imagen,"",b.qc),b.Ab(3),b.xc(t.nombre),b.Ab(3),b.yc("Cantidad ",t.cantidad,"")}}function u(t,e){if(1&t&&(b.Ob(0,"ion-item",10),b.Ob(1,"ion-label"),b.Ob(2,"div",11),b.vc(3,f,8,3,"div",12),b.Nb(),b.Mb(4,"br"),b.Ob(5,"div"),b.Ob(6,"strong"),b.wc(7,"Cliente: "),b.Nb(),b.wc(8),b.Nb(),b.Ob(9,"div"),b.Ob(10,"strong"),b.wc(11,"Tel\xe8fono: "),b.Nb(),b.wc(12),b.Nb(),b.Ob(13,"div"),b.wc(14),b.Nb(),b.Nb(),b.Nb()),2&t){const t=e.$implicit;b.fc("@entrada",t.nuevo?"nuevo":""),b.Ab(3),b.fc("ngForOf",t.productos),b.Ab(5),b.yc(" ",t.creador.nombrecompleto,""),b.Ab(4),b.yc(" ",t.creador.tel,""),b.Ab(2),b.xc(t.tipo)}}function C(t,e){if(1&t&&(b.Ob(0,"div",4),b.Ob(1,"div",5),b.Ob(2,"h3",6),b.wc(3,"Ultimos pedidos"),b.Nb(),b.vc(4,u,15,5,"ion-item",7),b.Nb(),b.Ob(5,"div",8),b.Mb(6,"canvas",9),b.Nb(),b.Nb()),2&t){const t=b.Yb();b.Ab(1),b.fc("@animated",void 0),b.Ab(3),b.fc("ngForOf",t.pedidos),b.Ab(2),b.fc("datasets",t.chartData)("labels",t.chartLabels)("options",t.chartOptions)("colors",t.chartColors)("legend",t.showLegend)("chartType",t.chartType)}}const j=[{path:"",component:(()=>{class t{constructor(t,e,n,o,a,i,r,s){this.menuCtrl=t,this.toast=e,this.empresa=n,this.activeRoute=o,this.almacenamiento=a,this.router=i,this.entrada=r,this.socket=s,this.chartData=[{data:[],label:""}],this.chartData2=[{data:[],label:""}],this.chartOptions={responsive:!0,title:{display:!0,text:"Total de Movimientos en inventario"},zoom:{enabled:!0,mode:"xy"}},this.chartColors=[{borderColor:"#000000",backgroundColor:["#FD8A24","#333333"]}],this.chartType="pie",this.showLegend=!0,this.chartColors2=[{borderColor:"#000000",backgroundColor:"#FAD60F"}],this.chartOptions2={responsive:!0,title:{display:!0,text:"Productos con m\xe1s salidas"},scales:{xAxes:[{gridLines:{color:"rgba(171,171,171,1)",lineWidth:1}}],yAxes:[{ticks:{beginAtZero:!0,min:0}}]}},this.chartType2="bar",this.showLegend2=!0,this.color="danger",this.id="",this.nombre="",this.load=!1,this.pedidos=[],this.escucharPedidos().subscribe(t=>{console.log(t,"data del socket"),new Audio("/assets/nuevo-mensaje.mp3").play(),t.body.nuevo=!0,this.pedidos.unshift(t.body),this.recargarGraficas()})}ngOnInit(){}ionViewWillEnter(){this.menuCtrl.enable(!1,"perfil"),this.menuCtrl.enable(!1,"panel"),this.menuCtrl.enable(!0,"tienda"),this.id=this.activeRoute.snapshot.paramMap.get("id"),this.entrada.Tienda(this.id),this.pedidosConsultar(),this.tienda()}tienda(){return Object(s.a)(this,void 0,void 0,function*(){const t=yield this.almacenamiento.obtenerToken();t&&this.empresa.miTienda(t.token,{id:this.id}).subscribe(t=>{t.exe?t.response.length>0?this.nombre=t.response[0].nombre:this.router.navigate(["/tienda/error"]):(this.router.navigate(["/tienda/error"]),this.toast.toastError("No se pudo traer la informaci\xf2n de la tiebda, int\xe8ntelo m\xe0s tarde")),this.load=!0},t=>{this.router.navigate(["/tienda/error"]),this.toast.toastError("No se pudo traer la informaci\xf2n de la tienda, int\xe8ntelo m\xe0s tarde")})})}recargarGraficas(){this.chartLabels=["Pendientes  - "+this.pedidos.length,"Procesados  - 3"],this.chartData[0].data=[this.pedidos.length,3]}pedidosConsultar(){return Object(s.a)(this,void 0,void 0,function*(){const t=yield this.almacenamiento.obtenerToken();t&&this.empresa.consultarPedidos(t.token).subscribe(t=>{t.exe?(this.pedidos=t.response,this.recargarGraficas()):(this.router.navigate(["/tienda/error"]),this.toast.toastError("No se pudo traer la informaci\xf2n de la tiebda, int\xe8ntelo m\xe0s tarde")),this.load=!0},t=>{this.router.navigate(["/tienda/error"]),this.toast.toastError("No se pudo traer la informaci\xf2n de la tienda, int\xe8ntelo m\xe0s tarde")})})}escucharPedidos(){return new c.a(t=>{this.socket.on("pedidostienda",e=>{t.next(e)})})}eliminar(t,e){}}return t.\u0275fac=function(e){return new(e||t)(b.Lb(i.pb),b.Lb(l.a),b.Lb(p.a),b.Lb(r.a),b.Lb(h.a),b.Lb(r.g),b.Lb(m.a),b.Lb(g.a))},t.\u0275cmp=b.Fb({type:t,selectors:[["app-tienda-init"]],decls:7,vars:3,consts:[[3,"color"],["slot","start","defaultHref","/panel/tienda-inicio","icon","chevron-back-outline"],[1,"ion-padding"],["class","padre",4,"ngIf"],[1,"padre"],[1,"tarjeta"],[1,"tit"],["mode","ios","lines","none","class","tienda sinfondo",4,"ngFor","ngForOf"],[1,"tarjeta","grafica"],["baseChart","",3,"datasets","labels","options","colors","legend","chartType"],["mode","ios","lines","none",1,"tienda","sinfondo"],[1,"prods"],["class","prod",4,"ngFor","ngForOf"],[1,"prod"],[3,"src"],[1,"info"]],template:function(t,e){1&t&&(b.Ob(0,"ion-header"),b.Ob(1,"ion-toolbar",0),b.Mb(2,"ion-back-button",1),b.Ob(3,"ion-title"),b.wc(4),b.Nb(),b.Nb(),b.Nb(),b.Ob(5,"ion-content",2),b.vc(6,C,7,8,"div",3),b.Nb()),2&t&&(b.Ab(1),b.fc("color",e.color),b.Ab(3),b.xc(e.nombre),b.Ab(2),b.fc("ngIf",e.pedidos.length>0))},directives:[i.z,i.lb,i.g,i.h,i.jb,i.t,o.j,o.i,O.a,i.F,i.K],styles:[".padre[_ngcontent-%COMP%]{margin:20px auto;box-shadow:0 2px 30px 1px rgba(0,0,0,.1);width:100%;display:flex}.padre[_ngcontent-%COMP%]   .tarjeta[_ngcontent-%COMP%]{width:50%;padding:20px;animation:entrada 1s ease-in-out;margin-bottom:100px}.padre[_ngcontent-%COMP%]   .tarjeta[_ngcontent-%COMP%]   .tit[_ngcontent-%COMP%]{padding:8px}.padre[_ngcontent-%COMP%]   .tarjeta[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]{margin-bottom:10px;border-bottom:1px solid rgba(0,0,0,.3)}.padre[_ngcontent-%COMP%]   .tarjeta[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]   .prods[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap}.padre[_ngcontent-%COMP%]   .tarjeta[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]   .prods[_ngcontent-%COMP%]   .prod[_ngcontent-%COMP%]{display:flex;width:calc(50% - 20px);margin:10px;align-items:center}.padre[_ngcontent-%COMP%]   .tarjeta[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]   .prods[_ngcontent-%COMP%]   .prod[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{margin:0 10px;width:35px}.padre[_ngcontent-%COMP%]   .tarjeta[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]   .titulo[_ngcontent-%COMP%]{font-size:18px;padding:8px}.padre[_ngcontent-%COMP%]   .grafica[_ngcontent-%COMP%]{background:#f1f1f1}.tarjeta[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]:nth-child(2n){--background:#fafafa}@keyframes entrada{0%{opacity:0;transform:scale(0)}to{opacity:1;transform:scale(1)}}"],data:{animation:[Object(d.m)("animated",[Object(d.l)(":enter",[Object(d.g)("ion-item",[Object(d.k)({opacity:0,transform:"translateY(-100px)"}),Object(d.i)(-100,[Object(d.e)("500ms cubic-bezier(0.35, 0, 0.5, 1)",Object(d.k)({opacity:1,transform:"none"}))])])]),Object(d.l)(":leave",[Object(d.g)("ion-item",[Object(d.k)({opacity:1,transform:"none"}),Object(d.i)(-100,[Object(d.e)("500ms ease-in-out",Object(d.k)({opacity:0,transform:"translateY(-100px)"}))])])])]),Object(d.m)("entrada",[Object(d.j)("nuevo",Object(d.k)({opacity:1,transform:"none"})),Object(d.l)("* => nuevo",[Object(d.k)({opacity:0,transform:"scale(1)"}),Object(d.e)("800ms ease-in-out")]),Object(d.l)(":leave",[Object(d.k)({opacity:1,transform:"none"}),Object(d.e)("500ms ease-in-out",Object(d.k)({opacity:0,transform:"translateY(-100px)"}))])])]}}),t})()}];let v=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=b.Jb({type:t}),t.\u0275inj=b.Ib({imports:[[r.j.forChild(j)],r.j]}),t})(),M=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=b.Jb({type:t}),t.\u0275inj=b.Ib({imports:[[o.b,a.e,i.mb,v,O.b]]}),t})()}}]);