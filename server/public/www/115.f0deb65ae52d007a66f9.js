(window.webpackJsonp=window.webpackJsonp||[]).push([[115],{"1XrT":function(t,i,e){"use strict";e.r(i),e.d(i,"PedidosInicioPageModule",function(){return P});var o=e("ofXK"),n=e("3Pt+"),s=e("TEn/"),a=e("tyNb"),r=e("mrSG"),c=e("ypew"),d=e("fXoL"),l=e("fsfq"),b=e("fmoy"),p=e("HavB"),u=e("SpuA");function h(t,i){if(1&t&&(d.Mb(0,"div",8),d.Kb(1,"ion-spinner",9),d.Mb(2,"div"),d.rc(3," Cargando pedidos... "),d.Kb(4,"br"),d.Mb(5,"strong"),d.rc(6),d.Lb(),d.Lb(),d.Lb()),2&t){const t=d.Wb();d.zb(6),d.tc(" ",t.usuario,"")}}function f(t,i){1&t&&(d.Mb(0,"div",8),d.Mb(1,"div",12),d.Kb(2,"img",13),d.Kb(3,"br"),d.rc(4," A\xfan no tiene pedidos creados "),d.Kb(5,"br"),d.Lb(),d.Lb())}function g(t,i){if(1&t&&(d.Mb(0,"strong"),d.rc(1),d.Lb()),2&t){const t=d.Wb().$implicit;d.zb(1),d.tc("Solicitado por ",t.creador.nombrecompleto,"")}}function m(t,i){if(1&t&&(d.Mb(0,"strong"),d.rc(1),d.Lb()),2&t){const t=d.Wb().$implicit;d.zb(1),d.tc("Solicitado a ",t.taller.nombrecompleto,"")}}function v(t,i){1&t&&(d.Mb(0,"div",27),d.Kb(1,"ion-spinner",28),d.rc(2," Cargando Chat..."),d.Lb())}function M(t,i){if(1&t){const t=d.Nb();d.Mb(0,"ion-item-option",29),d.Ub("click",function(){d.lc(t);const i=d.Wb().$implicit;return d.Wb(3).agregar(i)}),d.Kb(1,"ion-icon",30),d.Lb()}}function L(t,i){if(1&t){const t=d.Nb();d.Mb(0,"ion-item-sliding"),d.Mb(1,"ion-item",16),d.Ub("click",function(){d.lc(t);const e=i.$implicit;return d.Wb(3).info(e._id)}),d.Mb(2,"ion-avatar",17),d.Kb(3,"img",18),d.Lb(),d.Mb(4,"ion-label",19),d.qc(5,g,2,1,"strong",6),d.qc(6,m,2,1,"strong",6),d.Mb(7,"div"),d.rc(8),d.Xb(9,"cambioUTC"),d.Lb(),d.qc(10,v,3,0,"div",20),d.Lb(),d.Lb(),d.Mb(11,"ion-item-options",21),d.qc(12,M,2,0,"ion-item-option",22),d.Mb(13,"ion-item-option",23),d.Ub("click",function(){d.lc(t);const e=i.$implicit,o=i.index;return d.Wb(3).navegar(e._id,o)}),d.Kb(14,"ion-icon",24),d.Lb(),d.Mb(15,"ion-item-option",25),d.Ub("click",function(){d.lc(t);const e=i.$implicit;return d.Wb(3).quitar(e._id)}),d.Kb(16,"ion-icon",26),d.Lb(),d.Lb(),d.Lb()}if(2&t){const t=i.$implicit,e=d.Wb(3);d.zb(5),d.dc("ngIf",t.creador._id!==e.id),d.zb(1),d.dc("ngIf",t.creador._id===e.id),d.zb(2),d.tc("Fecha ",d.Yb(9,5,t.fecha),""),d.zb(2),d.dc("ngIf",t.chat),d.zb(2),d.dc("ngIf",e.id===t.taller._id)}}function y(t,i){if(1&t&&(d.Mb(0,"div",14),d.Mb(1,"ion-list"),d.qc(2,L,17,7,"ion-item-sliding",15),d.Lb(),d.Lb()),2&t){const t=d.Wb(2);d.zb(2),d.dc("ngForOf",t.pedidos)}}function x(t,i){if(1&t&&(d.Mb(0,"div"),d.qc(1,f,6,0,"div",10),d.qc(2,y,3,1,"div",11),d.Lb()),2&t){const t=d.Wb();d.zb(1),d.dc("ngIf",0===t.pedidos.length),d.zb(1),d.dc("ngIf",t.pedidos.length>0)}}function z(t,i){if(1&t){const t=d.Nb();d.Mb(0,"ion-fab",31),d.Mb(1,"ion-fab-button",32),d.Ub("click",function(){return d.lc(t),d.Wb().crear()}),d.Kb(2,"ion-icon",33),d.Lb(),d.Lb()}}const k=[{path:"",component:(()=>{class t{constructor(t,i,e,o,n,s){this.router=t,this.alert=i,this.almacenamiento=e,this.toast=o,this.apiPedidos=n,this.modal=s,this.configurando=!1,this.usuario="",this.habilitado=!1,this.cargado=!1,this.id="",this.pedidos=[],this.role=""}ngOnInit(){}ionViewWillEnter(){this.pedidosListar()}refrescando(t){this.pedidosListar().then(()=>{t.detail.complete()}).catch(()=>{t.detail.complete()})}pedidosListar(){return Object(r.a)(this,void 0,void 0,function*(){const t=yield this.almacenamiento.obtenerToken();t&&(this.role=t.role,this.id=t._id,this.usuario=t.nombre,this.apiPedidos.misPedido(t.token).subscribe(t=>{console.log(t),t.exe?this.pedidos=t.response:(this.toast.toastError("No se pudo consultar los pedidos, int\xe9ntelo m\xe1s tarde"),this.router.navigate(["/central/menu/"])),this.cargado=!0},t=>{this.toast.toastError("No se pudo consultar los pedidos, int\xe9ntelo m\xe1s tarde"),this.router.navigate(["/central/menu/"])}))})}crear(){return Object(r.a)(this,void 0,void 0,function*(){const t=yield this.alert.create({header:"Crear Pedido",message:"Los pedidos puedes realizarlos para comprar los repuestos o productos que necesites para tu veh\xedculo.",buttons:[{text:"Cancelar",cssClass:"cancelarAlerta",role:"cancel",handler:()=>{}},{text:"Crear",cssClass:"botonalerta",handler:t=>{this.router.navigate(["/central/menu/control-mapas"])}}]});yield t.present()})}navegar(t,i){return Object(r.a)(this,void 0,void 0,function*(){this.pedidos[i].chat=!0;const e=yield this.almacenamiento.obtenerToken();e&&this.apiPedidos.consultarSala(e.token,{pedido:t}).subscribe(t=>{t.exe?(t.response.length>0?this.almacenamiento.insertarChat(t.response[0]).then(()=>{this.router.navigate(["/central/chats/chat"]),this.pedidos[i].chat=!1}).catch(()=>{this.pedidos[i].chat=!1,this.toast.toastError("No se puede acceder al chat, int\xe9ntelo m\xe1s tarde")}):(this.pedidos[i].chat=!1,this.toast.toastError("No se puede acceder al chat, int\xe9ntelo m\xe1s tarde")),this.pedidos[i].chat=!1):(this.toast.toastError("No se puede acceder al chat, int\xe9ntelo m\xe1s tarde"),this.pedidos[i].chat=!1)},t=>{this.pedidos[i].chat=!1,this.toast.toastError("No se puede acceder al chat, int\xe9ntelo m\xe1s tarde")})})}info(t){this.router.navigate(["/central/pedidos/info",t])}agregar(t){return Object(r.a)(this,void 0,void 0,function*(){const i=yield this.modal.create({component:c.a,componentProps:{pedido:t}});yield i.present()})}quitar(t){return Object(r.a)(this,void 0,void 0,function*(){const i=yield this.alert.create({header:"Atenci\xf3n!",message:"\xbfEstas seguro de abandonar esta sala? No podras visualizar de nuevo la  informaci\xf3n dentro de ella",buttons:[{text:"Cancelar",cssClass:"cancelarAlerta",role:"cancel",handler:()=>{}},{text:"Salir",cssClass:"botonalerta",handler:()=>Object(r.a)(this,void 0,void 0,function*(){const i=yield this.almacenamiento.obtenerToken();if(i){let e=this.pedidos.filter(i=>i._id===t)[0].accesos;e=e.map(t=>t._id),e=e.filter(t=>t!==i._id),console.log(e),this.apiPedidos.editarPedido(i.token,{id:t,accesos:e}).subscribe(t=>{t.exe?(this.toast.Especial("Saliste de la sala"),this.pedidosListar()):this.toast.toastError("No se pudo realizar la petici\xf3n, int\xe9ntelo m\xe1s tarde")},t=>{this.toast.toastError("No se pudo realizar la petici\xf3n, int\xe9ntelo m\xe1s tarde")})}})}]});yield i.present()})}}return t.\u0275fac=function(i){return new(i||t)(d.Jb(a.g),d.Jb(s.b),d.Jb(l.a),d.Jb(b.a),d.Jb(p.a),d.Jb(s.ob))},t.\u0275cmp=d.Db({type:t,selectors:[["app-pedidos-inicio"]],decls:12,vars:3,consts:[["color","oscuro"],["slot","start","icon","chevron-back-outline","defaultHref","/central/menu"],["slot","fixed","pullFactor","0.5","pullMin","50","pullMax","150",3,"ionRefresh"],["pullingIcon","arrow-dropdown","refreshingSpinner","circles"],["class","flcenter ion-padding",4,"ngIf"],[1,"divider","light"],[4,"ngIf"],["vertical","bottom","horizontal","end","slot","fixed",4,"ngIf"],[1,"flcenter","ion-padding"],["name","crescent","color","oscuro"],["class","flcenter ion-padding ",4,"ngIf"],["class"," ",4,"ngIf"],[1,"ct"],["src","/assets/Citas.png","width","80px","alt",""],[1,""],[4,"ngFor","ngForOf"],[3,"click"],["slot","start"],["src","/assets/Estados.png"],[1,"ion-text-wrap"],["class","carga",4,"ngIf"],["side","end"],["color","barra",3,"click",4,"ngIf"],["color","primary",3,"click"],["name","chatbubble-outline","slot","icon-only"],["color","danger",3,"click"],["name","trash-outline","slot","icon-only"],[1,"carga"],["name","crescent"],["color","barra",3,"click"],["name","add-outline","slot","icon-only"],["vertical","bottom","horizontal","end","slot","fixed"],["color","oscuro",3,"click"],["name","add"]],template:function(t,i){1&t&&(d.Mb(0,"ion-header"),d.Mb(1,"ion-toolbar",0),d.Kb(2,"ion-back-button",1),d.Mb(3,"ion-title"),d.rc(4,"Pedidos"),d.Lb(),d.Lb(),d.Lb(),d.Mb(5,"ion-content"),d.Mb(6,"ion-refresher",2),d.Ub("ionRefresh",function(t){return i.refrescando(t)}),d.Kb(7,"ion-refresher-content",3),d.Lb(),d.qc(8,h,7,1,"div",4),d.Kb(9,"div",5),d.qc(10,x,3,2,"div",6),d.qc(11,z,3,0,"ion-fab",7),d.Lb()),2&t&&(d.zb(8),d.dc("ngIf",!i.cargado),d.zb(2),d.dc("ngIf",i.cargado),d.zb(1),d.dc("ngIf","USER_ROLE"===i.role))},directives:[s.z,s.jb,s.g,s.h,s.hb,s.t,s.P,s.Q,o.j,s.bb,s.L,o.i,s.J,s.F,s.f,s.K,s.I,s.H,s.A,s.v,s.w],pipes:[u.a],styles:[".flcenter[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;align-items:center;font-size:20px;text-align:center}ion-card[_ngcontent-%COMP%]{position:relative}.carga[_ngcontent-%COMP%], .ct[_ngcontent-%COMP%]{display:flex;align-items:center}.ct[_ngcontent-%COMP%]{flex-direction:column;justify-content:center;font-size:20px;font-weight:300}.msg[_ngcontent-%COMP%]{position:absolute;top:0;right:0;text-align:center;padding:5px 10px;border-radius:10px}"]}),t})()}];let C=(()=>{class t{}return t.\u0275mod=d.Hb({type:t}),t.\u0275inj=d.Gb({factory:function(i){return new(i||t)},imports:[[a.i.forChild(k)],a.i]}),t})();var I=e("iTUp");let P=(()=>{class t{}return t.\u0275mod=d.Hb({type:t}),t.\u0275inj=d.Gb({factory:function(i){return new(i||t)},imports:[[o.b,n.e,s.kb,C,I.a]]}),t})()}}]);