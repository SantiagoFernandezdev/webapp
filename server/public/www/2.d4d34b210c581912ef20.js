(window.webpackJsonp=window.webpackJsonp||[]).push([[2],{W7Eg:function(t,i,o){"use strict";o.d(i,"a",function(){return h});var e=o("R0Ic"),n=o("fXoL"),r=o("ofXK"),s=o("TEn/");const c=["video"],a=["range"];function b(t,i){1&t&&(n.Mb(0,"ion-chip",6),n.Kb(1,"ion-spinner",7),n.rc(2,"Cargando Video..."),n.Lb())}function l(t,i){if(1&t){const t=n.Nb();n.Mb(0,"ion-button",15),n.Ub("click",function(){return n.lc(t),n.Wb(2).play()}),n.Kb(1,"ion-icon",16),n.Lb()}}function u(t,i){if(1&t){const t=n.Nb();n.Mb(0,"ion-button",15),n.Ub("click",function(){return n.lc(t),n.Wb(2).pause()}),n.Kb(1,"ion-icon",17),n.Lb()}}function d(t,i){if(1&t){const t=n.Nb();n.Mb(0,"div",8),n.Mb(1,"div",9),n.qc(2,l,2,0,"ion-button",10),n.qc(3,u,2,0,"ion-button",10),n.Mb(4,"div",11),n.Mb(5,"ion-range",12,13),n.Ub("ionChange",function(i){return n.lc(t),n.Wb().progreso(i)})("ionFocus",function(i){return n.lc(t),n.Wb().foco(i)})("ionBlur",function(i){return n.lc(t),n.Wb().foco(i)}),n.Lb(),n.Lb(),n.Mb(7,"div",14),n.Mb(8,"strong"),n.rc(9),n.Lb(),n.Lb(),n.Lb(),n.Lb()}if(2&t){const t=n.Wb();n.zb(2),n.dc("ngIf",!t.paused),n.zb(1),n.dc("ngIf",t.paused),n.zb(2),n.dc("value",t.currProgress),n.zb(4),n.sc(t.currentt)}}let h=(()=>{class t{constructor(){this.paused=!0,this.currProgress=0,this.slideOpts={zoom:{maxRatio:3,minRatio:1,toggle:!0}},this.focus=!1,this.progress=0,this.value=0,this.bandera=!0,this.carga=!0,this.mostrar=!1}ngAfterViewInit(){this.current(),console.log(this.url," archivo")}play(){this.paused=!0,this.bandera=!0,this.focus=!0,this.video.nativeElement.play()}pause(){this.paused=!1,this.bandera=!1,this.focus=!1,this.video.nativeElement.pause()}current(){this.video.nativeElement.addEventListener("canplay",()=>{this.carga=!1,this.bandera&&this.play()}),this.video.nativeElement.addEventListener("progress",()=>{this.carga=!0}),this.video.nativeElement.addEventListener("timeupdate",()=>{this.currProgress=100*this.video.nativeElement.currentTime/this.video.nativeElement.duration,this.currentt=Math.round(this.video.nativeElement.currentTime),this.currentt<10&&(this.currentt="0"+this.currentt),this.video.nativeElement.currentTime===this.video.nativeElement.duration&&this.play()})}toggle(){console.log(this.bandera,this.focus),this.bandera?(this.mostrar=!0,this.bandera=!1,this.pause()):(this.mostrar=!1,this.focus?this.pause():this.play())}progreso(t){this.progress=t.detail.value,this.focus&&(this.play(),this.focus=!1),this.video.nativeElement.currentTime=Number((this.video.nativeElement.duration*(t.detail.value/100)).toFixed(6))}foco(t){this.bandera=!0,this.focus=!0,this.pause()}onProgress(){}ngOnDestroy(){this.video.nativeElement.pause(),console.log("Destrucci\xf3n")}}return t.\u0275fac=function(i){return new(i||t)},t.\u0275cmp=n.Db({type:t,selectors:[["app-video"]],viewQuery:function(t,i){if(1&t&&(n.vc(c,3),n.vc(a,1)),2&t){let t;n.kc(t=n.Vb())&&(i.video=t.first),n.kc(t=n.Vb())&&(i.range=t.first)}},inputs:{url:"url"},decls:6,vars:3,consts:[[1,"reproductor"],[1,"video",3,"click"],["poster","/assets/Video.png",3,"src"],["video",""],["class","cargando","color","success",4,"ngIf"],["class","controles",4,"ngIf"],["color","success",1,"cargando"],["name","crescent"],[1,"controles"],[1,"botones"],["fill","clear","color","blanco","mode","ios",3,"click",4,"ngIf"],[1,"volumen"],["debounce","500","min","0","max","100","color","success",3,"value","ionChange","ionFocus","ionBlur"],["range",""],[1,"tiempo"],["fill","clear","color","blanco","mode","ios",3,"click"],["name","play-outline","slot","icon-only"],["name","pause-outline","slot","icon-only"]],template:function(t,i){1&t&&(n.Mb(0,"div",0),n.Mb(1,"div",1),n.Ub("click",function(){return i.toggle()}),n.Kb(2,"video",2,3),n.qc(4,b,3,0,"ion-chip",4),n.Lb(),n.qc(5,d,10,4,"div",5),n.Lb()),2&t&&(n.zb(2),n.dc("src",i.url,n.mc),n.zb(2),n.dc("ngIf",i.carga),n.zb(1),n.dc("ngIf",i.mostrar))},directives:[r.j,s.r,s.bb,s.O,s.vb,s.j,s.A],styles:[".reproductor[_ngcontent-%COMP%]{width:100%;height:100%;position:relative}video[_ngcontent-%COMP%]{width:100vw;height:100vh}.cargando[_ngcontent-%COMP%]{position:absolute;width:200px;bottom:10px;right:10px;display:flex;justify-content:center;align-items:center;z-index:100}.oculto[_ngcontent-%COMP%]{opacity:0}.controles[_ngcontent-%COMP%]{width:100%;height:70px;padding:5px;background:rgba(0,0,0,.01);position:absolute;bottom:0;left:0}.botones[_ngcontent-%COMP%]{width:100%;height:50px;display:flex;align-items:center}.volumen[_ngcontent-%COMP%]{padding-left:5px;width:60%}.tiempo[_ngcontent-%COMP%]{width:calc(100% - 80%);color:#fff;font-size:12px;display:flex;justify-content:center;align-items:center}ion-range[_ngcontent-%COMP%]{--bar-height:10px}ion-slides[_ngcontent-%COMP%]{width:100%;height:calc(100% - 70px)}"],data:{animation:[Object(e.l)("entry",[Object(e.i)("closed",Object(e.j)({transform:"scale(0)"})),Object(e.i)("open",Object(e.j)({transform:"scale(1)"})),Object(e.k)("* <=> *",[Object(e.e)("50ms")])])]}}),t})()},WGaO:function(t,i,o){"use strict";o.d(i,"a",function(){return p});var e=o("AytR"),n=o("tk/3"),r=o("coGc"),s=o("lJxs"),c=o("IzEk"),a=o("MtjB"),b=o("JIr8"),l=o("PqYM"),u=o("Cfvw"),d=o("fXoL"),h=o("B7Rs");let p=(()=>{class t{constructor(t,i){this.http=t,this.MmyTransfer=i}hanflerError(t){return t.pipe(Object(r.a)(()=>Object(l.a)(3e3)),Object(s.a)(t=>{if(console.log("Entramos a intentos"),t instanceof ErrorEvent)throw new Error("Error de Red");if(404===t.status)throw new Error(" P\xe1gina no encontrada")}),Object(c.a)(3))}BuscarUsuarios(t,i){const o={headers:new n.c({"x-token":t})};return this.http.put(`${e.a}/empleados/buscar/`,{patron:i},o).pipe(Object(a.a)(t=>this.hanflerError(t)))}crearPublicacion(t,i){const o={headers:new n.c({"x-token":t})};return this.http.post(`${e.a}/igtm/crear/`,i,o).pipe(Object(a.a)(t=>this.hanflerError(t)))}leerPublicacion(t,i){const o={headers:new n.c({"x-token":t})};return this.http.put(`${e.a}/igtm/leer/`,i,o).pipe(Object(a.a)(t=>this.hanflerError(t)))}leerPublicacionUsuario(t,i){const o={headers:new n.c({"x-token":t})};return this.http.put(`${e.a}/igtm/leer/usuario`,i,o).pipe(Object(a.a)(t=>this.hanflerError(t)))}subirArchivosChat(t,i,o,n,r,s,c,a){console.log("archivo",o);const l={fileKey:"archivo",fileName:c,mimeType:a,httpMethod:"POST",headers:{"x-token":t,"x-idpublicacion":i,"x-final":n,"x-cont":r,"x-historia":s}},d=this.MmyTransfer.create();return Object(u.a)(d.upload(o,`${e.a}/igtm/upload`,l)).pipe(Object(b.a)(t=>{throw console.log("No se pudo subir la imagen ",t),new Error("No se pudo subir la imagen ")}))}leerFotos(t,i){const o={headers:new n.c({"x-token":t})};return this.http.put(`${e.a}/igtm/fotos/leer/`,i,o).pipe(Object(a.a)(t=>this.hanflerError(t)))}vistos(t,i){const o={headers:new n.c({"x-token":t})};return this.http.post(`${e.a}/igtm/historias/vistos/`,i,o).pipe(Object(a.a)(t=>this.hanflerError(t)))}eliminar(t,i){const o={headers:new n.c({"x-token":t})};return this.http.put(`${e.a}/igtm/eliminar/`,i,o).pipe(Object(a.a)(t=>this.hanflerError(t)))}meGusta(t,i){const o={headers:new n.c({"x-token":t})};return this.http.put(`${e.a}/igtm/megusta/`,i,o).pipe(Object(a.a)(t=>this.hanflerError(t)))}saber(t,i){const o={headers:new n.c({"x-token":t})};return this.http.put(`${e.a}/igtm/publicacion/seguidos/`,i,o).pipe(Object(a.a)(t=>this.hanflerError(t)))}saberHistorias(t,i){const o={headers:new n.c({"x-token":t})};return this.http.put(`${e.a}/igtm/historias/seguidos/`,i,o).pipe(Object(a.a)(t=>this.hanflerError(t)))}leerUna(t,i){const o={headers:new n.c({"x-token":t})};return this.http.put(`${e.a}/igtm/leer/uno/`,i,o).pipe(Object(a.a)(t=>this.hanflerError(t)))}leerUna2(t,i){const o={headers:new n.c({"x-token":t})};return this.http.put(`${e.a}/igtm/leer/uno/historia`,i,o).pipe(Object(a.a)(t=>this.hanflerError(t)))}crearComentario(t,i){const o={headers:new n.c({"x-token":t})};return this.http.post(`${e.a}/igtm/comentarios/`,i,o).pipe(Object(a.a)(t=>this.hanflerError(t)))}crearCompartida(t,i){const o={headers:new n.c({"x-token":t})};return this.http.post(`${e.a}/igtm/compartir/`,i,o).pipe(Object(a.a)(t=>this.hanflerError(t)))}crearGuardado(t,i){const o={headers:new n.c({"x-token":t})};return this.http.post(`${e.a}/igtm/guardado/`,i,o).pipe(Object(a.a)(t=>this.hanflerError(t)))}}return t.\u0275fac=function(i){return new(i||t)(d.Qb(n.a),d.Qb(h.a))},t.\u0275prov=d.Fb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})()},rE7l:function(t,i,o){"use strict";o.d(i,"a",function(){return R});var e=o("mrSG"),n=o("R0Ic"),r=o("fXoL"),s=o("fsfq"),c=o("WGaO"),a=o("fmoy"),b=o("TEn/"),l=o("VYYF"),u=o("tyNb"),d=o("7JkF"),h=o("ofXK"),p=o("W7Eg");const m=["slide"],g=["text"];function f(t,i){if(1&t){const t=r.Nb();r.Mb(0,"ion-header",6),r.Mb(1,"ion-toolbar",7),r.Mb(2,"ion-title"),r.rc(3),r.Lb(),r.Mb(4,"ion-buttons",8),r.Mb(5,"ion-button",9),r.Ub("click",function(){return r.lc(t),r.Wb().cerrar()}),r.Kb(6,"ion-icon",10),r.Lb(),r.Lb(),r.Lb(),r.Lb()}if(2&t){const t=r.Wb();r.zb(3),r.sc(t.titulo)}}function v(t,i){if(1&t){const t=r.Nb();r.Mb(0,"ion-item",9),r.Ub("click",function(){r.lc(t);const o=i.$implicit;return r.Wb(2).seleccionar(o)}),r.Mb(1,"ion-avatar",15),r.Kb(2,"img",16),r.Lb(),r.Mb(3,"ion-label"),r.Mb(4,"strong"),r.rc(5),r.Lb(),r.Kb(6,"br"),r.rc(7),r.Lb(),r.Lb()}if(2&t){const t=i.$implicit;r.zb(2),r.dc("src",t.imagen,r.mc),r.zb(3),r.sc(t.nombrecompleto),r.zb(2),r.tc(" @",t.nombreusuario," ")}}function M(t,i){if(1&t){const t=r.Nb();r.Mb(0,"div",11),r.Mb(1,"ion-searchbar",12),r.Ub("ionChange",function(i){return r.lc(t),r.Wb().buscar(i)}),r.Lb(),r.Kb(2,"div",13),r.Mb(3,"ion-list"),r.qc(4,v,8,3,"ion-item",14),r.Lb(),r.Lb()}if(2&t){const t=r.Wb();r.zb(4),r.dc("ngForOf",t.usuarios)}}function O(t,i){if(1&t&&r.Kb(0,"img",29),2&t){const t=r.Wb().$implicit;r.fc("src","https://motocaliapp.com/11927613401/",t.ruta,"",r.mc)}}function x(t,i){if(1&t&&r.Kb(0,"app-video",30),2&t){const t=r.Wb().$implicit;r.fc("url","https://motocaliapp.com/11927613401/",t.ruta,"")}}function L(t,i){if(1&t&&(r.Mb(0,"ion-slide",26),r.qc(1,O,1,1,"img",27),r.qc(2,x,1,1,"app-video",28),r.Lb()),2&t){const t=i.$implicit;r.zb(1),r.dc("ngIf",t.mime.includes("image")),r.zb(1),r.dc("ngIf",t.mime.includes("video")||t.mime.includes("Video")||t.mime.includes("mp4")||t.mime.includes("MP4"))}}function C(t,i){if(1&t&&(r.Mb(0,"ion-slides",23,24),r.qc(2,L,3,2,"ion-slide",25),r.Lb()),2&t){const t=r.Wb(2);r.dc("options",t.opt),r.zb(2),r.dc("ngForOf",t.archivos)}}function k(t,i){if(1&t){const t=r.Nb();r.Mb(0,"div",17),r.Mb(1,"div",18),r.Mb(2,"ion-item",19),r.Mb(3,"ion-avatar",15),r.Kb(4,"img",16),r.Lb(),r.Mb(5,"ion-label",20),r.rc(6),r.Kb(7,"br"),r.rc(8),r.Lb(),r.Mb(9,"ion-buttons",8),r.Mb(10,"ion-button",9),r.Ub("click",function(){return r.lc(t),r.Wb().cerrar()}),r.Kb(11,"ion-icon",21),r.Lb(),r.Lb(),r.Lb(),r.Lb(),r.qc(12,C,3,2,"ion-slides",22),r.Lb()}if(2&t){const t=r.Wb();r.zb(4),r.dc("src",t.info.image,r.mc),r.zb(2),r.tc("",t.info.creador.nombrecompleto," "),r.zb(2),r.tc(" ",t.info.creador.nombreusuario,""),r.zb(4),r.dc("ngIf",t.cargado)}}function w(t,i){if(1&t){const t=r.Nb();r.Mb(0,"ion-item",32),r.Ub("click",function(){r.lc(t);const o=i.$implicit;return r.Wb(2).perfilNavegar(o)}),r.Mb(1,"ion-avatar",15),r.Kb(2,"img",16),r.Lb(),r.Mb(3,"ion-label",33),r.Mb(4,"strong"),r.rc(5),r.Lb(),r.Kb(6,"br"),r.rc(7),r.Lb(),r.Lb()}if(2&t){const t=i.$implicit;r.zb(2),r.dc("src",t.image,r.mc),r.zb(3),r.sc(t.nombrecompleto),r.zb(2),r.tc(" @",t.nombreusuario," ")}}function j(t,i){if(1&t&&(r.Mb(0,"div",11),r.Kb(1,"div",13),r.Mb(2,"ion-list"),r.qc(3,w,8,3,"ion-item",31),r.Lb(),r.Lb()),2&t){const t=r.Wb();r.zb(3),r.dc("ngForOf",t.etiquetados)}}function z(t,i){1&t&&(r.Mb(0,"h3",37),r.rc(1,"No hay comentarios para esta publicaci\xf3n"),r.Lb())}function q(t,i){if(1&t){const t=r.Nb();r.Mb(0,"div",46),r.Ub("click",function(){r.lc(t);const i=r.Wb().index;return r.Wb(2).verRespuestas(i)}),r.rc(1,"Ver respuestas"),r.Lb()}}function E(t,i){if(1&t){const t=r.Nb();r.Mb(0,"div",46),r.Ub("click",function(){r.lc(t);const i=r.Wb().index;return r.Wb(2).verRespuestas(i)}),r.rc(1,"Ocultar respuestas"),r.Lb()}}function _(t,i){if(1&t){const t=r.Nb();r.Mb(0,"div"),r.Mb(1,"ion-label",39),r.Mb(2,"ion-avatar",40),r.Ub("click",function(){r.lc(t);const o=i.$implicit;return r.Wb(4).perfilNavegar(o.nombre)}),r.Kb(3,"img",16),r.Lb(),r.Mb(4,"div",41),r.Mb(5,"div",9),r.Ub("click",function(){r.lc(t);const o=i.$implicit;return r.Wb(4).perfilNavegar(o.nombre)}),r.Mb(6,"span",42),r.rc(7),r.Lb(),r.Kb(8,"br"),r.rc(9),r.Lb(),r.Mb(10,"div",43),r.Ub("click",function(){r.lc(t);const o=i.$implicit,e=r.Wb(2),n=e.$implicit,s=e.index;return r.Wb(2).responder(n,2,o,s)}),r.rc(11,"Responder"),r.Lb(),r.Lb(),r.Lb(),r.Lb()}if(2&t){const t=i.$implicit;r.zb(3),r.dc("src",t.image,r.mc),r.zb(4),r.tc("@",t.nombre.nombreusuario,""),r.zb(2),r.tc(" ",t.comentario," ")}}function P(t,i){if(1&t&&(r.Mb(0,"div",47),r.qc(1,_,12,3,"div",48),r.Lb()),2&t){const t=r.Wb().$implicit;r.dc("@entrada",void 0),r.zb(1),r.dc("ngForOf",t.hijos)}}function y(t,i){if(1&t){const t=r.Nb();r.Mb(0,"ion-item",38),r.Mb(1,"ion-label",39),r.Mb(2,"ion-avatar",40),r.Ub("click",function(){r.lc(t);const o=i.$implicit;return r.Wb(2).perfilNavegar(o.creador)}),r.Kb(3,"img",16),r.Lb(),r.Mb(4,"div",41),r.Mb(5,"div",9),r.Ub("click",function(){r.lc(t);const o=i.$implicit;return r.Wb(2).perfilNavegar(o.creador)}),r.Mb(6,"span",42),r.rc(7),r.Lb(),r.Kb(8,"br"),r.rc(9),r.Lb(),r.Mb(10,"div",43),r.Ub("click",function(){r.lc(t);const o=i.$implicit,e=i.index;return r.Wb(2).responder(o,1,"",e)}),r.rc(11,"Responder"),r.Lb(),r.qc(12,q,2,0,"div",44),r.qc(13,E,2,0,"div",44),r.qc(14,P,2,2,"div",45),r.Lb(),r.Lb(),r.Lb()}if(2&t){const t=i.$implicit;r.zb(3),r.dc("src",t.image,r.mc),r.zb(4),r.tc("@",t.creador.nombreusuario,""),r.zb(2),r.tc(" ",t.comentario," "),r.zb(3),r.dc("ngIf",t.hijos.length>0&&!t.habilitar),r.zb(1),r.dc("ngIf",t.hijos.length>0&&t.habilitar),r.zb(1),r.dc("ngIf",t.habilitar)}}function I(t,i){if(1&t&&(r.Mb(0,"div",34),r.qc(1,z,2,0,"h3",35),r.Mb(2,"ion-list"),r.qc(3,y,15,6,"ion-item",36),r.Lb(),r.Lb()),2&t){const t=r.Wb();r.zb(1),r.dc("ngIf",0===t.comentarios.length),r.zb(2),r.dc("ngForOf",t.comentarios)}}function $(t,i){if(1&t){const t=r.Nb();r.Mb(0,"div",58),r.Mb(1,"ion-avatar"),r.Kb(2,"img",59),r.Lb(),r.Mb(3,"div",60),r.Ub("click",function(){r.lc(t);const o=i.index;return r.Wb(3).eliminar(o)}),r.rc(4,"x"),r.Lb(),r.Lb()}if(2&t){const t=i.$implicit;r.zb(2),r.dc("src",t.imagen,r.mc)}}function W(t,i){if(1&t&&(r.Mb(0,"div",56),r.qc(1,$,5,1,"div",57),r.Lb()),2&t){const t=r.Wb(2);r.zb(1),r.dc("ngForOf",t.etiquetadosc)}}function N(t,i){1&t&&(r.Mb(0,"div",54),r.Kb(1,"ion-spinner",61),r.rc(2," Buscando usuarios... "),r.Lb())}function U(t,i){if(1&t){const t=r.Nb();r.Mb(0,"ion-item",9),r.Ub("click",function(){r.lc(t);const o=i.$implicit;return r.Wb(2).seleccion(o)}),r.Mb(1,"ion-avatar",15),r.Kb(2,"img",16),r.Lb(),r.Mb(3,"ion-label"),r.Mb(4,"strong"),r.rc(5),r.Lb(),r.Kb(6,"br"),r.rc(7),r.Lb(),r.Lb()}if(2&t){const t=i.$implicit;r.zb(2),r.dc("src",t.imagen,r.mc),r.zb(3),r.sc(t.nombrecompleto),r.zb(2),r.tc(" @",t.nombreusuario," ")}}function K(t,i){if(1&t){const t=r.Nb();r.Mb(0,"div",11),r.qc(1,W,2,1,"div",49),r.Mb(2,"ion-searchbar",50),r.Ub("ionChange",function(i){return r.lc(t),r.Wb().buscar(i)}),r.Lb(),r.Kb(3,"div",13),r.qc(4,N,3,0,"div",51),r.Mb(5,"ion-list"),r.qc(6,U,8,3,"ion-item",14),r.Mb(7,"ion-item",52),r.Mb(8,"ion-textarea",53),r.Ub("ionChange",function(i){return r.lc(t),r.Wb().cambiar(i)}),r.Lb(),r.Lb(),r.Lb(),r.Mb(9,"div",54),r.Mb(10,"ion-button",55),r.Ub("click",function(){return r.lc(t),r.Wb().publicarCompartido()}),r.rc(11,"COMPARTIR PUBLICACI\xd3N"),r.Lb(),r.Lb(),r.Lb()}if(2&t){const t=r.Wb();r.zb(1),r.dc("ngIf",t.etiquetadosc.length>0),r.zb(3),r.dc("ngIf",t.cargares),r.zb(2),r.dc("ngForOf",t.usuarios),r.zb(2),r.dc("autoGrow",t.auto)}}function F(t,i){if(1&t){const t=r.Nb();r.Mb(0,"ion-footer"),r.Mb(1,"ion-toolbar"),r.Mb(2,"ion-item",62),r.Mb(3,"ion-textarea",63,64),r.Ub("ionChange",function(i){return r.lc(t),r.Wb().comentar(i)}),r.Lb(),r.Mb(5,"ion-buttons",8),r.Mb(6,"ion-button",65),r.Ub("click",function(){return r.lc(t),r.Wb().crearComentario()}),r.Kb(7,"ion-icon",66),r.Lb(),r.Lb(),r.Lb(),r.Lb(),r.Lb()}if(2&t){const t=r.Wb();r.zb(3),r.ec("placeholder",t.usuario),r.dc("autofocus",t.focus)("autoGrow",!0)("value",t.comentario),r.zb(3),r.dc("disabled",t.boton)}}let R=(()=>{class t{constructor(t,i,o,e,n,r,s){this.almacenamiento=t,this.igtmApi=i,this.toast=o,this.modalCtrl=e,this.statusbar=n,this.router=r,this.socket=s,this.usuarios=[],this.titulo="",this.color="blanco",this.colorheader="blanco",this.header=!0,this.opt={zoom:{maxRation:5,toggle:!0}},this.cargado=!1,this.usuario="",this.comentario="",this.focus=!1,this.tipoComentario="nuevo",this.padre="",this.boton=!1,this.texto="",this.auto=!1,this.etiquetadosc=[],this.etiquetadoscid=[],this.cargares=!1}ngOnInit(){}ionViewWillEnter(){return Object(e.a)(this,void 0,void 0,function*(){if("etiquetar"===this.tipo)this.titulo="Etiquetar personas";else if("mencionar"===this.tipo)this.titulo="Mencionar personas";else if("visualizador"===this.tipo)this.header=!1,this.color="darkgold",this.colorheader="darkgold",this.statusbar.hide(),this.cargar();else if("etiquetados"===this.tipo)this.titulo="Etiquetados",this.color="blanco",this.colorheader="blanco",this.statusbar.hide(),this.etiquetados.forEach(t=>{t.image=t.imagen.length>0?`https://motocaliapp.com/${t.imagen[0].path}`:"/assets/notfound.png"});else if("comentar"===this.tipo){this.colorheader="light",this.titulo=this.comentarios.length+" Comentarios";const t=this.almacenamiento.obtenerToken();t&&(this.usuario=(t.nusuario?`@${t.nusuario}`:"")+" escribe un comentario",this.comentarios.length>0&&this.comentarios.forEach(t=>{t.image=t.creador.imagen.length>0?`https://motocaliapp.com/${t.creador.imagen[0].path}`:"/assets/notfound.png",t.habilitar=!1,t.hijos.length>0&&t.hijos.forEach(t=>{t.image=t.nombre.imagen.length>0?`https://motocaliapp.com/${t.nombre.imagen[0].path}`:"/assets/notfound.png"})}))}else"compartir"===this.tipo&&(this.titulo="Compartir publicaci\xf3n")})}cargar(){return Object(e.a)(this,void 0,void 0,function*(){this.cargado=!0,(yield this.almacenamiento.obtenerToken())&&(yield this.slide.slideTo(this.indice,0))})}buscar(t){return Object(e.a)(this,void 0,void 0,function*(){this.cargares=!0;const i=yield this.almacenamiento.obtenerToken();i&&this.igtmApi.BuscarUsuarios(i.token,t.detail.value).subscribe(t=>{t.exe?(t.response.forEach(t=>{t.imagen=t.imagen.length>0?`https://motocaliapp.com/${t.imagen[0].path}`:"/assets/notfound.png"}),this.usuarios=t.response,this.cargares=!1):(this.cargares=!1,this.toast.toastError("No se pudo taer los usuarios, intentelo mas tarde"))},t=>{this.cargares=!1,this.toast.toastError("No se puede etiquetar esta publicaci\xf3n, intentelo mas tarde")})})}seleccionar(t){this.modalCtrl.dismiss({exe:!0,persona:t})}navegar(t){this.router.navigate(["/central/buscar/perfil-visita",t.nombreusuario]),this.cerrar()}comentar(t){this.comentario=t.detail.value,this.comentario.includes("@")&&""!==this.comentario||(this.tipoComentario="nuevo")}responder(t,i,o,e){2===i?(o.nombre.padre=e,this.usuarioRespuesta=o.nombre,this.comentario=`@${o.nombre.nombreusuario} `):(this.comentario=`@${t.creador.nombreusuario} `,this.usuarioRespuesta=t.creador,this.usuarioRespuesta.padre=e),this.padre=t._id,this.tipoComentario="respuesta",this.text.setFocus()}cerrar(){"comentar"===this.tipo?this.modalCtrl.dismiss({exe:!0,comentarios:this.comentarios}):this.modalCtrl.dismiss()}crearComentario(){return Object(e.a)(this,void 0,void 0,function*(){this.boton=!0;const t=yield this.almacenamiento.obtenerToken();t&&this.igtmApi.crearComentario(t.token,{comentario:this.comentario,_id:this.publicacion,tipo:this.tipoComentario,padre:this.padre}).subscribe(i=>{i.exe?("nuevo"===this.tipoComentario?(i.response.image=i.response.creador.imagen.length>0?`https://motocaliapp.com/${i.response.creador.imagen[0].path}`:"/assets/notfound.png",this.comentarios.push(i.response)):(i.response.hijos.length>0&&(i.response.hijos[i.response.hijos.length-1].image=i.response.hijos[i.response.hijos.length-1].nombre.imagen.length>0?`https://motocaliapp.com/${i.response.hijos[i.response.hijos.length-1].nombre.imagen[0].path}`:"/assets/notfound.png"),this.comentarios[this.usuarioRespuesta.padre].hijos.push(i.response.hijos[i.response.hijos.length-1])),this.toast.toastNotificacion("Comentario enviado correctamente"),t._id!==this.creador._id?this.socket.emit("comentario","nuevo"===this.tipoComentario?{creador:this.creador._id,persona:`@${t.nusuario}`,celular:[this.creador.usuarioID],ids:[this.creador._id],motivo:"a comentado en tu publicaci\xf3n",comentario:this.comentario,publicacion:this.publicacion}:{creador:this.creador._id,persona:`@${t.nusuario}`,celular:[this.creador.usuarioID,this.usuarioRespuesta.usuarioID],ids:[this.creador._id,this.usuarioRespuesta._id],comentario:this.comentario,motivo:"respondi\xf3 a tu comentario",publicacion:this.publicacion}):"respuesta"===this.tipoComentario&&this.socket.emit("comentario",{creador:this.creador._id,persona:`@${t.nusuario}`,celular:[this.usuarioRespuesta.usuarioID],ids:[this.usuarioRespuesta._id],comentario:this.comentario,motivo:"respondi\xf3 a tu comentario",publicacion:this.publicacion}),this.comentario="",this.tipoComentario="respuesta",this.boton=!1):this.toast.toastError("No se pudo enviar el comentario, int\xe9ntelo m\xe1s tarde")},t=>{this.toast.toastError("No se pudo enviar el comentario, int\xe9ntelo m\xe1s tarde")})})}verRespuestas(t){this.comentarios[t].habilitar=!this.comentarios[t].habilitar}cambiar(t){this.texto=t.detail.value,this.auto=""!==this.texto}seleccion(t){this.etiquetadosc.find(i=>i._id===t._id)&&0!==this.etiquetadosc.length||(this.etiquetadosc.push(t),this.etiquetadoscid.push(t._id))}eliminar(t){this.etiquetadosc.splice(t,1),this.etiquetadoscid.splice(t,1)}publicarCompartido(){return Object(e.a)(this,void 0,void 0,function*(){this.boton=!0;const t=yield this.almacenamiento.obtenerToken();t&&this.igtmApi.crearCompartida(t.token,{etiquetas:this.etiquetadoscid,comentario:this.texto,publicacion:this.publicacionc}).subscribe(t=>{t.exe?this.modalCtrl.dismiss({recargo:!0}):this.toast.toastError("No se pudo compartir la publicaci\xf3n, int\xe9ntelo m\xe1s tarde")},t=>{this.toast.toastError("No se pudo compartir la publicaci\xf3n, int\xe9ntelo m\xe1s tarde")})})}perfilNavegar(t){return Object(e.a)(this,void 0,void 0,function*(){const i=yield this.almacenamiento.obtenerToken();i&&(this.modalCtrl.dismiss(),this.router.navigate(i.nusuario===t.nombreusuario?["/perfil/","s"]:["/visita/",t.nombreusuario,"s"]))})}}return t.\u0275fac=function(i){return new(i||t)(r.Jb(s.a),r.Jb(c.a),r.Jb(a.a),r.Jb(b.ob),r.Jb(l.a),r.Jb(u.g),r.Jb(d.a))},t.\u0275cmp=r.Db({type:t,selectors:[["app-igtmplantilla"]],viewQuery:function(t,i){if(1&t&&(r.vc(m,1),r.vc(g,1)),2&t){let t;r.kc(t=r.Vb())&&(i.slide=t.first),r.kc(t=r.Vb())&&(i.text=t.first)}},inputs:{tipo:"tipo",archivos:"archivos",indice:"indice",info:"info",etiquetados:"etiquetados",publicacion:"publicacion",creador:"creador",comentarios:"comentarios",publicacionc:"publicacionc"},decls:8,vars:8,consts:[["class","ion-no-border",4,"ngIf"],[3,"color"],["class","etiquetar",4,"ngIf"],["class","visualizador",4,"ngIf"],["class","comentar",4,"ngIf"],[4,"ngIf"],[1,"ion-no-border"],["color","oscuro"],["slot","end"],[3,"click"],["name","close-outline","slot","icon-only"],[1,"etiquetar"],["mode","ios","placeholder","Buscar Usuario",3,"ionChange"],[1,"divider"],[3,"click",4,"ngFor","ngForOf"],["slot","start"],["width","100%","height","100%","alt","",3,"src"],[1,"visualizador"],[1,"cerrar"],["lines","none",1,"transparente","sinfondo"],[1,"bl","ion-text-wrap"],["color","blanco","name","close-outline","slot","icon-only"],["class","fullancho","color","dark","mode","ios",3,"options",4,"ngIf"],["color","dark","mode","ios",1,"fullancho",3,"options"],["slide",""],["class","diapo",4,"ngFor","ngForOf"],[1,"diapo"],["width","100%",3,"src",4,"ngIf"],[3,"url",4,"ngIf"],["width","100%",3,"src"],[3,"url"],["color","blanco",3,"click",4,"ngFor","ngForOf"],["color","blanco",3,"click"],[1,""],[1,"comentar"],["class","tituloGrande",4,"ngIf"],["class","sinfondo","lines","none",4,"ngFor","ngForOf"],[1,"tituloGrande"],["lines","none",1,"sinfondo"],[1,"ion-text-wrap","esp","resp"],[1,"avatar",3,"click"],[1,"info"],[1,"titulo"],[1,"respuesta",3,"click"],["class","btn",3,"click",4,"ngIf"],["class","respuestas",4,"ngIf"],[1,"btn",3,"click"],[1,"respuestas"],[4,"ngFor","ngForOf"],["class","etiquetadosc",4,"ngIf"],["mode","ios","placeholder","Buscar usuario para etiquetarlo",3,"ionChange"],["class","botonc",4,"ngIf"],["mode","ios",1,"sinfondo"],["inputmode","text","maxlength","120","placeholder","Escribe un comentario",1,"comentario",3,"autoGrow","ionChange"],[1,"botonc"],["mode","ios","shape","round","color","success",3,"click"],[1,"etiquetadosc"],["class","targe",4,"ngFor","ngForOf"],[1,"targe"],["width","100%","height","100%",3,"src"],[1,"eliminar",3,"click"],["name","crescent"],["lines","none",1,"pie","sinfondo"],["inputmode","text","maxlength","200",1,"comentario",3,"autofocus","autoGrow","placeholder","value","ionChange"],["text",""],["color","primary",3,"disabled","click"],["name","send-outline","slot","icon-only"]],template:function(t,i){1&t&&(r.qc(0,f,7,1,"ion-header",0),r.Mb(1,"ion-content",1),r.qc(2,M,5,1,"div",2),r.qc(3,k,13,4,"div",3),r.qc(4,j,4,1,"div",2),r.qc(5,I,4,2,"div",4),r.qc(6,K,12,4,"div",2),r.Lb(),r.qc(7,F,8,5,"ion-footer",5)),2&t&&(r.dc("ngIf",i.header),r.zb(1),r.dc("color",i.color),r.zb(1),r.dc("ngIf","etiquetar"===i.tipo||"mencionar"===i.tipo),r.zb(1),r.dc("ngIf","visualizador"===i.tipo),r.zb(1),r.dc("ngIf","etiquetados"===i.tipo),r.zb(1),r.dc("ngIf","comentar"===i.tipo),r.zb(1),r.dc("ngIf","compartir"===i.tipo),r.zb(1),r.dc("ngIf","comentar"===i.tipo))},directives:[h.j,b.t,b.z,b.jb,b.hb,b.k,b.j,b.A,b.T,b.wb,b.L,h.i,b.F,b.f,b.K,b.ab,b.Z,p.a,b.fb,b.bb,b.x],styles:["ion-slide[_ngcontent-%COMP%], ion-slides[_ngcontent-%COMP%]{width:100%}.bl[_ngcontent-%COMP%]{color:#fff!important;font-size:12px!important}.visualizador[_ngcontent-%COMP%]{width:100%;position:relative}.fullancho[_ngcontent-%COMP%]{min-height:100%;height:100vh}.diapo[_ngcontent-%COMP%]{width:100%;height:100%}.cerrar[_ngcontent-%COMP%]{width:100%;position:absolute;top:0;z-index:100}.cblanco[_ngcontent-%COMP%], .cerrar[_ngcontent-%COMP%]{color:#fff}.comentario[_ngcontent-%COMP%]{margin:0}.titulo[_ngcontent-%COMP%]{font-weight:700;color:#777}.esp[_ngcontent-%COMP%]{white-space:pre-wrap}.respuesta[_ngcontent-%COMP%]{color:#0288d1;padding:5px 0;width:100%}.respuesta[_ngcontent-%COMP%]:hover{color:#015a8b}.respuestas[_ngcontent-%COMP%]{padding-left:15px;width:100%}.resp[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:flex-start}.res[_ngcontent-%COMP%]{margin-top:20px}.avatar[_ngcontent-%COMP%]{width:60px;height:30px;margin-right:20px}.info[_ngcontent-%COMP%]{width:calc(199% - 50px)}.avatar[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:100%}.btn[_ngcontent-%COMP%]{color:#777;opacity:.7;margin-bottom:10px}.tituloGrande[_ngcontent-%COMP%]{width:300px;margin:30px auto;opacity:.5;text-align:center}.comentario[_ngcontent-%COMP%]{width:100%;text-align:left;margin-top:15px}.etiquetadosc[_ngcontent-%COMP%]{width:100%;display:flex;flex-wrap:wrap}.etiquetadosc[_ngcontent-%COMP%]   .targe[_ngcontent-%COMP%]{width:calc(60px - 20px);margin:10px;position:relative}.etiquetadosc[_ngcontent-%COMP%]   .targe[_ngcontent-%COMP%]   ion-avatar[_ngcontent-%COMP%]{width:60px;height:60px}.etiquetadosc[_ngcontent-%COMP%]   .targe[_ngcontent-%COMP%]   .eliminar[_ngcontent-%COMP%]{position:absolute;width:20px;height:20px;top:0;right:-15px;border-radius:100%;background-color:#f3c5c1;color:red;display:flex;justify-content:center;align-items:center}.botonc[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center}"],data:{animation:[Object(n.l)("entrada",[Object(n.k)(":enter",[Object(n.j)({opacity:0}),Object(n.e)("300ms",Object(n.j)({opacity:1}))]),Object(n.k)(":leave",[Object(n.j)({opacity:1}),Object(n.e)("100ms",Object(n.j)({opacity:0}))])])]}}),t})()}}]);