{"version":3,"sources":["./src/app/pages/usuario/solicitudes/solicitudes.page.ts","./src/app/pages/usuario/solicitudes/solicitudes-routing.module.ts","./src/app/pages/usuario/solicitudes/solicitudes.module.ts","./src/app/pages/usuario/solicitudes/solicitudes.page.html","./src/app/pages/usuario/solicitudes/solicitudes.page.scss"],"names":[],"mappings":"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","file":"usuario-solicitudes-solicitudes-module.js","sourcesContent":["import { Component, OnInit } from '@angular/core';\nimport { ApiSeguimientoService } from 'src/app/providers/Api/Seguimiento.service';\nimport { InicioService } from '../../../providers/Almacenamiento/inicio.service';\nimport { trigger, transition, query, style, stagger, animate } from '@angular/animations';\nimport { ToastServices } from '../../../providers/Utilidades/ToastService.service';\nimport { CargaElementosUsuariosService } from '../../../providers/cargas/usuarios.service';\n\n@Component({\n  selector: 'app-solicitudes',\n  templateUrl: './solicitudes.page.html',\n  animations: [\n    trigger('solicitudes', [\n      transition('* => *', [\n        query(':enter', [\n          style({\n            opacity: 0,\n            transform: 'translateY(400px)'\n          }),\n          stagger(300, [\n            animate('500ms', style({\n              opacity: 1,\n              transform: 'none'\n            }))\n          ])\n        ], {optional: true}),\n\n        query(':leave', [\n          style({\n            opacity: 1,\n            transform: 'none'\n          }),\n          stagger(300, [\n            animate('500ms', style({\n              opacity: 0,\n              transform: 'translateY(-100%)'\n            }))\n          ])\n        ], {optional: true})\n      ])\n    ])\n  ],\n  styleUrls: ['./solicitudes.page.scss'],\n})\nexport class SolicitudesPage implements OnInit {\n\n  seguimientos: any = [];\n  red = 'wifi';\n\n  cancelSuscribe: any;\n\n  constructor(\n    private apiSeguimiento: ApiSeguimientoService,\n    private almacenamiento: InicioService,\n    private toastUtilidad: ToastServices,\n    private cargarElementos: CargaElementosUsuariosService\n  ) { \n    this.cargarElementos.$cargarRed.subscribe((red: any) => {\n      this.red = red;\n      if (this.red !== 'none') {\n        this.arrancar();\n      }\n    })\n\n  }\n\n  ngOnInit() {\n  }\n\n  ionViewDidEnter() {\n    if (this.red !== 'none') {\n      this.arrancar();\n    }\n  }\n\n  arrancar() {\n    \n    this.almacenamiento.obtenerToken().then((info: any) => {\n        this.cancelSuscribe = this.apiSeguimiento.solicitudesRecibidas(info.token).subscribe((solicitudes: any) => {\n             this.seguimientos = [];\n             // console.log(solicitudes.response, 11);\n  \n             const data = solicitudes.response.SeguimientoData;\n  \n             if (data.length > 0) {\n              data.forEach((item) => {\n                if ( item.usuarioEmisor.imagen.length > 0) {\n                  item.imagen = item.usuarioEmisor.imagen[0].path;\n                } else {\n                  item.imagen = '';\n                }\n                \n                this.seguimientos.push(item);\n              })\n             }\n  \n             // console.log(this.seguimientos, ' Seguimientos');\n        }, (err) => {\n          this.toastUtilidad.alertApplication('No se pudo aceptar la solicitud', false);\n        })\n    });\n  }\n\n  aceptar(solicitud: any, idx: number) {\n    // console.log('Datos del aceptar ', solicitud, idx)\n    this.almacenamiento.obtenerToken().then((info: any) => {\n      this.apiSeguimiento.aceptarSolicitud(info.token, solicitud.usuarioEmisor._id).subscribe((seguimiento: any) => {\n          // console.log(seguimiento, ' Solicitud aceptada');\n          this.toastUtilidad.alertApplication('Solicitud aceptada', true);\n          this.seguimientos.splice(idx, 1);\n      }, (err) => {\n        this.toastUtilidad.alertApplication('No se pudo aceptar la solicitud', false);\n      })\n    })\n  }\n\n  eliminar(seguimiento: any, idx: number) {\n    this.almacenamiento.obtenerToken().then((info: any) => {\n      this.apiSeguimiento.cancelarSolicitud(info.token, seguimiento.usuarioEmisor._id, '0').subscribe(() => {\n        this.seguimientos.splice(idx, 1);\n      }, (err) => {\n        this.toastUtilidad.alertApplication('No se pudo aceptar la solicitud', false);\n      })\n    })\n  }\n\n  ionViewDidLeave() {\n    // tslint:disable-next-line:no-unused-expression\n    this.cancelSuscribe.unsubscribe;\n  }\n\n}\n","import { NgModule } from '@angular/core';\nimport { Routes, RouterModule } from '@angular/router';\n\nimport { SolicitudesPage } from './solicitudes.page';\n\nconst routes: Routes = [\n  {\n    path: '',\n    component: SolicitudesPage\n  }\n];\n\n@NgModule({\n  imports: [RouterModule.forChild(routes)],\n  exports: [RouterModule],\n})\nexport class SolicitudesPageRoutingModule {}\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { FormsModule } from '@angular/forms';\n\nimport { IonicModule } from '@ionic/angular';\n\nimport { SolicitudesPageRoutingModule } from './solicitudes-routing.module';\n\nimport { SolicitudesPage } from './solicitudes.page';\n\n@NgModule({\n  imports: [\n    CommonModule,\n    FormsModule,\n    IonicModule,\n    SolicitudesPageRoutingModule\n  ],\n  declarations: [SolicitudesPage]\n})\nexport class SolicitudesPageModule {}\n","export default \"<ion-header class=\\\"ion-no-border\\\">\\n    <ion-toolbar color=\\\"oscuro\\\">\\n        <ion-back-button slot=\\\"start\\\" defaultHref=\\\"/central/menu/\\\" icon=\\\"chevron-back-outline\\\">\\n        </ion-back-button>\\n        <ion-title class=\\\"medium\\\">solicitudes de Seguimiento {{seguimientos.length}}</ion-title>\\n    </ion-toolbar>\\n</ion-header>\\n\\n<ion-content>\\n\\n\\n    <div class=\\\"divider\\\"></div>\\n\\n\\n    <div class=\\\"blanco\\\" [ngClass]=\\\"{'hauto centrar': seguimientos.length === 0}\\\">\\n\\n        <ion-list class=\\\"blanco \\\" [@solicitudes]=\\\"seguimientos.length\\\" *ngIf=\\\"seguimientos.length > 0\\\">\\n            <ion-item lines=\\\"none\\\" color=\\\"blanco\\\" *ngFor=\\\"let solicitud of seguimientos; let i = index;\\\">\\n                <ion-avatar class=\\\"avatar\\\" slot=\\\"start\\\">\\n                    <ion-img src=\\\"https://motocaliapp.com/{{solicitud.imagen}}\\\"></ion-img>\\n                </ion-avatar>\\n                <ion-label class=\\\"ion-text-wrap\\\">\\n                    <strong class=\\\"small\\\">{{solicitud.usuarioEmisor.nombrecompleto}}</strong><br>\\n                    <div>@{{solicitud.usuarioEmisor.nombreusuario}}</div>\\n                    <div class=\\\"moto-padre\\\">\\n                        <ion-button (click)=\\\"aceptar(solicitud, i)\\\" color=\\\"success\\\" shape=\\\"round\\\" mode=\\\"ios\\\">Aceptar</ion-button>\\n\\n                        <ion-button (click)=\\\"eliminar(solicitud, i)\\\" color=\\\"light\\\" shape=\\\"round\\\" mode=\\\"ios\\\">Eliminar</ion-button>\\n                    </div>\\n                </ion-label>\\n\\n            </ion-item>\\n        </ion-list>\\n    </div>\\n</ion-content>\";","export default \".avatar {\\n  width: 80px;\\n  height: 80px;\\n}\\n\\n.moto-padre {\\n  display: flex;\\n}\\n\\n.moto-padre ion-button {\\n  width: calc(50% - 2px);\\n  max-width: 200px;\\n}\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uXFwuLlxcLi5cXC4uXFwuLlxcc29saWNpdHVkZXMucGFnZS5zY3NzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0VBQ0ksV0FBQTtFQUNBLFlBQUE7QUFDSjs7QUFFQTtFQUNJLGFBQUE7QUFDSjs7QUFFQTtFQUNJLHNCQUFBO0VBQ0EsZ0JBQUE7QUFDSiIsImZpbGUiOiJzb2xpY2l0dWRlcy5wYWdlLnNjc3MiLCJzb3VyY2VzQ29udGVudCI6WyIuYXZhdGFyIHtcclxuICAgIHdpZHRoOiA4MHB4O1xyXG4gICAgaGVpZ2h0OiA4MHB4O1xyXG59XHJcblxyXG4ubW90by1wYWRyZSB7XHJcbiAgICBkaXNwbGF5OiBmbGV4O1xyXG59XHJcblxyXG4ubW90by1wYWRyZSBpb24tYnV0dG9uIHtcclxuICAgIHdpZHRoOiBjYWxjKDUwJSAtIDJweCk7XHJcbiAgICBtYXgtd2lkdGg6IDIwMHB4O1xyXG59Il19 */\";"],"sourceRoot":"webpack:///"}