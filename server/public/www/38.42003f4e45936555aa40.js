(window.webpackJsonp=window.webpackJsonp||[]).push([[38],{PrQa:function(t,e,r){"use strict";r.r(e),r.d(e,"InterfazGrupoIntegrantesPageModule",function(){return M});var o=r("ofXK"),i=r("3Pt+"),n=r("TEn/"),a=r("tyNb"),s=r("mrSG"),c=r("fXoL"),p=r("fsfq"),l=r("oQG1"),h=r("fmoy"),u=r("vLoH"),d=r("a/9d"),b=r("r3ab"),f=r("Gq8O"),g=r("7JkF");function m(t,e){1&t&&(c.Mb(0,"ion-title"),c.rc(1,"Integrantes"),c.Lb())}function v(t,e){1&t&&(c.Mb(0,"div",6),c.Kb(1,"img",7),c.Mb(2,"h3"),c.rc(3,"No tiene acceso para ver esta informaci\xf3n, env\xede una invitaci\xf3n a este grupo"),c.Lb(),c.Lb())}function j(t,e){1&t&&(c.Mb(0,"div",16),c.Mb(1,"strong"),c.rc(2,"Creador de\xf1 grupo"),c.Lb(),c.Lb())}function w(t,e){if(1&t){const t=c.Nb();c.Mb(0,"ion-item-option",19),c.Ub("click",function(){c.lc(t);const e=c.Wb(2),r=e.$implicit,o=e.index;return c.Wb(2).eliminari(r._id,o)}),c.Kb(1,"ion-icon",20),c.Lb()}}function k(t,e){if(1&t&&(c.Mb(0,"ion-item-options",17),c.qc(1,w,2,0,"ion-item-option",18),c.Lb()),2&t){const t=c.Wb().$implicit,e=c.Wb(2);c.zb(1),c.dc("ngIf",t._id!==e.grupo.creador)}}function E(t,e){if(1&t){const t=c.Nb();c.Mb(0,"ion-item-sliding"),c.Mb(1,"ion-item",9),c.Ub("click",function(){c.lc(t);const r=e.$implicit;return c.Wb(2).perfilNavegar(r.nombreusuario)}),c.Mb(2,"ion-avatar",10),c.Kb(3,"img",11),c.Lb(),c.Mb(4,"ion-label",12),c.Mb(5,"strong",13),c.rc(6),c.Lb(),c.Kb(7,"br"),c.Mb(8,"div"),c.rc(9),c.Lb(),c.qc(10,j,3,0,"div",14),c.Lb(),c.Lb(),c.qc(11,k,2,1,"ion-item-options",15),c.Lb()}if(2&t){const t=e.$implicit,r=c.Wb(2);c.zb(3),c.fc("src","https://motocaliapp.com/",t.imagen[0].path,"",c.mc),c.zb(3),c.sc(t.nombrecompleto),c.zb(3),c.tc("@",t.nombreusuario,""),c.zb(1),c.dc("ngIf",t._id===r.grupo.creador),c.zb(1),c.dc("ngIf",r.id===r.grupo.creador)}}function x(t,e){if(1&t&&(c.Mb(0,"ion-list"),c.qc(1,E,12,5,"ion-item-sliding",8),c.Lb()),2&t){const t=c.Wb();c.zb(1),c.dc("ngForOf",t.grupo.integrantes)}}const O=[{path:"",component:(()=>{class t{constructor(t,e,r,o,i,n,a,s,c,p,l,h){this.almacenamiento=t,this.apiUsuario=e,this.toast=r,this.apiGrupos=o,this.router=i,this.active=n,this.actionCtrl=a,this.camera=s,this.loadingService=c,this.seguimientoService=p,this.socket=l,this.alert=h,this.cargado=!1,this.solicitudEnviada=!1,this.cargarInformacion=!1,this.mostrar=!1}ngOnInit(){}ionViewWillEnter(){this.listar()}refrescando(t){this.solicitudEnviada=!1,this.cargado=!1,this.listar().then(()=>{t.target.complete()}).catch(()=>{t.target.complete()})}listar(){return Object(s.a)(this,void 0,void 0,function*(){const t=yield this.almacenamiento.obtenerToken();t&&(this.id=t._id,this.apiGrupos.integrantes(t.token,{id:this.active.snapshot.paramMap.get("id")}).subscribe(t=>{console.log(t),t.exe?(this.grupo=t.response[0],this.mostrar=this.grupo.integrantes.filter(t=>t._id===this.id).length>0,console.log(t)):this.toast.toastError("No se pudo consultar la informaci\xf3n, int\xe9ntelo m\xe1s tarde"),this.cargado=!0},t=>{this.toast.toastError("No se pudo consultar la informaci\xf3n, int\xe9ntelo m\xe1s tarde"),this.cargado=!0}))})}perfilNavegar(t){return Object(s.a)(this,void 0,void 0,function*(){const e=yield this.almacenamiento.obtenerToken();e&&this.router.navigate(e.nusuario===t?["/perfil/","s"]:["/visita/",t,"s"])})}eliminari(t,e){return Object(s.a)(this,void 0,void 0,function*(){const r=yield this.alert.create({header:"Atenci\xf3n!",message:"\xbfQuieres sacar a este usuario del grupo?",buttons:[{text:"Cancelar",role:"cancel",cssClass:"cancelarAlerta"},{text:"Sacar",cssClass:"botonalerta",handler:()=>{this.almacenamiento.obtenerToken().then(r=>{console.log(t),this.seguimientoService.cancelarSolicitudGrupoAdmin(r.token,this.grupo.usuario,{grupo:this.grupo._id,usuario:t}).subscribe(t=>{console.log(t),t.exe&&this.grupo.integrantes.splice(e,1)},t=>{console.log(t),this.toast.alertApplication(t.message,!1)})}).catch(t=>{this.toast.alertApplication(t,!1)})}}]});yield r.present()})}}return t.\u0275fac=function(e){return new(e||t)(c.Jb(p.a),c.Jb(l.a),c.Jb(h.a),c.Jb(u.a),c.Jb(a.g),c.Jb(a.a),c.Jb(n.a),c.Jb(d.a),c.Jb(b.a),c.Jb(f.a),c.Jb(g.a),c.Jb(n.b))},t.\u0275cmp=c.Db({type:t,selectors:[["app-interfaz-grupo-integrantes"]],decls:9,vars:3,consts:[["color","oscuro"],["icon","chevron-back-outline","defaultHref","/interactivo/grupos","slot","start"],[4,"ngIf"],["slot","fixed","pullFactor","0.5","pullMin","50","pullMax","150",3,"ionRefresh"],["pullingIcon","arrow-dropdown","refreshingSpinner","circles"],["class","fcenter",4,"ngIf"],[1,"fcenter"],["src","/assets/No.png","width","100px","alt",""],[4,"ngFor","ngForOf"],["color","blanco",3,"click"],["slot","start"],["width","100%","height","100%",3,"src"],[1,"ion-text-wrap"],[1,"small"],["class","creador",4,"ngIf"],["side","end",4,"ngIf"],[1,"creador"],["side","end"],["color","danger",3,"click",4,"ngIf"],["color","danger",3,"click"],["name","trash-outline","slot","icon-only"]],template:function(t,e){1&t&&(c.Mb(0,"ion-header"),c.Mb(1,"ion-toolbar",0),c.Kb(2,"ion-back-button",1),c.qc(3,m,2,0,"ion-title",2),c.Lb(),c.Lb(),c.Mb(4,"ion-content"),c.Mb(5,"ion-refresher",3),c.Ub("ionRefresh",function(t){return e.refrescando(t)}),c.Kb(6,"ion-refresher-content",4),c.Lb(),c.qc(7,v,4,0,"div",5),c.qc(8,x,2,1,"ion-list",2),c.Lb()),2&t&&(c.zb(3),c.dc("ngIf",e.grupo),c.zb(4),c.dc("ngIf",e.cargado&&!e.mostrar),c.zb(1),c.dc("ngIf",e.cargado&&e.mostrar))},directives:[n.z,n.kb,n.g,n.h,o.j,n.t,n.Q,n.R,n.ib,n.L,o.i,n.J,n.F,n.f,n.K,n.I,n.H,n.A],styles:[".creador[_ngcontent-%COMP%]{color:var(--ion-color-oscuro)}.fcenter[_ngcontent-%COMP%]{margin:50px auto;display:flex;flex-direction:column;justify-content:center;align-items:center;width:300px;text-align:center}"]}),t})()}];let $=(()=>{class t{}return t.\u0275mod=c.Hb({type:t}),t.\u0275inj=c.Gb({factory:function(e){return new(e||t)},imports:[[a.i.forChild(O)],a.i]}),t})(),M=(()=>{class t{}return t.\u0275mod=c.Hb({type:t}),t.\u0275inj=c.Gb({factory:function(e){return new(e||t)},imports:[[o.b,i.e,n.lb,$]]}),t})()},r3ab:function(t,e,r){"use strict";r.d(e,"a",function(){return a});var o=r("mrSG"),i=r("fXoL"),n=r("TEn/");let a=(()=>{class t{constructor(t){this.loadingCtrl=t}cargaProcesos(t){return Object(o.a)(this,void 0,void 0,function*(){return this.loading=yield this.loadingCtrl.create({message:t}),this.loading.present()})}finalizarCargado(){this.loading.dismiss()}}return t.\u0275fac=function(e){return new(e||t)(i.Qb(n.nb))},t.\u0275prov=i.Fb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})()},vLoH:function(t,e,r){"use strict";r.d(e,"a",function(){return g});var o=r("tk/3"),i=r("PqYM"),n=r("Cfvw"),a=r("coGc"),s=r("lJxs"),c=r("IzEk"),p=r("MtjB"),l=r("JIr8"),h=r("AytR"),u=r("fXoL"),d=r("B7Rs"),b=r("fsfq"),f=r("TEn/");let g=(()=>{class t{constructor(t,e,r,o){this.http=t,this.transfer=e,this.almacenamiento=r,this.navCtrl=o}hanflerError(t){let e=0;return t.pipe(Object(a.a)(()=>Object(i.a)(5e3)),Object(s.a)(t=>{if(e++,console.log("Entramos a intentos"),t instanceof ErrorEvent){if(3===e)throw new Error("Error de Red")}else{if(!(t instanceof ProgressEvent))throw 404===t.status?new Error(" al realizar la solicictud "):401===t.status?(this.almacenamiento.terminarPartida().then(()=>{this.navCtrl.navigateRoot("/home")}),new Error("No tiene permisos para realizar la petici\xf3n ")):(console.log(t,"Error de servidor"),new Error(" No se pudo realizar la petici\xf3n, intentalo m\xe1s tarde "));if(3===e)throw new Error("Error de Red")}}),Object(c.a)(3))}crearGrupo(t,e){const r={headers:new o.c({"x-token":t})};return this.http.post(`${h.a}/grupos/crear`,e,r).pipe(Object(p.a)(t=>this.hanflerError(t)))}listarGrupos(t,e){const r={headers:new o.c({"x-token":t})};return this.http.put(`${h.a}/grupos/lista`,e,r).pipe(Object(p.a)(t=>this.hanflerError(t)))}info(t,e){const r={headers:new o.c({"x-token":t})};return this.http.put(`${h.a}/grupos/info`,e,r).pipe(Object(p.a)(t=>this.hanflerError(t)))}integrantes(t,e){const r={headers:new o.c({"x-token":t})};return this.http.put(`${h.a}/grupos/integrantes`,e,r).pipe(Object(p.a)(t=>this.hanflerError(t)))}fotoPerfilUsuarioMoto(t,e,r,o){const i={fileKey:"archivo",httpMethod:"PUT",headers:{"x-token":t,"x-id":o},params:{tipo:r}},a=this.transfer.create();return Object(n.a)(a.upload(e,`${h.a}/upload/grupos`,i)).pipe(Object(l.a)(t=>{throw console.log("No se pudo subir la imagen "),new Error("No se pudo subir la imagen ")}))}subirweb(t,e,r){const i={headers:new o.c({"x-token":t,"x-id":r})};return this.http.put(`${h.a}/upload/grupos`,e,i).pipe(Object(p.a)(t=>this.hanflerError(t)))}leerProducto(t,e){const r={headers:new o.c({"x-token":t})};return this.http.put(`${h.a}/grupos/filtrar`,e,r).pipe(Object(p.a)(t=>this.hanflerError(t)))}chat(t,e){const r={headers:new o.c({"x-token":t})};return this.http.put(`${h.a}/grupos/chat`,e,r).pipe(Object(p.a)(t=>this.hanflerError(t)))}descarga(t,e){return this.http.get(`https://api.mapbox.com/directions/v5/mapbox/driving-traffic/${e.coordsIniciales.lng},${e.coordsIniciales.lat};${e.coordsFinales.lng},${e.coordsFinales.lat}?geometries=geojson&steps=true&language=es&access_token=${t}`).pipe(Object(p.a)(t=>this.hanflerError(t)))}dibujar(t,e){return this.http.get(`https://api.mapbox.com/directions/v5/mapbox/driving-traffic/${e.lng},${e.lat};${e.lngf},${e.latf}?geometries=geojson&steps=true&language=es&access_token=${t}`).pipe(Object(p.a)(t=>this.hanflerError(t)))}viaje(t,e){const r={headers:new o.c({"x-token":t})};return this.http.post(`${h.a}/grupos/viajes`,e,r).pipe(Object(p.a)(t=>this.hanflerError(t)))}irgrupo(t,e){const r={headers:new o.c({"x-token":t})};return this.http.put(`${h.a}/grupos/bu`,e,r).pipe(Object(p.a)(t=>this.hanflerError(t)))}podio(t,e){const r={headers:new o.c({"x-token":t})};return this.http.put(`${h.a}/grupos/podio`,e,r).pipe(Object(p.a)(t=>this.hanflerError(t)))}tabla(t,e){const r={headers:new o.c({"x-token":t})};return this.http.put(`${h.a}/grupos/tabla`,e,r).pipe(Object(p.a)(t=>this.hanflerError(t)))}viajechao(t,e){const r={headers:new o.c({"x-token":t})};return this.http.put(`${h.a}/grupos/viajes/eliminar`,e,r).pipe(Object(p.a)(t=>this.hanflerError(t)))}fotospodio(t,e){const r={headers:new o.c({"x-token":t})};return this.http.put(`${h.a}/grupos/podio/fotos`,e,r).pipe(Object(p.a)(t=>this.hanflerError(t)))}viajeBuscarUno(t,e){const r={headers:new o.c({"x-token":t})};return this.http.put(`${h.a}/grupos/buscar`,e,r).pipe(Object(p.a)(t=>this.hanflerError(t)))}viajeBuscar(t,e){const r={headers:new o.c({"x-token":t})};return this.http.put(`${h.a}/grupos/viajes/filtrar`,e,r).pipe(Object(p.a)(t=>this.hanflerError(t)))}fotoviaje(t,e,r){const o={fileKey:"archivo",httpMethod:"PUT",headers:{"x-token":e,"x-viaje":r}},i=this.transfer.create();return Object(n.a)(i.upload(t,`${h.a}/grupos/viaje/upload`,o)).pipe(Object(l.a)(t=>{throw new Error("No se pudo subir la imagen ")}))}subirweb2(t,e,r){const i={headers:new o.c({"x-token":t,"x-viaje":r})};return this.http.put(`${h.a}/grupos/viaje/upload`,e,i).pipe(Object(p.a)(t=>this.hanflerError(t)))}fotosviaje(t,e){const r={headers:new o.c({"x-token":t})};return this.http.put(`${h.a}/grupos/viaje/fotos`,e,r).pipe(Object(p.a)(t=>this.hanflerError(t)))}destino(t,e){const r={headers:new o.c({"x-token":t})};return this.http.put(`${h.a}/grupos/viaje/destino`,e,r).pipe(Object(p.a)(t=>this.hanflerError(t)))}eliminarviaje(t,e){const r={headers:new o.c({"x-token":t})};return this.http.put(`${h.a}/grupos/viaje/eliminar`,e,r).pipe(Object(p.a)(t=>this.hanflerError(t)))}eliminarFoto(t,e){const r={headers:new o.c({"x-token":t})};return this.http.put(`${h.a}/grupos/viaje/eliminarfoto`,e,r).pipe(Object(p.a)(t=>this.hanflerError(t)))}km(t,e){const r={headers:new o.c({"x-token":t})};return this.http.put(`${h.a}/grupos/km`,e,r).pipe(Object(p.a)(t=>this.hanflerError(t)))}}return t.\u0275fac=function(e){return new(e||t)(u.Qb(o.a),u.Qb(d.a),u.Qb(b.a),u.Qb(f.qb))},t.\u0275prov=u.Fb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})()}}]);