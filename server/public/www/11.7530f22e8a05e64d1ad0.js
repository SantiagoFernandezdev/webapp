(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{"8Loi":function(t,o,i){"use strict";i.r(o),i.d(o,"HojaVidaModalPageModule",function(){return W});var e=i("ofXK"),n=i("3Pt+"),a=i("TEn/"),r=i("tyNb"),s=i("mrSG"),c=i("fXoL"),l=i("fsfq"),b=i("a/9d"),d=i("fmoy"),u=i("r3ab"),p=i("AQLj"),h=i("fqim");const g=["ele"],f=["fileUpload"];function m(t,o){if(1&t){const t=c.Nb();c.Mb(0,"ion-slide"),c.Kb(1,"img",24),c.Mb(2,"ion-textarea",25),c.Ub("ionChange",function(i){c.lc(t);const e=o.index;return c.Wb(3).descripcion(i,e)}),c.Lb(),c.Mb(3,"div",26),c.Ub("click",function(){c.lc(t);const i=o.index;return c.Wb(3).eliminardelCarrete(i)}),c.Mb(4,"ion-button",27),c.rc(5,"Eliminar"),c.Lb(),c.Lb(),c.Lb()}if(2&t){const t=o.$implicit,i=c.Wb(3);c.zb(1),c.ec("src",t.ruta,c.mc),c.zb(1),c.dc("autoGrow",i.gorw)("value",t.texto)}}function M(t,o){if(1&t&&(c.Mb(0,"ion-slides",22),c.qc(1,m,6,3,"ion-slide",23),c.Lb()),2&t){const t=c.Wb(2);c.dc("options",t.slideOpt),c.zb(1),c.dc("ngForOf",t.files)}}function v(t,o){if(1&t){const t=c.Nb();c.Mb(0,"ion-content",4),c.Mb(1,"ion-item",5),c.Mb(2,"ion-buttons",6),c.Kb(3,"ion-back-button",7),c.Lb(),c.Mb(4,"ion-buttons",8),c.Mb(5,"ion-button",9),c.Ub("click",function(){return c.lc(t),c.Wb().guardar()}),c.Kb(6,"ion-icon",10),c.Lb(),c.Lb(),c.Lb(),c.Mb(7,"ion-item",11),c.Mb(8,"ion-label"),c.rc(9,"Seleccione el tipo"),c.Lb(),c.Mb(10,"ion-select",12),c.Ub("ionChange",function(o){return c.lc(t),c.Wb().cambiar(o)}),c.Mb(11,"ion-select-option",13),c.rc(12,"Fotos de Entrada"),c.Lb(),c.Mb(13,"ion-select-option",14),c.rc(14,"Fotos de Salida"),c.Lb(),c.Mb(15,"ion-select-option",15),c.rc(16,"Novedades"),c.Lb(),c.Lb(),c.Lb(),c.Kb(17,"input",16,17),c.qc(19,M,2,2,"ion-slides",18),c.Mb(20,"ion-fab",19),c.Mb(21,"ion-fab-button",20),c.Ub("click",function(){return c.lc(t),c.Wb().seleccione()}),c.Kb(22,"ion-icon",21),c.Lb(),c.Lb(),c.Lb()}if(2&t){const t=c.Wb();c.dc("fullscreen",!0),c.zb(19),c.dc("ngIf",t.cargado)}}function L(t,o){1&t&&(c.Mb(0,"ion-header",28),c.Mb(1,"ion-toolbar",5),c.Mb(2,"ion-buttons",6),c.Kb(3,"ion-back-button",7),c.Lb(),c.Mb(4,"ion-title"),c.rc(5,"A\xf1adir"),c.Lb(),c.Lb(),c.Lb())}function j(t,o){if(1&t&&c.Kb(0,"img",36),2&t){const t=c.Wb().$implicit;c.fc("src","https://motocaliapp.com/11927613402/",t.ruta,"",c.mc)}}function x(t,o){if(1&t&&(c.Mb(0,"ion-slide"),c.qc(1,j,1,1,"img",35),c.Lb()),2&t){const t=o.$implicit;c.zb(1),c.dc("ngIf",t.mime.includes("image"))}}function C(t,o){if(1&t){const t=c.Nb();c.Mb(0,"ion-slides",33,34),c.Ub("ionSlideDidChange",function(){return c.lc(t),c.Wb(2).cambiarSlide()}),c.qc(2,x,2,1,"ion-slide",23),c.Lb()}if(2&t){const t=c.Wb(2);c.dc("options",t.slideOpt),c.zb(2),c.dc("ngForOf",t.fotos)}}function O(t,o){if(1&t&&(c.Mb(0,"div",37),c.rc(1),c.Lb()),2&t){const t=c.Wb(2);c.zb(1),c.sc(t.textoActual)}}function w(t,o){if(1&t&&(c.Mb(0,"ion-content",29),c.Mb(1,"div",30),c.Mb(2,"ion-buttons",6),c.Kb(3,"ion-back-button",7),c.rc(4),c.Lb(),c.Lb(),c.qc(5,C,3,2,"ion-slides",31),c.qc(6,O,2,1,"div",32),c.Lb()),2&t){const t=c.Wb();c.zb(4),c.tc(" ",t.titulotipo," "),c.zb(1),c.dc("ngIf",t.cargado),c.zb(1),c.dc("ngIf",t.mt)}}function y(t,o){if(1&t){const t=c.Nb();c.Mb(0,"ion-card",39),c.Mb(1,"ion-card-content"),c.Mb(2,"ion-list"),c.Mb(3,"ion-item",40),c.Mb(4,"ion-label",41),c.rc(5," Nombre del prodcuto "),c.Lb(),c.Lb(),c.Mb(6,"ion-item",42),c.Mb(7,"ion-input",43),c.Ub("ngModelChange",function(o){return c.lc(t),c.Wb(2).repuesto.nombre=o}),c.Lb(),c.Lb(),c.Kb(8,"br"),c.Mb(9,"ion-item",40),c.Mb(10,"ion-label",6),c.rc(11," Precio Unitario "),c.Lb(),c.Lb(),c.Mb(12,"ion-item",42),c.Mb(13,"ion-input",44),c.Ub("ionChange",function(o){return c.lc(t),c.Wb(2).salidaCambioProd(o,"precio")})("ngModelChange",function(o){return c.lc(t),c.Wb(2).repuesto.precio=o}),c.Lb(),c.Lb(),c.Mb(14,"ion-item",40),c.Mb(15,"ion-label",6),c.rc(16," Cantidad "),c.Lb(),c.Lb(),c.Mb(17,"ion-item",42),c.Mb(18,"ion-input",44),c.Ub("ionChange",function(o){return c.lc(t),c.Wb(2).salidaCambioProd(o,"canti")})("ngModelChange",function(o){return c.lc(t),c.Wb(2).repuesto.cantidad=o}),c.Lb(),c.Lb(),c.Kb(19,"br"),c.Mb(20,"div",45),c.Mb(21,"div",46),c.Mb(22,"strong"),c.rc(23,"Total: "),c.Lb(),c.Mb(24,"span",47),c.rc(25),c.Xb(26,"decimales"),c.Lb(),c.Lb(),c.Lb(),c.Lb(),c.Mb(27,"div",46),c.Mb(28,"ion-button",48),c.Ub("click",function(){return c.lc(t),c.Wb(2).guardarHoja("rep")}),c.rc(29,"GUARDAR"),c.Lb(),c.Lb(),c.Lb(),c.Lb()}if(2&t){const t=c.Wb(2);c.zb(7),c.dc("ngModel",t.repuesto.nombre),c.zb(6),c.dc("ngModel",t.repuesto.precio),c.zb(5),c.dc("ngModel",t.repuesto.cantidad),c.zb(7),c.tc("$",c.Zb(26,4,t.repuesto.total,"es-CO"),"")}}function P(t,o){if(1&t){const t=c.Nb();c.Mb(0,"ion-card",39),c.Mb(1,"ion-card-content"),c.Mb(2,"ion-list"),c.Mb(3,"ion-item",40),c.Mb(4,"ion-label",41),c.rc(5," Nombre del trabajo "),c.Lb(),c.Lb(),c.Mb(6,"ion-item",42),c.Mb(7,"ion-input",49),c.Ub("ngModelChange",function(o){return c.lc(t),c.Wb(2).trabajo.nombre=o}),c.Lb(),c.Lb(),c.Kb(8,"br"),c.Mb(9,"ion-item",40),c.Mb(10,"ion-label",41),c.rc(11," Precio Mano de Obra "),c.Lb(),c.Lb(),c.Mb(12,"ion-item",42),c.Mb(13,"ion-input",50),c.Ub("ngModelChange",function(o){return c.lc(t),c.Wb(2).trabajo.precio=o}),c.Lb(),c.Lb(),c.Kb(14,"br"),c.Mb(15,"div",45),c.Mb(16,"div",46),c.Mb(17,"strong"),c.rc(18,"Total: "),c.Lb(),c.Mb(19,"span",47),c.rc(20),c.Xb(21,"decimales"),c.Lb(),c.Lb(),c.Lb(),c.Lb(),c.Mb(22,"div",46),c.Mb(23,"ion-button",48),c.Ub("click",function(){return c.lc(t),c.Wb(2).guardarHoja("tra")}),c.rc(24,"GUARDAR"),c.Lb(),c.Lb(),c.Lb(),c.Lb()}if(2&t){const t=c.Wb(2);c.zb(7),c.dc("ngModel",t.trabajo.nombre),c.zb(6),c.dc("ngModel",t.trabajo.precio),c.zb(7),c.tc("$",c.Zb(21,3,t.trabajo.precio,"es-CO"),"")}}function k(t,o){if(1&t&&(c.Mb(0,"ion-content"),c.qc(1,y,30,7,"ion-card",38),c.qc(2,P,25,6,"ion-card",38),c.Lb()),2&t){const t=c.Wb();c.zb(1),c.dc("ngIf","repuestos"===t.tipoVista),c.zb(1),c.dc("ngIf","trabajos"===t.tipoVista)}}const z=[{path:"",component:(()=>{class t{constructor(t,o,i,e,n,a,r,s,c){this.modalCtrl=t,this.actionCtrl=o,this.almacenamiento=i,this.camera=e,this.toast=n,this.myLoading=a,this.hojaApi=r,this.activeRoute=s,this.router=c,this.carrete=[],this.carreteRoot=[],this.tipo="Fotos de Entrada",this.cargado=!1,this.gorw=!1,this.mt=!0,this.slideOpt={zoom:{maxRation:8,toggle:!0}},this.tipoVista="",this.repuesto={nombre:"",precio:void 0,cantidad:void 0,total:0},this.trabajo={nombre:"",precio:0},this.repuestos=[],this.trabajos=[],this.id="",this.idHoja="",this.fotos=[],this.titulo="",this.textoActual="",this.titulotipo="",this.files=[],this.filesRendering=[]}ngOnInit(){}ionViewWillEnter(){return Object(s.a)(this,void 0,void 0,function*(){this.tipoVista=this.activeRoute.snapshot.paramMap.get("tipo"),this.id=this.activeRoute.snapshot.paramMap.get("id"),this.idHoja=this.activeRoute.snapshot.paramMap.get("hoja"),"ver"===this.activeRoute.snapshot.paramMap.get("tipo")&&this.traerFotos(),this.miHoja()})}traerFotos(){return Object(s.a)(this,void 0,void 0,function*(){const t=yield this.almacenamiento.obtenerToken();t&&(this.cargado=!0,this.hojaApi.leefotos(t.token,{id:this.idHoja}).subscribe(t=>{t.exe&&(this.fotos=t.response,this.textoActual=this.fotos[0].asunto,this.titulotipo=this.fotos[0].tipo,this.slide.slideTo(parseFloat(this.activeRoute.snapshot.paramMap.get("idx")),300).then(()=>{}).catch(()=>{}))},t=>{this.toast.toastError("No se pudo traer las fotos de la hoja de vida, int\xe9ntelo m\xe1s tarde")}))})}cambiarSlide(){return Object(s.a)(this,void 0,void 0,function*(){this.slide.getActiveIndex().then(t=>{this.titulotipo=this.fotos[t].tipo,this.textoActual=this.fotos[t].asunto})})}miHoja(){return Object(s.a)(this,void 0,void 0,function*(){const t=yield this.almacenamiento.obtenerToken();t&&(this.cargado=!0,this.hojaApi.leeHoja2(t.token,{id:this.id}).subscribe(t=>{t.exe&&(this.idHoja=t.response._id,this.repuestos=t.response.repuestos,this.trabajos=t.response.trabajos)},t=>{this.toast.toastError("No se pudo traer la informaci\xf3n de la hoja de vida, int\xe9ntelo m\xe1s tarde")}))})}cambiar(t){this.tipo=t.detail.value}descripcion(t,o){this.gorw=""!==t.detail.value,this.files[o].texto=t.detail.value,this.files[o].texto=t.detail.value}seleccione(){return Object(s.a)(this,void 0,void 0,function*(){const t=yield this.actionCtrl.create({header:"Escoge una opci\xf3n",buttons:[{icon:"image-outline",text:"Subir foto de galer\xeda",handler:()=>{const t=this.fileUpload.nativeElement;t.onchange=o=>{for(let i=0;i<t.files.length;i++){const e=t.files[i];console.log(e,e.name);let n,a=new FileReader;a.readAsDataURL(o.target.files[0]),a.onload=function(){console.log(a.result),n=a.result},setTimeout(()=>{this.files.push({data:e,inProgress:!1,progress:0,texto:"",ruta:n})},1500)}console.log(this.files,"archivos")},t.click()}}]});yield t.present()})}tomarFoto(t,o){this.camera.getPicture({quality:100,allowEdit:!0,correctOrientation:!0,destinationType:this.camera.DestinationType.FILE_URI,mediaType:this.camera.MediaType.PICTURE,sourceType:t}).then(t=>Object(s.a)(this,void 0,void 0,function*(){let o="",i="";t.includes("jpg")?(o="image/jpg",i="image.jpg"):t.includes("png")?(o="image/png",i="image.png"):t.includes("jpeg")?(o="image/jpeg",i="image.jpeg"):t.includes("gif")?(o="image/gif",i="image.gif"):(i="video.mp4",o="video/mp4"),this.carrete.push({path:t,name:i,mime:o,cont:this.carrete.length+1,texto:""});const e=window.Ionic.WebView.convertFileSrc(t);this.carreteRoot.push({path:e,mime:o,texto:""}),this.camera.cleanup().then(()=>{})}))}eliminardelCarrete(t){this.files.splice(t,1)}salidaCambioProd(t,o){"precio"===o?this.repuesto.precio=t.detail.value:"canti"===o&&(this.repuesto.cantidad=t.detail.value),this.repuesto.total=this.repuesto.precio*this.repuesto.cantidad}guardarHoja(t){return Object(s.a)(this,void 0,void 0,function*(){const o=yield this.almacenamiento.obtenerToken();if(o){let i="";if("rep"===t){if(""===this.repuesto.nombre||" "===this.repuesto.nombre)return void this.toast.toastError("Debe espec\xedficar el nombre del repuesto");if(!this.repuesto.precio||0===this.repuesto.precio)return void this.toast.toastError("Ingrese un precio para el repuesto");if(!this.repuesto.cantidad||0===this.repuesto.cantidad)return void this.toast.toastError("Ingrese una cantidad para el repuesto");i="Repuesto agregado",this.repuestos.push(this.repuesto)}else if("tra"===t){if(""===this.trabajo.nombre||" "===this.trabajo.nombre)return void this.toast.toastError("Debe espec\xedficar el trabajo realizado");if(!this.trabajo.precio||0===this.trabajo.precio)return void this.toast.toastError("Ingrese un valor de mano de obrao");i="Trabajo agregado",this.trabajos.push(this.trabajo)}this.cargado=!0,this.hojaApi.editarHoja(o.token,{id:this.idHoja,repuestos:this.repuestos,trabajos:this.trabajos}).subscribe(t=>{t.exe?this.toast.toastExitoso(i,3e3):this.toast.toastError("No se pudo realizar la petici\xf3n, int\xe9ntelo m\xe1s tarde")},t=>{this.toast.toastError("No se pudo realizar la petici\xf3n, int\xe9ntelo m\xe1s tarde")})}})}guardar(){return Object(s.a)(this,void 0,void 0,function*(){if(this.files.length>0){const t=yield this.almacenamiento.obtenerToken();if(this.myLoading.cargaProcesos("subiendo im\xe1genes, por favor espere"),t){const o=this.idHoja;let i=this.files.length,e=1===this.files.length;this.files.forEach(n=>{const a=new FormData;a.append("archivo",n.data),n.inProgress=!0,this.hojaApi.subirweb(t.token,o,n.texto,this.tipo,a).subscribe(t=>{console.log(t),t.exe&&(i--,1===i&&(e=!0),0===i&&(t.response.tipo="file",this.myLoading.finalizarCargado(),this.toast.toastNotificacion("Fotos subidas a la hoja de vida"),this.router.navigate(["/central/menu/hoja/mihoja",this.activeRoute.snapshot.paramMap.get("id"),"hoja"])))},t=>{this.myLoading.finalizarCargado(),this.toast.alertApplication("No se pudo subir la imagen",!0)})})}}})}cancelar(){this.modalCtrl.dismiss()}}return t.\u0275fac=function(o){return new(o||t)(c.Jb(a.ob),c.Jb(a.a),c.Jb(l.a),c.Jb(b.a),c.Jb(d.a),c.Jb(u.a),c.Jb(p.a),c.Jb(r.a),c.Jb(r.g))},t.\u0275cmp=c.Db({type:t,selectors:[["app-hoja-vida-modal"]],viewQuery:function(t,o){if(1&t&&(c.vc(g,1),c.vc(f,1)),2&t){let t;c.kc(t=c.Vb())&&(o.slide=t.first),c.kc(t=c.Vb())&&(o.fileUpload=t.first)}},decls:4,vars:4,consts:[["color","darkgold",3,"fullscreen",4,"ngIf"],["class","ion-no-border",4,"ngIf"],["color","dark",4,"ngIf"],[4,"ngIf"],["color","darkgold",3,"fullscreen"],["color","oscuro"],["slot","start"],["icon","chevron-back-outline","defaultHref","/central/menu/hoja"],["slot","end"],["color","blanco",3,"click"],["name","save-outline","slot","icon-only"],["color","darkgold"],["value","Fotos de Entrada","cancelText","Cancelar","okText","Aplicar",3,"ionChange"],["value","Fotos de Entrada"],["value","Fotos de Salida"],["value","Novedades"],["type","file","id","fileUpload","name","archivo","accept","image/*",2,"display","none"],["fileUpload",""],[3,"options",4,"ngIf"],["slot","fixed","horizontal","end","vertical","bottom"],["color","oscuro",3,"click"],["name","camera-outline"],[3,"options"],[4,"ngFor","ngForOf"],["width","100%",3,"src"],["inputmode","text","maxlength","200","placeholder","Escribe alguna descripci\xf3n",3,"autoGrow","value","ionChange"],[1,"eliminar",3,"click"],["mode","ios","color","danger"],[1,"ion-no-border"],["color","dark"],[1,"barra"],["class","verslide",3,"options","ionSlideDidChange",4,"ngIf"],["class","texto",4,"ngIf"],[1,"verslide",3,"options","ionSlideDidChange"],["ele",""],[3,"src",4,"ngIf"],[3,"src"],[1,"texto"],["mode","ios",4,"ngIf"],["mode","ios"],["lines","none",1,"sinfondo"],["slot","start",1,"ion-text-wrap"],[1,"sinfondo"],["type","text","placeholder","Nombre del producto",3,"ngModel","ngModelChange"],["type","number","placeholder","Digitar valor",3,"ngModel","ionChange","ngModelChange"],[1,"total"],[1,"flexbet"],[1,"verdei"],["color","barra","expand","block","mode","ios","shape","round",1,"btn",3,"click"],["type","text","placeholder","Nombre del trabajo",3,"ngModel","ngModelChange"],["type","number","placeholder","Digitar valor",3,"ngModel","ngModelChange"]],template:function(t,o){1&t&&(c.qc(0,v,23,2,"ion-content",0),c.qc(1,L,6,0,"ion-header",1),c.qc(2,w,7,3,"ion-content",2),c.qc(3,k,3,2,"ion-content",3)),2&t&&(c.dc("ngIf","fotos"===o.tipoVista),c.zb(1),c.dc("ngIf","repuestos"===o.tipoVista||"trabajos"===o.tipoVista),c.zb(1),c.dc("ngIf","ver"===o.tipoVista),c.zb(1),c.dc("ngIf","repuestos"===o.tipoVista||"trabajos"===o.tipoVista))},directives:[e.j,a.t,a.F,a.k,a.g,a.h,a.j,a.A,a.K,a.W,a.vb,a.X,a.v,a.w,a.ab,e.i,a.Z,a.fb,a.wb,a.z,a.jb,a.hb,a.l,a.m,a.L,a.E,n.i,n.k,a.qb],pipes:[h.a],styles:[".flex[_ngcontent-%COMP%]{width:100%;display:flex;justify-content:space-between}ion-slides[_ngcontent-%COMP%]{width:100%;min-height:100%}.verslide[_ngcontent-%COMP%]{min-height:100vh;height:100vh;max-height:100vh;flex-direction:column}.verslide[_ngcontent-%COMP%], ion-slide[_ngcontent-%COMP%]{width:100%;display:flex;position:relative}ion-slide[_ngcontent-%COMP%]{flex-wrap:wrap;min-height:100%}.verslide[_ngcontent-%COMP%]   ion-slide[_ngcontent-%COMP%], ion-slide[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{max-height:100vh}ion-slide[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{max-width:100%}ion-slide[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{max-width:100%;max-height:100%}.barra[_ngcontent-%COMP%]{width:100%;position:fixed;top:0;background-color:var(--ion-color-oscuro);color:#fff;font-size:16px;z-index:100}.texto[_ngcontent-%COMP%], ion-textarea[_ngcontent-%COMP%]{width:100%;position:fixed;bottom:0;padding:5px;margin:0;opacity:.7;z-index:10;background:rgba(0,0,0,.7)}.texto[_ngcontent-%COMP%]{text-align:center;font-size:14px}.eliminar[_ngcontent-%COMP%]{position:absolute;top:10px;right:10px;z-index:10}ion-card[_ngcontent-%COMP%]{width:100%;margin:auto 0}.flexbet[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center}.flexbet[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]{width:50%}.tprod[_ngcontent-%COMP%]{text-align:center;width:100%;font-size:18px;color:#333;padding:0 10px!important}.verdei[_ngcontent-%COMP%]{color:#0c6809}.total[_ngcontent-%COMP%]{border-top:1px solid hsla(0,0%,100%,.3);color:#333;font-size:22px;padding:10px}"]}),t})()}];let I=(()=>{class t{}return t.\u0275mod=c.Hb({type:t}),t.\u0275inj=c.Gb({factory:function(o){return new(o||t)},imports:[[r.i.forChild(z)],r.i]}),t})();var _=i("iTUp");let W=(()=>{class t{}return t.\u0275mod=c.Hb({type:t}),t.\u0275inj=c.Gb({factory:function(o){return new(o||t)},imports:[[e.b,n.e,a.kb,I,_.a]]}),t})()},fqim:function(t,o,i){"use strict";i.d(o,"a",function(){return n});var e=i("fXoL");let n=(()=>{class t{transform(t,o){return 0===t?0:new Intl.NumberFormat(o,{minimumFractionDigits:1}).format(t)}}return t.\u0275fac=function(o){return new(o||t)},t.\u0275pipe=e.Ib({name:"decimales",type:t,pure:!0}),t})()},r3ab:function(t,o,i){"use strict";i.d(o,"a",function(){return r});var e=i("mrSG"),n=i("fXoL"),a=i("TEn/");let r=(()=>{class t{constructor(t){this.loadingCtrl=t}cargaProcesos(t){return Object(e.a)(this,void 0,void 0,function*(){return this.loading=yield this.loadingCtrl.create({message:t}),this.loading.present()})}finalizarCargado(){this.loading.dismiss()}}return t.\u0275fac=function(o){return new(o||t)(n.Qb(a.mb))},t.\u0275prov=n.Fb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})()}}]);