(window.webpackJsonp=window.webpackJsonp||[]).push([[8],{"+WxW":function(t,e,i){"use strict";i.d(e,"a",function(){return b});var o=i("AytR"),n=i("tk/3"),r=i("coGc"),s=i("lJxs"),a=i("IzEk"),c=i("MtjB"),d=i("PqYM"),h=i("fXoL"),l=i("tyNb");let b=(()=>{class t{constructor(t,e){this.http=t,this.router=e}hanflerError(t){return t.pipe(Object(r.a)(()=>Object(d.a)(3e3)),Object(s.a)(t=>{if(console.log("Entramos a intentos"),t instanceof ErrorEvent)throw new Error("Error de Red");if(404===t.status)throw new Error(" P\xe1gina no encontrada");if(401===t.status)throw new Error(" No tiene permisos ")}),Object(a.a)(3))}disponibilidad(t){const e={headers:new n.c({"x-token":t})};return this.http.get(`${o.a}/ticket/disponibilidad`,e).pipe(Object(c.a)(t=>this.hanflerError(t)))}Creardisponibilidad(t){const e={headers:new n.c({"x-token":t})};return this.http.post(`${o.a}/ticket/disponibilidad`,{},e).pipe(Object(c.a)(t=>this.hanflerError(t)))}editardisponibilidad(t,e){const i={headers:new n.c({"x-token":t})};return this.http.put(`${o.a}/ticket/disponibilidad`,e,i).pipe(Object(c.a)(t=>this.hanflerError(t)))}crearSala(t,e){const i={headers:new n.c({"x-token":t})};return this.http.post(`${o.a}/ticket/salas`,e,i).pipe(Object(c.a)(t=>this.hanflerError(t)))}misSalas(t){const e={headers:new n.c({"x-token":t})};return this.http.get(`${o.a}/ticket/salas`,e).pipe(Object(c.a)(t=>this.hanflerError(t)))}crearTicket(t,e){const i={headers:new n.c({"x-token":t})};return this.http.post(`${o.a}/ticket/crear`,e,i).pipe(Object(c.a)(t=>this.hanflerError(t)))}misTickets(t){const e={headers:new n.c({"x-token":t})};return this.http.get(`${o.a}/ticket/lista`,e).pipe(Object(c.a)(t=>this.hanflerError(t)))}misTicketsLista(t,e){const i={headers:new n.c({"x-token":t})};return this.http.put(`${o.a}/ticket/lista/negocio`,e,i).pipe(Object(c.a)(t=>this.hanflerError(t)))}salasNegocio(t,e){const i={headers:new n.c({"x-token":t})};return this.http.put(`${o.a}/ticket/salas/usuario`,e,i).pipe(Object(c.a)(t=>this.hanflerError(t)))}disponibilidadnegocio(t,e){const i={headers:new n.c({"x-token":t})};return this.http.put(`${o.a}/ticket/disponibilidad/negocio`,e,i).pipe(Object(c.a)(t=>this.hanflerError(t)))}ticketsolo(t,e){const i={headers:new n.c({"x-token":t})};return this.http.put(`${o.a}/ticket/solo`,e,i).pipe(Object(c.a)(t=>this.hanflerError(t)))}ticketelimina(t,e){const i={headers:new n.c({"x-token":t})};return this.http.put(`${o.a}/ticket/eliminar`,e,i).pipe(Object(c.a)(t=>this.hanflerError(t)))}crearHoja(t,e){const i={headers:new n.c({"x-token":t})};return this.http.post(`${o.a}/hoja/dos`,e,i).pipe(Object(c.a)(t=>this.hanflerError(t)))}consultarSala(t,e){const i={headers:new n.c({"x-token":t})};return this.http.post(`${o.a}/ticket/consultar/chat`,e,i).pipe(Object(c.a)(t=>this.hanflerError(t)))}}return t.\u0275fac=function(e){return new(e||t)(h.Sb(n.a),h.Sb(l.g))},t.\u0275prov=h.Hb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})()},"9ucb":function(t,e,i){"use strict";i.d(e,"a",function(){return l});var o=i("AytR"),n=i("tk/3"),r=i("coGc"),s=i("lJxs"),a=i("IzEk"),c=i("MtjB"),d=i("PqYM"),h=i("fXoL");let l=(()=>{class t{constructor(t){this.http=t}hanflerError(t){let e=0;return t.pipe(Object(r.a)(()=>Object(d.a)(3e3)),Object(s.a)(t=>{if(e++,3===e&&(console.log("Entramos a intentos"),t instanceof ErrorEvent))throw new Error("Error de Red")}),Object(a.a)(3))}getBiografia(t,e){const i={headers:new n.c({"x-token":t,"x-id":e})};return this.http.get(`${o.a}/biografia`,i).pipe(Object(c.a)(t=>this.hanflerError(t)))}postBiografia(t,e){const i={headers:new n.c({"x-token":t})};return this.http.post(`${o.a}/biografia`,e,i).pipe(Object(c.a)(t=>this.hanflerError(t)))}}return t.\u0275fac=function(e){return new(e||t)(h.Sb(n.a))},t.\u0275prov=h.Hb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})()},HavB:function(t,e,i){"use strict";i.d(e,"a",function(){return f});var o=i("AytR"),n=i("tk/3"),r=i("coGc"),s=i("lJxs"),a=i("IzEk"),c=i("MtjB"),d=i("JIr8"),h=i("PqYM"),l=i("Cfvw"),b=i("fXoL"),p=i("tyNb"),u=i("B7Rs");let f=(()=>{class t{constructor(t,e,i){this.http=t,this.router=e,this.MmyTransfer=i}hanflerError(t){return t.pipe(Object(r.a)(()=>Object(h.a)(3e3)),Object(s.a)(t=>{if(console.log("Entramos a intentos"),t instanceof ErrorEvent)throw new Error("Error de Red");if(404===t.status)throw new Error(" P\xe1gina no encontrada");if(401===t.status)throw new Error(" No tiene permisos ")}),Object(a.a)(3))}crearPedido(t,e){const i={headers:new n.c({"x-token":t})};return this.http.post(`${o.a}/pedidos/crear/`,e,i).pipe(Object(c.a)(t=>this.hanflerError(t)))}misPedido(t){const e={headers:new n.c({"x-token":t})};return this.http.get(`${o.a}/pedidos/lista/`,e).pipe(Object(c.a)(t=>this.hanflerError(t)))}misChats(t,e){const i={headers:new n.c({"x-token":t})};return this.http.post(`${o.a}/chats/lista/`,e,i).pipe(Object(c.a)(t=>this.hanflerError(t)))}misChatsGrupos(t,e){const i={headers:new n.c({"x-token":t})};return this.http.post(`${o.a}/chats/lista/grupos`,e,i).pipe(Object(c.a)(t=>this.hanflerError(t)))}misPedidoUsuario(t,e){const i={headers:new n.c({"x-token":t})};return this.http.post(`${o.a}/pedidos/lista/`,e,i).pipe(Object(c.a)(t=>this.hanflerError(t)))}misSalas(t){const e={headers:new n.c({"x-token":t})};return this.http.get(`${o.a}/ticket/salas`,e).pipe(Object(c.a)(t=>this.hanflerError(t)))}mensajes(t,e){const i={headers:new n.c({"x-token":t})};return this.http.post(`${o.a}/pedidos/chat`,e,i).pipe(Object(c.a)(t=>this.hanflerError(t)))}traermensajesNoVistos(t,e){const i={headers:new n.c({"x-token":t})};return this.http.post(`${o.a}/pedidos/chat/vistos`,e,i).pipe(Object(c.a)(t=>this.hanflerError(t)))}marcarvisto(t,e){const i={headers:new n.c({"x-token":t})};return this.http.put(`${o.a}/pedidos/chat/vistos`,e,i).pipe(Object(c.a)(t=>this.hanflerError(t)))}infoPedido(t,e){const i={headers:new n.c({"x-token":t})};return this.http.post(`${o.a}/pedidos/info`,e,i).pipe(Object(c.a)(t=>this.hanflerError(t)))}infoPedidoPut(t,e){const i={headers:new n.c({"x-token":t})};return this.http.put(`${o.a}/pedidos/info`,e,i).pipe(Object(c.a)(t=>this.hanflerError(t)))}crearEstados(t,e){const i={headers:new n.c({"x-token":t})};return this.http.post(`${o.a}/pedidos/estados`,e,i).pipe(Object(c.a)(t=>this.hanflerError(t)))}consultarEstados(t,e){const i={headers:new n.c({"x-token":t})};return this.http.put(`${o.a}/pedidos/estados`,e,i).pipe(Object(c.a)(t=>this.hanflerError(t)))}consultarChat(t,e){const i={headers:new n.c({"x-token":t})};return this.http.post(`${o.a}/unico/consultar/chat`,e,i).pipe(Object(c.a)(t=>this.hanflerError(t)))}consultarChatFotos(t,e){const i={headers:new n.c({"x-token":t})};return this.http.post(`${o.a}/unico/consultar/chat/fotos`,e,i).pipe(Object(c.a)(t=>this.hanflerError(t)))}consultarSala(t,e){const i={headers:new n.c({"x-token":t})};return this.http.post(`${o.a}/pedidos/consultar/chat`,e,i).pipe(Object(c.a)(t=>this.hanflerError(t)))}consultarMapa(t,e){const i={headers:new n.c({"x-token":t})};return this.http.post(`${o.a}/pedidos/consultar/mapa`,e,i).pipe(Object(c.a)(t=>this.hanflerError(t)))}consultarMapaUnico(t,e){const i={headers:new n.c({"x-token":t})};return this.http.post(`${o.a}/pedidos/consultar/mapa/unico`,e,i).pipe(Object(c.a)(t=>this.hanflerError(t)))}crearMapa(t,e){const i={headers:new n.c({"x-token":t})};return this.http.post(`${o.a}/pedidos/crear/mapa`,e,i).pipe(Object(c.a)(t=>this.hanflerError(t)))}editarMapa(t,e){const i={headers:new n.c({"x-token":t})};return this.http.put(`${o.a}/pedidos/editar/mapa`,e,i).pipe(Object(c.a)(t=>this.hanflerError(t)))}editarMapaInfo(t,e){const i={headers:new n.c({"x-token":t})};return this.http.put(`${o.a}/pedidos/editar/mapa/info`,e,i).pipe(Object(c.a)(t=>this.hanflerError(t)))}editarMapaInfoD(t,e){const i={headers:new n.c({"x-token":t})};return this.http.put(`${o.a}/pedidos/editar/mapa/infod`,e,i).pipe(Object(c.a)(t=>this.hanflerError(t)))}editarPedido(t,e){const i={headers:new n.c({"x-token":t})};return this.http.post(`${o.a}/pedidos/editar`,e,i).pipe(Object(c.a)(t=>this.hanflerError(t)))}editarChat(t,e){const i={headers:new n.c({"x-token":t})};return this.http.post(`${o.a}/chat/editar`,e,i).pipe(Object(c.a)(t=>this.hanflerError(t)))}subirArchivosChat(t,e,i,n,r,s,a){console.log("archivo",i);const c={fileKey:"archivo",fileName:s,mimeType:a,httpMethod:"PUT",headers:{"x-token":t,"x-sala":e,"x-final":n,"x-cont":r}},h=this.MmyTransfer.create();return Object(l.a)(h.upload(i,`${o.a}/pedido/upload`,c)).pipe(Object(d.a)(t=>{throw new Error(i)}))}subirweb(t,e,i,r,s){console.log(t,e,i,r);const a={headers:new n.c({"x-token":t,"x-sala":e,"x-final":i.toString(),"x-cont":r.toString()})};return this.http.put(`${o.a}/pedido/upload`,s,a).pipe(Object(c.a)(t=>this.hanflerError(t)))}}return t.\u0275fac=function(e){return new(e||t)(b.Sb(n.a),b.Sb(p.g),b.Sb(u.a))},t.\u0275prov=b.Hb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})()},iM4M:function(t,e,i){"use strict";i.d(e,"a",function(){return F});var o=i("mrSG"),n=i("HDdC"),r=i("fXoL"),s=i("TEn/"),a=i("fsfq"),c=i("9ucb"),d=i("Gq8O"),h=i("fmoy"),l=i("oQG1"),b=i("tyNb"),p=i("+WxW"),u=i("7JkF"),f=i("HavB"),g=i("ofXK"),m=i("mg06");function O(t,e){if(1&t){const t=r.Pb();r.Ob(0,"ion-buttons",8),r.Ob(1,"ion-button",9),r.Wb("click",function(){return r.pc(t),r.Yb().cerrar()}),r.Mb(2,"ion-icon",10),r.Nb(),r.Nb()}}function v(t,e){1&t&&(r.Ob(0,"ion-title"),r.wc(1,"Informaci\xf3n"),r.Nb())}function k(t,e){1&t&&(r.Ob(0,"ion-title"),r.wc(1,"Filtrar"),r.Nb())}function x(t,e){if(1&t){const t=r.Pb();r.Ob(0,"ion-buttons",11),r.Ob(1,"ion-button",9),r.Wb("click",function(){return r.pc(t),r.Yb().guardar()}),r.Mb(2,"ion-icon",12),r.Nb(),r.Nb()}}function w(t,e){if(1&t&&r.Mb(0,"img",33),2&t){const t=r.Yb(2);r.hc("src","https://motocaliapp.com/19927613410/",t.info.portada,"",r.qc)}}function C(t,e){1&t&&(r.Ob(0,"div",34),r.wc(1,"Siguiendo"),r.Nb())}function E(t,e){if(1&t){const t=r.Pb();r.Ob(0,"div",35),r.Ob(1,"div",9),r.Wb("click",function(){return r.pc(t),r.Yb(2).seguimiento()}),r.wc(2),r.Nb(),r.Nb()}if(2&t){const t=r.Yb(2);r.Ab(1),r.Db("rj",t.solicitudEnviada)("ama",!t.solicitudEnviada),r.Ab(1),r.xc(t.titulo)}}function N(t,e){if(1&t&&(r.Ob(0,"ion-avatar",36),r.Mb(1,"ion-img",37),r.Nb()),2&t){const t=r.Yb(2);r.Ab(1),r.fc("src",t.info.imagen)}}function j(t,e){1&t&&r.Mb(0,"ion-avatar",36)}function M(t,e){if(1&t&&(r.Ob(0,"strong"),r.wc(1),r.Nb()),2&t){const t=e.$implicit;r.Ab(1),r.yc(" ",t," ")}}function P(t,e){if(1&t&&(r.Ob(0,"div"),r.wc(1),r.Nb()),2&t){const t=e.$implicit,i=e.index;r.Ab(1),r.zc("",i+1,". ",t," ")}}function A(t,e){if(1&t&&(r.Ob(0,"div",13),r.Ob(1,"ion-card",14),r.Ob(2,"div",15),r.Ob(3,"div",16),r.vc(4,w,1,1,"img",17),r.vc(5,C,2,0,"div",18),r.vc(6,E,3,5,"div",19),r.Nb(),r.vc(7,N,2,1,"ion-avatar",20),r.vc(8,j,1,0,"ion-avatar",20),r.Nb(),r.Ob(9,"ion-card-header"),r.Ob(10,"ion-card-title",21),r.wc(11),r.Nb(),r.Nb(),r.Ob(12,"ion-card-content"),r.Ob(13,"ion-list"),r.Ob(14,"ion-item-divider",22),r.Ob(15,"ion-label"),r.wc(16,"Nombre"),r.Nb(),r.Nb(),r.Ob(17,"ion-item",23),r.Ob(18,"ion-avatar",24),r.Mb(19,"img",25),r.Nb(),r.Ob(20,"ion-label"),r.wc(21),r.Nb(),r.Nb(),r.Mb(22,"br"),r.Ob(23,"ion-item-divider",22),r.Ob(24,"ion-label"),r.wc(25,"Tipo de negocio"),r.Nb(),r.Nb(),r.Ob(26,"ion-item",23),r.Ob(27,"ion-avatar",8),r.Mb(28,"img",26),r.Nb(),r.Ob(29,"ion-label",27),r.vc(30,M,2,1,"strong",28),r.Nb(),r.Nb(),r.Ob(31,"ion-item-divider",22),r.Ob(32,"ion-label"),r.wc(33,"Servicios"),r.Nb(),r.Nb(),r.Ob(34,"ion-item",29),r.Ob(35,"ion-avatar",8),r.Mb(36,"img",26),r.Nb(),r.Ob(37,"ion-label",27),r.vc(38,P,2,2,"div",28),r.Nb(),r.Nb(),r.Ob(39,"ion-item-divider",22),r.Ob(40,"ion-label"),r.wc(41,"Horario"),r.Nb(),r.Nb(),r.Ob(42,"ion-item",29),r.Ob(43,"ion-avatar",8),r.Mb(44,"img",30),r.Nb(),r.Ob(45,"ion-label",27),r.Ob(46,"div"),r.wc(47,"HORARIOS DE ATENCI\xd3N"),r.Nb(),r.Ob(48,"div"),r.wc(49,"De "),r.Ob(50,"strong",31),r.wc(51),r.Nb(),r.wc(52," A "),r.Ob(53,"strong",31),r.wc(54),r.Nb(),r.Nb(),r.Ob(55,"strong"),r.wc(56),r.Zb(57,"horario"),r.Zb(58,"horario"),r.Nb(),r.Nb(),r.Nb(),r.Mb(59,"br"),r.Nb(),r.Nb(),r.Nb(),r.Mb(60,"div",32),r.Nb()),2&t){const t=r.Yb();r.Ab(3),r.Db("zul","cl"===t.info.portada),r.Ab(1),r.fc("ngIf","cl"!==t.info.portada),r.Ab(1),r.fc("ngIf",t.amigos&&t.ejecutado),r.Ab(1),r.fc("ngIf",!t.amigos&&t.ejecutado),r.Ab(1),r.fc("ngIf","pl"!==t.info.imagen),r.Ab(1),r.fc("ngIf","none"===t.info.imagen),r.Ab(3),r.xc(t.info.creador.nombrecompleto),r.Ab(10),r.yc("",t.info.nombre," "),r.Ab(9),r.fc("ngForOf",t.info.tipoNegocio),r.Ab(8),r.fc("ngForOf",t.servicios),r.Ab(13),r.xc(t.info.de),r.Ab(3),r.xc(t.info.a),r.Ab(2),r.zc("Desde las ",r.ac(57,15,t.info.desde)," Hasta las ",r.ac(58,17,t.info.hasta),"")}}function _(t,e){if(1&t&&(r.Ob(0,"ion-select-option",44),r.wc(1),r.Nb()),2&t){const t=e.$implicit;r.fc("value",t),r.Ab(1),r.xc(t.nombre)}}function $(t,e){1&t&&(r.Ob(0,"div",45),r.Mb(1,"br"),r.Mb(2,"ion-spinner",46),r.wc(3," Cargando Ciudades... "),r.Nb())}function y(t,e){if(1&t&&(r.Ob(0,"ion-select-option",44),r.wc(1),r.Nb()),2&t){const t=e.$implicit;r.gc("value",t.nombre),r.Ab(1),r.xc(t.nombre)}}function I(t,e){if(1&t){const t=r.Pb();r.Ob(0,"ion-item",39),r.Ob(1,"ion-label",27),r.wc(2,"Selecciona la ciudad"),r.Nb(),r.Ob(3,"ion-select",40),r.Wb("ionChange",function(e){return r.pc(t),r.Yb(2).seleccionarCiudad(e)}),r.vc(4,y,2,2,"ion-select-option",41),r.Nb(),r.Nb()}if(2&t){const t=r.Yb(2);r.Ab(4),r.fc("ngForOf",t.ciudades)}}function T(t,e){if(1&t){const t=r.Pb();r.Ob(0,"ion-item"),r.Ob(1,"ion-checkbox",47),r.Wb("ionChange",function(e){return r.pc(t),r.Yb(2).cambio(e)}),r.Nb(),r.Ob(2,"ion-label",27),r.wc(3),r.Nb(),r.Nb()}if(2&t){const t=e.$implicit;r.Ab(1),r.fc("checked",t.checked)("value",t.nombre),r.Ab(2),r.xc(t.nombre)}}function S(t,e){if(1&t){const t=r.Pb();r.Ob(0,"div",38),r.Ob(1,"ion-list"),r.Ob(2,"ion-item",39),r.Ob(3,"ion-label",27),r.wc(4,"Selecciona el Pa\xeds"),r.Nb(),r.Ob(5,"ion-select",40),r.Wb("ionChange",function(e){return r.pc(t),r.Yb().listarCiudades(e)}),r.vc(6,_,2,2,"ion-select-option",41),r.Nb(),r.Nb(),r.vc(7,$,4,0,"div",42),r.vc(8,I,5,1,"ion-item",43),r.Mb(9,"br"),r.vc(10,T,4,3,"ion-item",28),r.Nb(),r.Nb()}if(2&t){const t=r.Yb();r.Ab(6),r.fc("ngForOf",t.paises),r.Ab(1),r.fc("ngIf",t.cargando),r.Ab(1),r.fc("ngIf",t.ciudad),r.Ab(2),r.fc("ngForOf",t.negocios)}}function L(t,e){if(1&t){const t=r.Pb();r.Ob(0,"ion-card",48),r.Wb("click",function(){return r.pc(t),r.Yb().crearTicket()}),r.Ob(1,"ion-card-header"),r.Mb(2,"img",49),r.Nb(),r.Ob(3,"ion-card-title"),r.wc(4,"Generar Cita "),r.Nb(),r.Ob(5,"ion-card-content",50),r.wc(6,"Crear ficho en el sistema de turnos del establecimiento"),r.Nb(),r.Nb()}}function Y(t,e){if(1&t){const t=r.Pb();r.Ob(0,"ion-card",48),r.Wb("click",function(){return r.pc(t),r.Yb().crearPedido()}),r.Ob(1,"ion-card-header"),r.Mb(2,"img",51),r.Nb(),r.Ob(3,"ion-card-title"),r.wc(4,"Generar Pedido "),r.Nb(),r.Ob(5,"ion-card-content",50),r.wc(6,"Crear pedido para compra de accesorio o repuesto"),r.Nb(),r.Nb()}}let F=(()=>{class t{constructor(t,e,i,o,n,r,s,a,c,d,h,l){this.modalCtrl=t,this.almacenamiento=e,this.biografia=i,this.seguimientoService=o,this.toasCtrl=n,this.popov=r,this.apiUsuario=s,this.alert=a,this.router=c,this.apiTickets=d,this.socket=h,this.apiPedidos=l,this.contenido={},this.servicios=[],this.estado=!0,this.ejecutado=!1,this.amigos=!1,this.negocios=[],this.escogidos=[],this.cargando=!1,this.paises=[],this.ciudades=[],this.miciudad="",this.pais="",this.ciudad=!1,this.solicitudEnviada=!1,this.estadoSolicitud=!1,this.titulo="Enviar solicitud",this.id="",this.nombre="",this.cargado=!1,this.listaModulos="",this.vehiculos=[],this.escucharMensajes().subscribe(t=>{t.msg?(this.toasCtrl.toastExitoso("Ticket creado correctamente"),this.router.navigate(["/central/tickets"]),this.cerrar()):this.toasCtrl.toastError("No se pudo crear el ticket, int\xe9ntelo m\xe1s tarde")})}ngOnInit(){}ionViewWillEnter(){if(1===this.vista){const t=this.info.creador.imagen.length>0?"https://motocaliapp.com/"+this.info.creador.imagen[0].path:"pl";this.info.portada=this.info.creador.portada.path?this.info.creador.portada.path:"cl",this.id=this.info.creador._id,this.nombre=this.info.creador.nombrecompleto,this.info.imagen=t,this.informacion(this.info.creador._id),this.cargarSolicitud(this.info.creador._id),this.disponibilidad(),this.modulos()}else 2===this.vista&&(this.listarPaises(),this.listarNegocios())}modulos(){return Object(o.a)(this,void 0,void 0,function*(){const t=yield this.almacenamiento.obtenerToken();t&&this.apiUsuario.modulosTALLER(t.token,{_id:this.id}).subscribe(t=>{t.exe?(console.log(t.response,"respon"),t.response.length>0&&(this.listaModulos=t.response[0].modulos)):this.toasCtrl.toastError("No se pudo cargar los m\xf3dulos, intentelo m\xe1s tarde")},t=>{this.toasCtrl.toastError("No se pudo cargar los m\xf3dulos, intentelo m\xe1s tarde")})})}disponibilidad(){return Object(o.a)(this,void 0,void 0,function*(){const t=yield this.almacenamiento.obtenerToken();t&&this.apiTickets.disponibilidadnegocio(t.token,{id:this.id}).subscribe(t=>{t.exe&&(this.cargado="no"!==t.response)},t=>{this.toasCtrl.toastError("No se pudo consultar la disponibilidad, int\xe9ntelo m\xe1s tarde")})})}listarNegocios(){this.apiUsuario.negocios().subscribe(t=>Object(o.a)(this,void 0,void 0,function*(){if(t.exe){const e=yield this.almacenamiento.obtenerToken();e&&this.apiUsuario.info(e.token).subscribe(e=>{if(console.log(e,"DATA USER"),e.exe)if("TALLER_ROLE"===e.response.role)t.response.forEach(t=>{t.checked=!0,this.escogidos.push(t.nombre)}),this.negocios=t.response;else{this.vehiculos=e.response.vehiculo;let i=this.vehiculos.filter(t=>"Moto"===t.tipo),o=this.vehiculos.filter(t=>"Carro"===t.tipo);t.response.forEach(t=>{t.checked=!0,t.nombre.includes("Motos")||t.nombre.includes("motos")?i.length>0&&(this.escogidos.push(t.nombre),this.negocios.push(t)):t.nombre.includes("Carros")||t.nombre.includes("carros")?o.length>0&&(this.escogidos.push(t.nombre),this.negocios.push(t)):(this.escogidos.push(t.nombre),this.negocios.push(t))})}})}else this.negocios.push("Taller M\xe9canico")}),t=>{this.negocios.push("Taller M\xe9canico")})}informacion(t){return Object(o.a)(this,void 0,void 0,function*(){const e=yield this.almacenamiento.obtenerToken();e&&this.biografia.getBiografia(e.token,t).subscribe(t=>{t.response.length>0?(this.contenido=t.response[0].contenido,this.servicios=t.response[0].servicios,this.estado=!1):this.estado=!0},t=>{})})}cerrar(){this.modalCtrl.dismiss({})}cargarSolicitud(t){return Object(o.a)(this,void 0,void 0,function*(){const e=yield this.almacenamiento.obtenerToken();e&&this.seguimientoService.consultarSolicitud(e.token,t).subscribe(t=>{t.response.length>0?"pendiente"===t.response[0].estado?(this.amigos=!1,this.solicitudEnviada=!0,this.titulo="Cancelar solicitud"):"aceptado"===t.response[0].estado&&(this.amigos=!0,this.titulo="Dejar de seguir",this.solicitudEnviada=!0):(this.solicitudEnviada=!1,this.titulo="Enviar solicitud"),this.ejecutado=!0},t=>{this.ejecutado=!0,this.toasCtrl.toastError("No se pudo traer toda la informaci\xf3n, int\xe9ntelo m\xe1s tarde")})})}listarPaises(){this.apiUsuario.listarPaises().subscribe(t=>{t.exe?this.paises=t.response:this.paises.push("Colombia")},t=>{this.paises.push("Colombia")})}listarCiudades(t,e){this.pais=t.detail.value.nombre,this.miciudad="",this.cargando=!0,this.apiUsuario.listarCiudades(t.detail.value._id).subscribe(t=>{t.exe?(this.ciudades=t.response,this.ciudad=!0):this.toasCtrl.toastError("No se pudo traer las ciudades, intente registrarse m\xe1s tarde"),this.cargando=!1},t=>{this.toasCtrl.toastError("No se pudo traer las ciudades, intente registrarse m\xe1s tarde"),this.cargando=!1})}seleccionarCiudad(t){this.miciudad=t.detail.value}cambio(t){t.detail.checked?this.escogidos.find(e=>e===t.detail.value)||this.escogidos.push(t.detail.value):this.escogidos=this.escogidos.filter(e=>e!==t.detail.value)}guardar(){this.popov.dismiss({validado:!0,arreglo:this.escogidos,ciudad:""!==this.miciudad&&this.miciudad,pais:""!==this.pais&&this.pais})}seguir(){}seguimiento(){this.solicitudEnviada?this.almacenamiento.obtenerToken().then(t=>{this.seguimientoService.cancelarSolicitud(t.token,this.id,"1").subscribe(t=>{this.solicitudEnviada=!1,this.titulo="Seguir Cuenta"},t=>{this.toasCtrl.alertApplication(t.message,!1)})}).catch(t=>{}):this.almacenamiento.obtenerToken().then(t=>{this.estadoSolicitud=!0,this.seguimientoService.enviarSolicitud({token:t.token,IDreceptor:this.id}).subscribe(e=>{this.socket.emit("solicitudes",{usuario:this.id,nombre:t.nombre}),this.estadoSolicitud=!1,this.solicitudEnviada=!0,this.titulo="Cancelar Solicitud"},t=>{this.estadoSolicitud=!1,this.toasCtrl.alertApplication(t.message,!1)})})}crearTicket(){return Object(o.a)(this,void 0,void 0,function*(){const t=yield this.alert.create({header:"Crear Ticket",message:"Al crear el ticket entrar\xe1s en la fila de espera de "+this.nombre,inputs:[{type:"textarea",placeholder:"Asunto del ficho",name:"des"}],buttons:[{text:"Cancelar",cssClass:"cancelarAlerta",role:"cancel",handler:()=>{}},{text:"Crear Ticket",cssClass:"botonalerta",handler:t=>{this.generarTicket(t)}}]});yield t.present()})}crearPedido(){return Object(o.a)(this,void 0,void 0,function*(){const t=yield this.alert.create({header:"Crear Pedido",message:"Al crear el pedido se crear\xe1 una sala de chat con "+this.nombre,buttons:[{text:"Cancelar",cssClass:"cancelarAlerta",role:"cancel",handler:()=>{}},{text:"Crear Pedido",cssClass:"botonalerta",handler:t=>Object(o.a)(this,void 0,void 0,function*(){if(""!==this.id){const t=yield this.almacenamiento.obtenerToken();t&&this.apiPedidos.crearPedido(t.token,{taller:this.id}).subscribe(t=>{console.log(t),t.exe?(this.modalCtrl.dismiss(),this.toasCtrl.toastExitoso("Pedido creado correctamente"),this.router.navigate(["/central/menu/pedidos"])):this.toasCtrl.toastError("No se pudo generar el pedido para "+this.nombre)},t=>{this.toasCtrl.toastError("No se pudo generar el pedido para "+this.nombre)})}else this.toasCtrl.toastError("No se pudo generar el pedido para "+this.nombre)})}]});yield t.present()})}generarTicket(t){return Object(o.a)(this,void 0,void 0,function*(){if(""!==this.id){const e=yield this.almacenamiento.obtenerToken();e&&this.socket.emit("crear",{idtaller:this.id,id:e._id,usuario:e.nusuario,nombre:e.nombre,des:t.des})}else this.toasCtrl.toastError("No se pudo generar el ticket para "+this.nombre)})}escucharMensajes(){return new n.a(t=>{this.socket.on("mensajeTicket",e=>{t.next(e)})})}}return t.\u0275fac=function(e){return new(e||t)(r.Lb(s.qb),r.Lb(a.a),r.Lb(c.a),r.Lb(d.a),r.Lb(h.a),r.Lb(s.ub),r.Lb(l.a),r.Lb(s.b),r.Lb(b.g),r.Lb(p.a),r.Lb(u.a),r.Lb(f.a))},t.\u0275cmp=r.Fb({type:t,selectors:[["app-modal-mapas"]],inputs:{info:"info",vista:"vista",seleccionados:"seleccionados"},decls:12,vars:8,consts:[["color","oscuro"],["slot","start",4,"ngIf"],[4,"ngIf"],["slot","end",4,"ngIf"],["class","info",4,"ngIf"],["class","filtro",4,"ngIf"],[1,"opts"],["mode","ios",3,"click",4,"ngIf"],["slot","start"],[3,"click"],["name","chevron-back-outline","slot","icon-only"],["slot","end"],["name","checkmark-outline","slot","icon-only"],[1,"info"],["mode","ios",1,"tarjeta"],[1,"portada"],[1,"img"],["alt","",3,"src",4,"ngIf"],["class","barra",4,"ngIf"],["class","barra ama",4,"ngIf"],["class","avatar",4,"ngIf"],[1,"ion-text-center","ion-text-wrap"],["color","light"],["lines","none"],["slot","start",1,"peque"],["src","/assets/Marcador.png","alt",""],["src","/assets/Negocio.png","alt",""],[1,"ion-text-wrap"],[4,"ngFor","ngForOf"],["lines","none",1,"sinfondo"],["src","/assets/reloj.png","alt",""],[1,"verdem"],[1,"seguido"],["alt","",3,"src"],[1,"barra"],[1,"barra","ama"],[1,"avatar"],["type","media","width","200px",3,"src"],[1,"filtro"],["mode","ios"],["okText","Aceptar","cancelText","Cancelar",3,"ionChange"],[3,"value",4,"ngFor","ngForOf"],["class","flexbet",4,"ngIf"],["mode","ios",4,"ngIf"],[3,"value"],[1,"flexbet"],["name","crescent","color","primary"],["slot","start",3,"checked","value","ionChange"],["mode","ios",3,"click"],["src","/assets/Ticket.png","width","100px"],[1,"center"],["src","/assets/Estados.png","width","100px"]],template:function(t,e){1&t&&(r.Ob(0,"ion-header"),r.Ob(1,"ion-toolbar",0),r.vc(2,O,3,0,"ion-buttons",1),r.vc(3,v,2,0,"ion-title",2),r.vc(4,k,2,0,"ion-title",2),r.vc(5,x,3,0,"ion-buttons",3),r.Nb(),r.Nb(),r.Ob(6,"ion-content"),r.vc(7,A,61,19,"div",4),r.vc(8,S,11,4,"div",5),r.Ob(9,"div",6),r.vc(10,L,7,0,"ion-card",7),r.vc(11,Y,7,0,"ion-card",7),r.Nb(),r.Nb()),2&t&&(r.Ab(2),r.fc("ngIf",1===e.vista),r.Ab(1),r.fc("ngIf",1===e.vista),r.Ab(1),r.fc("ngIf",2===e.vista),r.Ab(1),r.fc("ngIf",2===e.vista),r.Ab(2),r.fc("ngIf",1===e.vista),r.Ab(1),r.fc("ngIf",2===e.vista),r.Ab(2),r.fc("ngIf",e.cargado),r.Ab(1),r.fc("ngIf",e.listaModulos.includes("pedidos")))},directives:[s.z,s.lb,g.j,s.t,s.k,s.j,s.A,s.jb,s.l,s.n,s.p,s.m,s.L,s.G,s.K,s.F,s.f,g.i,s.B,s.X,s.xb,s.Y,s.cb,s.q,s.d],pipes:[m.a],styles:["ion-avatar[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%!important}.tarjeta[_ngcontent-%COMP%], div[_ngcontent-%COMP%], ion-list[_ngcontent-%COMP%], ion-slide[_ngcontent-%COMP%], ion-slides[_ngcontent-%COMP%]{width:100%}.tarjeta[_ngcontent-%COMP%]{border-radius:0;margin:0}.tarje[_ngcontent-%COMP%]{margin:10px 0 auto}.tarjeta[_ngcontent-%COMP%]   ion-card-content[_ngcontent-%COMP%]{padding:0}.portada[_ngcontent-%COMP%]{width:100%;background-color:#f9f9f9;height:120px;max-height:120px;position:relative;margin-bottom:50px}.portada[_ngcontent-%COMP%]   .img[_ngcontent-%COMP%]{max-height:120px;overflow:hidden;display:flex;align-items:center}.portada[_ngcontent-%COMP%]   .img[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%}.avatar[_ngcontent-%COMP%]{position:absolute;bottom:-50px;left:50%;transform:translateX(-50%);margin:0 auto;width:100px!important;height:100px!important;z-index:11}.avatar[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{color:#fff}.avatar-peque[_ngcontent-%COMP%]{margin-left:8px;width:30px!important;height:30px!important}.avatar-peque[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%!important;height:100%!important}ion-card-content[_ngcontent-%COMP%]{margin-top:20px}.titulo[_ngcontent-%COMP%]{position:absolute;bottom:-50px;left:120px;font-weight:700;font-size:20px}.peque[_ngcontent-%COMP%]{width:25px;height:40px}.zul[_ngcontent-%COMP%]{background-color:#55636b}.verdem[_ngcontent-%COMP%]{color:#819830}.seguido[_ngcontent-%COMP%]{width:90%;margin:20px auto}.barra[_ngcontent-%COMP%]{position:absolute;width:120px;height:25px;left:0;bottom:-25px;background-color:#819830;color:#fff;font-weight:700;display:flex;justify-content:center;align-items:center}.ama[_ngcontent-%COMP%]{background-color:#2c8f53}.ama[_ngcontent-%COMP%], .rj[_ngcontent-%COMP%]{color:#fff}.rj[_ngcontent-%COMP%]{background-color:#ca0900}.opts[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap}.opts[_ngcontent-%COMP%]   ion-card[_ngcontent-%COMP%]{width:calc(50% - 10px);margin:10px 5px;display:flex;flex-direction:column;justify-content:center;align-items:center;transition:all .5s}.opts[_ngcontent-%COMP%]   ion-card[_ngcontent-%COMP%]   ion-card-title[_ngcontent-%COMP%]{font-size:22px;text-align:center}.opts[_ngcontent-%COMP%]   ion-card[_ngcontent-%COMP%]   ion-card-header[_ngcontent-%COMP%]{text-align:center;padding:5px}.center[_ngcontent-%COMP%]{text-align:center}@media screen and (min-width:800px){.opts[_ngcontent-%COMP%]   ion-card[_ngcontent-%COMP%]{width:calc(33.33% - 10px)}}"]}),t})()},mg06:function(t,e,i){"use strict";i.d(e,"a",function(){return r});var o=i("wd/R"),n=i("fXoL");let r=(()=>{class t{transform(t){return o.locale("es"),o(t).format("h:mm a")}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275pipe=n.Kb({name:"horario",type:t,pure:!0}),t})()}}]);