(window.webpackJsonp=window.webpackJsonp||[]).push([[36],{EE0I:function(i,t,e){"use strict";e.r(t),e.d(t,"SANcreadorPageModule",function(){return G});var o=e("ofXK"),n=e("3Pt+"),a=e("TEn/"),r=e("tyNb"),c=e("mrSG"),s=e("Jmyf"),l=e("fXoL"),b=e("fsfq"),d=e("WGaO"),u=e("fmoy"),h=e("a/9d"),f=e("/sJY"),m=e("r3ab"),p=e("7JkF"),g=e("VYYF");const v=["lienzo"],M=["fileUpload"];function F(i,t){1&i&&l.Kb(0,"ion-back-button",12)}function x(i,t){1&i&&(l.Mb(0,"ion-title"),l.rc(1,"Crear publicaci\xf3n"),l.Lb())}function L(i,t){1&i&&(l.Mb(0,"ion-title"),l.rc(1,"Crear Noticia"),l.Lb())}function C(i,t){if(1&i){const i=l.Nb();l.Mb(0,"div",25),l.Ub("click",function(){l.lc(i);const e=t.$implicit;return l.Wb(2).cambiarColor(e)}),l.Mb(1,"span"),l.rc(2,"ssfsdfsfs"),l.Lb(),l.Lb()}2&i&&l.pc("background",t.$implicit.color)}function y(i,t){if(1&i){const i=l.Nb();l.Mb(0,"ion-textarea",26),l.Ub("ngModelChange",function(t){return l.lc(i),l.Wb(2).valort=t})("ionChange",function(t){return l.lc(i),l.Wb(2).cambiarTexto(t)}),l.Lb()}if(2&i){const i=l.Wb(2);l.dc("ngModel",i.valort)("autoGrow",!0)}}function w(i,t){if(1&i){const i=l.Nb();l.Mb(0,"ion-item-sliding"),l.Mb(1,"ion-item"),l.Mb(2,"ion-avatar",29),l.Kb(3,"img",30),l.Lb(),l.Mb(4,"ion-label"),l.Mb(5,"strong"),l.rc(6),l.Lb(),l.Kb(7,"br"),l.rc(8),l.Lb(),l.Lb(),l.Mb(9,"ion-item-options",31),l.Mb(10,"ion-item-option",32),l.Ub("click",function(){l.lc(i);const e=t.index;return l.Wb(3).eliminar(e)}),l.Kb(11,"ion-icon",33),l.Lb(),l.Lb(),l.Lb()}if(2&i){const i=t.$implicit;l.zb(3),l.dc("src",i.imagen,l.mc),l.zb(3),l.sc(i.nombrecompleto),l.zb(2),l.tc(" @",i.nombreusuario," ")}}function q(i,t){if(1&i&&(l.Mb(0,"div",27),l.qc(1,w,12,3,"ion-item-sliding",28),l.Lb()),2&i){const i=l.Wb(2);l.zb(1),l.dc("ngForOf",i.etiquetados)}}function k(i,t){if(1&i){const i=l.Nb();l.Mb(0,"div",13),l.Mb(1,"ion-segment",14),l.qc(2,C,3,2,"div",15),l.Lb(),l.Mb(3,"div",16,17),l.qc(5,y,1,2,"ion-textarea",18),l.Lb(),l.Mb(6,"ion-list"),l.Mb(7,"ion-item-divider",19),l.Mb(8,"ion-label"),l.rc(9,"A\xf1adir Etiquetas"),l.Lb(),l.Mb(10,"ion-buttons",20),l.Mb(11,"ion-button",5),l.Ub("click",function(){return l.lc(i),l.Wb().etiquetar()}),l.Kb(12,"ion-icon",21),l.Lb(),l.Lb(),l.Lb(),l.qc(13,q,2,1,"div",22),l.Lb(),l.Mb(14,"ion-item",23),l.Mb(15,"ion-textarea",24),l.Ub("ionChange",function(t){return l.lc(i),l.Wb().cambiar(t)}),l.Lb(),l.Lb(),l.Lb()}if(2&i){const i=l.Wb();l.zb(2),l.dc("ngForOf",i.colores),l.zb(1),l.pc("background",i.colorSelect.color)("color",i.colorSelect.letra),l.zb(2),l.dc("ngIf",i.cargan),l.zb(8),l.dc("ngIf",i.etiquetados.length>0),l.zb(2),l.dc("autoGrow",!0)("value",i.comentario)}}function z(i,t){1&i&&(l.Mb(0,"div",37),l.Mb(1,"div",38),l.Kb(2,"img",39),l.Kb(3,"br"),l.Mb(4,"h3",40),l.rc(5,"No Hay archivos agregados para publicar."),l.Lb(),l.Lb(),l.Lb())}function P(i,t){if(1&i&&l.Kb(0,"img",44),2&i){const i=l.Wb().$implicit;l.ec("src",i,l.mc)}}function I(i,t){if(1&i){const i=l.Nb();l.Mb(0,"ion-slide"),l.qc(1,P,1,1,"img",41),l.Mb(2,"div",42),l.Ub("click",function(){l.lc(i);const e=t.index;return l.Wb(3).eliminardelcarrete(e)}),l.Mb(3,"ion-chip",43),l.rc(4,"Eliminar"),l.Lb(),l.Lb(),l.Lb()}if(2&i){const i=t.$implicit;l.zb(1),l.dc("ngIf",i)}}function O(i,t){if(1&i&&(l.Mb(0,"ion-slides"),l.qc(1,I,5,1,"ion-slide",28),l.Lb()),2&i){const i=l.Wb(2);l.zb(1),l.dc("ngForOf",i.filesRendering)}}function j(i,t){if(1&i){const i=l.Nb();l.Mb(0,"ion-item-sliding"),l.Mb(1,"ion-item"),l.Mb(2,"ion-avatar",29),l.Kb(3,"img",30),l.Lb(),l.Mb(4,"ion-label"),l.Mb(5,"strong"),l.rc(6),l.Lb(),l.Kb(7,"br"),l.rc(8),l.Lb(),l.Lb(),l.Mb(9,"ion-item-options",31),l.Mb(10,"ion-item-option",32),l.Ub("click",function(){l.lc(i);const e=t.index;return l.Wb(3).eliminar(e)}),l.Kb(11,"ion-icon",33),l.Lb(),l.Lb(),l.Lb()}if(2&i){const i=t.$implicit;l.zb(3),l.dc("src",i.imagen,l.mc),l.zb(3),l.sc(i.nombrecompleto),l.zb(2),l.tc(" @",i.nombreusuario," ")}}function E(i,t){if(1&i&&(l.Mb(0,"div",27),l.qc(1,j,12,3,"ion-item-sliding",28),l.Lb()),2&i){const i=l.Wb(2);l.zb(1),l.dc("ngForOf",i.etiquetados)}}function W(i,t){if(1&i){const i=l.Nb();l.Mb(0,"div",13),l.Mb(1,"div"),l.Kb(2,"input",34,35),l.qc(4,z,6,0,"div",36),l.qc(5,O,2,1,"ion-slides",3),l.Lb(),l.Mb(6,"ion-list"),l.qc(7,E,2,1,"div",22),l.Lb(),l.Mb(8,"ion-item",23),l.Mb(9,"ion-textarea",24),l.Ub("ionChange",function(t){return l.lc(i),l.Wb().cambiar(t)}),l.Lb(),l.Lb(),l.Lb()}if(2&i){const i=l.Wb();l.zb(4),l.dc("ngIf",0===i.filesRendering.length),l.zb(1),l.dc("ngIf",i.filesRendering.length>0),l.zb(2),l.dc("ngIf",i.etiquetados.length>0),l.zb(2),l.dc("autoGrow",!0)("value",i.comentario)}}function T(i,t){if(1&i){const i=l.Nb();l.Mb(0,"ion-fab",45),l.Mb(1,"ion-fab-button",32),l.Ub("click",function(){return l.lc(i),l.Wb().opciones()}),l.Kb(2,"ion-icon",46),l.Lb(),l.Lb()}}const R=[{path:"",component:(()=>{class i{constructor(i,t,e,o,n,a,r,c,s,l,b,d){this.almacenamiento=i,this.modalCtrl=t,this.IGTMApi=e,this.toast=o,this.router=n,this.actionCtrl=a,this.camera=r,this.media=c,this.myLoading=s,this.socket=l,this.statusbar=b,this.activeRoute=d,this.tipoPublicacion="dibujar",this.historia=!1,this.cargado=!1,this.colorSelect={color:"#fafafa",letra:"#333333"},this.colores=[{color:"#fafafa",letra:"#333333"},{color:"#000000",letra:"#FFFFFF"},{color:"#8854DA",letra:"#FFFFFF"},{color:"#FFD000",letra:"#FFFFFF"},{color:"#BAB417",letra:"#FFFFFF"},{color:"#AAD9F0",letra:"#FFFFFF"},{color:"#F5AD45",letra:"#FFFFFF"},{color:"#DD5347",letra:"#FFFFFF"},{color:"#F8C883",letra:"#333333"},{color:"#1ABCFE",letra:"#333333"},{color:"#0ACF83",letra:"#333333"},{color:"#ED576B",letra:"#ffffff"},{color:"#FFA300",letra:"#333333"},{color:"#555555",letra:"#ffffff"},{color:"#CC924E",letra:"#ffffff"},{color:"#D69624",letra:"#ffffff"},{color:"#FF7262",letra:"#ffffff"}],this.texto="",this.valort="",this.etiquetados=[],this.comentario="",this.archivos=[],this.carrete=[],this.carreteRoot=[],this.video=!1,this.tipo="",this.cargan=!0,this.files=[],this.filesRendering=[]}ngOnInit(){}ionViewWillEnter(){this.carrete=[],this.carreteRoot=[],this.etiquetados=[],this.comentario="",this.texto="",this.valort="",this.tipo=this.activeRoute.snapshot.paramMap.get("tipo"),"historia"===this.activeRoute.snapshot.paramMap.get("tipo")&&(this.historia=!0),this.iniciar()}cambiarColor(i){this.colorSelect=i}detectar(i){}cambio(i){this.tipoPublicacion=i.detail.value,this.carrete=[],this.carreteRoot=[]}iniciar(){return Object(c.a)(this,void 0,void 0,function*(){this.cargado=!0,yield this.almacenamiento.obtenerToken()})}etiquetar(){return Object(c.a)(this,void 0,void 0,function*(){const i=yield this.modalCtrl.create({component:s.a,componentProps:{tipo:"etiquetar"}});yield i.present();const t=yield i.onWillDismiss();t&&t.data&&t.data.exe&&(this.etiquetados.find(i=>i.nombreusuario===t.data.persona.nombreusuario)||this.etiquetados.push(t.data.persona))})}eliminar(i){this.etiquetados.splice(i,1)}cambiar(i){this.comentario=i.detail.value}cambiarTexto(i){this.texto=i.detail.value}entrada(i){return Object(c.a)(this,void 0,void 0,function*(){const t=this.comentario;if("@"===i.detail.data){const i=t.charAt(t.length-1);if(" "===i||""===i){const i=yield this.modalCtrl.create({component:s.a,componentProps:{tipo:"mencionar"}});yield i.present();const t=yield i.onWillDismiss();t&&t.data.exe&&(this.comentario=this.comentario+t.data.persona.nombreusuario)}}})}opciones(){return Object(c.a)(this,void 0,void 0,function*(){const i=yield this.actionCtrl.create({header:"Escoge una opci\xf3n",buttons:[{icon:"image-outline",text:"Subir foto de galer\xeda",handler:()=>{if(this.historia&&1===this.files.length)this.toast.toastError("Solo puedes subir una foto por historia");else{const i=this.fileUpload.nativeElement;i.onchange=t=>{for(let e=0;e<i.files.length;e++){const o=i.files[e];console.log(o,o.name),this.files.push({data:o,inProgress:!1,progress:0});let n,a=new FileReader;a.readAsDataURL(t.target.files[0]),a.onload=function(){console.log(a.result),n=a.result},setTimeout(()=>{this.filesRendering.push(n)},1500)}console.log(this.files,"archivos")},i.click()}}},{icon:"people-outline",text:"Etiquetas",handler:()=>{this.etiquetar()}}]});yield i.present()})}eliminardelcarrete(i){this.filesRendering.splice(i,1),this.files.splice(i,1)}tomarFoto(i,t){this.camera.getPicture({quality:100,allowEdit:!0,correctOrientation:!0,destinationType:this.camera.DestinationType.FILE_URI,mediaType:"image"===t?this.camera.MediaType.PICTURE:this.camera.MediaType.VIDEO,sourceType:i}).then(i=>Object(c.a)(this,void 0,void 0,function*(){let t="",e="";i.includes("jpg")?(t="image/jpg",e="image.jpg"):i.includes("png")?(t="image/png",e="image.png"):i.includes("jpeg")?(t="image/jpeg",e="image.jpeg"):i.includes("gif")?(t="image/gif",e="image.gif"):(e="video.mp4",t="video/mp4"),this.carrete.push({path:i,name:e,mime:t,cont:this.carrete.length+1});const o=window.Ionic.WebView.convertFileSrc(i);this.carreteRoot.push({path:o,mime:t}),this.camera.cleanup().then(()=>{})}))}capturarVideo(){this.media.captureVideo({limit:1,duration:30}).then(i=>{this.carrete.push({path:i[0].fullPath,name:i[0].name,mime:i[0].type,cont:this.carrete.length+1});const t=window.Ionic.WebView.convertFileSrc(i[0].fullPath);this.carreteRoot.push({path:t,mime:i[0].type})})}eliminardelCarrete(i){this.carrete.splice(i,1),this.carreteRoot.splice(i,1),this.carrete.find(i=>i.mime.includes("video")||i.mime.includes("Video"))||(this.video=!1)}crear(){return Object(c.a)(this,void 0,void 0,function*(){const i=yield this.almacenamiento.obtenerToken();i&&("dibujar"===this.tipoPublicacion?""!==this.texto&&this.publicacion(i.token,{tipo:"dibujar",grafico:this.colorSelect,texto:this.texto,comentario:this.comentario,etiquetas:this.etiquetados,historia:this.historia}):"multimedia"===this.tipoPublicacion&&this.enviarMensaje())})}enviarMensaje(){return Object(c.a)(this,void 0,void 0,function*(){if(this.files.length>0){const i=yield this.almacenamiento.obtenerToken();this.myLoading.cargaProcesos("Subiendo mensaje con archivos media, por favor espere"),i&&this.IGTMApi.crearPublicacion(i.token,{tipo:"multimedia",comentario:this.comentario,etiquetas:this.etiquetados,historia:this.historia}).subscribe(t=>{if(t.exe){const e=t.response._id;let o=this.files.length,n=1===this.files.length;this.files.forEach(t=>{const a=new FormData;a.append("archivo",t.data),t.inProgress=!0,this.IGTMApi.subirweb(i.token,e,n,o,this.historia,a).subscribe(i=>{i.exe&&(o--,1===o&&(n=!0),0===o&&(i.response.tipo="file",this.myLoading.finalizarCargado(),t.mime.includes("video")||t.mime.includes("Video")?(this.socket.emit("subirvideo",{nameSecret:i.response.response.ruta,nameConvert:i.response.response.nuevo,creador:i.response.response.creador,mime:i.response.response.nombre,_id:e,historia:this.historia}),this.toast.toastExitoso("La publicaci\xf3n estar\xe1 disponible en unos momentos.")):this.toast.toastExitoso("Contenido publicado."),this.router.navigate(["/central/iniciosan"])))},i=>{this.myLoading.finalizarCargado(),this.toast.alertApplication("No se pudo subir el archivo de v\xeddeo o imagen",!0)})})}})}})}publicacion(i,t){this.IGTMApi.crearPublicacion(i,t).subscribe(i=>{i.exe?(this.valort="",this.texto="",this.toast.toastExitoso("Contenido publicado."),this.router.navigate(["/central/iniciosan"])):this.toast.toastError("No se pudo crear la publicaci\xf3n, intentelo m\xe1s tarde")},i=>{this.toast.toastError("No se pudo crear la publicaci\xf3n, intentelo m\xe1s tarde")})}ionViewWillLeave(){this.carrete=[],this.carreteRoot=[],this.etiquetados=[],this.comentario="",this.texto="",this.valort=""}}return i.\u0275fac=function(t){return new(t||i)(l.Jb(b.a),l.Jb(a.ob),l.Jb(d.a),l.Jb(u.a),l.Jb(r.g),l.Jb(a.a),l.Jb(h.a),l.Jb(f.a),l.Jb(m.a),l.Jb(p.a),l.Jb(g.a),l.Jb(r.a))},i.\u0275cmp=l.Db({type:i,selectors:[["app-sancreador"]],viewQuery:function(i,t){if(1&i&&(l.vc(v,1),l.vc(M,1)),2&i){let i;l.kc(i=l.Vb())&&(t.p=i.first),l.kc(i=l.Vb())&&(t.fileUpload=i.first)}},decls:19,vars:6,consts:[[1,"ion-no-border"],["color","oscuro"],["slot","start","icon","chevron-back-outline","defaultHref","/central/iniciosan",4,"ngIf"],[4,"ngIf"],["mode","ios","slot","end"],[3,"click"],["color","blanco"],["value","dibujar","okayText","Aceptar","cancelText","Cancelar",3,"ionChange"],["value","dibujar"],["value","multimedia"],["class","",4,"ngIf"],["vertical","bottom","horizontal","end","slot","fixed",4,"ngIf"],["slot","start","icon","chevron-back-outline","defaultHref","/central/iniciosan"],[1,""],["scrollable","true"],["class","color",3,"background","click",4,"ngFor","ngForOf"],[1,"lienzo"],["lienzo",""],["inputmode","text","maxlength","120","class","text-lienzo","placeholder","Escribe un texto para la publicaci\xf3n","value","",3,"ngModel","autoGrow","ngModelChange","ionChange",4,"ngIf"],["color","light"],["slot","end"],["name","chevron-forward-outline","slot","icon-only"],["class","etiquetados",4,"ngIf"],["mode","ios",1,"sinfondo"],["inputmode","text","maxlength","120","placeholder","Escribe un comentario",1,"comentario",3,"autoGrow","value","ionChange"],[1,"color",3,"click"],["inputmode","text","maxlength","120","placeholder","Escribe un texto para la publicaci\xf3n","value","",1,"text-lienzo",3,"ngModel","autoGrow","ngModelChange","ionChange"],[1,"etiquetados"],[4,"ngFor","ngForOf"],["slot","start"],["width","100%","height","100%","alt","",3,"src"],["side","end"],["color","danger",3,"click"],["slot","icon-only","name","trash-outline"],["type","file","id","fileUpload","name","archivo","accept","image/*",2,"display","none"],["fileUpload",""],["class","none",4,"ngIf"],[1,"none"],[1,"flexc"],["src","/assets/Camara.png","width","70px","alt",""],[1,"tituloGrande"],["width","70px",3,"src",4,"ngIf"],[1,"eliminar",3,"click"],["color","danger"],["width","70px",3,"src"],["vertical","bottom","horizontal","end","slot","fixed"],["name","add"]],template:function(i,t){1&i&&(l.Mb(0,"ion-header",0),l.Mb(1,"ion-toolbar",1),l.qc(2,F,1,0,"ion-back-button",2),l.qc(3,x,2,0,"ion-title",3),l.qc(4,L,2,0,"ion-title",3),l.Mb(5,"ion-buttons",4),l.Mb(6,"ion-button",5),l.Ub("click",function(){return t.crear()}),l.rc(7,"Publicar"),l.Lb(),l.Lb(),l.Lb(),l.Lb(),l.Mb(8,"ion-content"),l.Mb(9,"ion-list"),l.Mb(10,"ion-item",6),l.Mb(11,"ion-select",7),l.Ub("ionChange",function(i){return t.cambio(i)}),l.Mb(12,"ion-select-option",8),l.rc(13,"Dibujar"),l.Lb(),l.Mb(14,"ion-select-option",9),l.rc(15,"Multimedia"),l.Lb(),l.Lb(),l.Lb(),l.Lb(),l.qc(16,k,16,9,"div",10),l.qc(17,W,10,5,"div",10),l.qc(18,T,3,0,"ion-fab",11),l.Lb()),2&i&&(l.zb(2),l.dc("ngIf","historia"===t.tipo),l.zb(1),l.dc("ngIf",!t.historia),l.zb(1),l.dc("ngIf",t.historia),l.zb(12),l.dc("ngIf","dibujar"===t.tipoPublicacion),l.zb(1),l.dc("ngIf","multimedia"===t.tipoPublicacion),l.zb(1),l.dc("ngIf","multimedia"===t.tipoPublicacion))},directives:[a.z,a.jb,o.j,a.k,a.j,a.t,a.L,a.F,a.W,a.vb,a.X,a.g,a.h,a.hb,a.U,o.i,a.G,a.K,a.A,a.fb,a.wb,n.f,n.i,n.k,a.J,a.f,a.I,a.H,a.ab,a.Z,a.r,a.v,a.w],styles:[".flex[_ngcontent-%COMP%]{display:flex;justify-content:space-around;align-items:center;padding:10px}ion-slide[_ngcontent-%COMP%], ion-slides[_ngcontent-%COMP%]{width:100%;min-height:100%}ion-slide[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap}div[_ngcontent-%COMP%]{width:100%}.color[_ngcontent-%COMP%]{margin:5px;width:50px;height:50px;border-radius:10px}.color[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{opacity:0}.lienzo[_ngcontent-%COMP%]{margin-top:10px;width:100%;max-height:auto;padding:10px}.text-lienzo[_ngcontent-%COMP%]{width:100%;text-align:center;min-height:100%!important;font-size:24px;font-weight:700;line-height:1.7}.comentario[_ngcontent-%COMP%]{width:100%;text-align:left}.amarillo[_ngcontent-%COMP%]{--background:#fef1a7!important}.flexc[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center}.tituloGrande[_ngcontent-%COMP%]{text-align:center;width:300px}"]}),i})()}];let U=(()=>{class i{}return i.\u0275mod=l.Hb({type:i}),i.\u0275inj=l.Gb({factory:function(t){return new(t||i)},imports:[[r.i.forChild(R)],r.i]}),i})();var A=e("D3OO");let G=(()=>{class i{}return i.\u0275mod=l.Hb({type:i}),i.\u0275inj=l.Gb({factory:function(t){return new(t||i)},imports:[[o.b,n.e,a.kb,U,A.a]]}),i})()},r3ab:function(i,t,e){"use strict";e.d(t,"a",function(){return r});var o=e("mrSG"),n=e("fXoL"),a=e("TEn/");let r=(()=>{class i{constructor(i){this.loadingCtrl=i}cargaProcesos(i){return Object(o.a)(this,void 0,void 0,function*(){return this.loading=yield this.loadingCtrl.create({message:i}),this.loading.present()})}finalizarCargado(){this.loading.dismiss()}}return i.\u0275fac=function(t){return new(t||i)(n.Qb(a.mb))},i.\u0275prov=n.Fb({token:i,factory:i.\u0275fac,providedIn:"root"}),i})()}}]);