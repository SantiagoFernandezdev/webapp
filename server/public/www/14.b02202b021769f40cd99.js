(window.webpackJsonp=window.webpackJsonp||[]).push([[14],{"AqZ+":function(t,i,e){"use strict";e.r(i),e.d(i,"SANcreadorPageModule",function(){return S});var o=e("ofXK"),n=e("3Pt+"),a=e("TEn/"),r=e("tyNb"),c=e("mrSG"),s=e("rE7l"),l=e("fXoL"),b=e("fsfq"),d=e("WGaO"),u=e("fmoy"),h=e("a/9d"),m=e("/sJY"),p=e("r3ab"),f=e("7JkF"),g=e("VYYF");const v=["lienzo"];function M(t,i){1&t&&l.Kb(0,"ion-back-button",12)}function F(t,i){1&t&&(l.Mb(0,"ion-title"),l.rc(1,"Crear publicaci\xf3n"),l.Lb())}function x(t,i){1&t&&(l.Mb(0,"ion-title"),l.rc(1,"Crear Noticia"),l.Lb())}function L(t,i){if(1&t){const t=l.Nb();l.Mb(0,"div",25),l.Ub("click",function(){l.lc(t);const e=i.$implicit;return l.Wb(2).cambiarColor(e)}),l.Mb(1,"span"),l.rc(2,"ssfsdfsfs"),l.Lb(),l.Lb()}2&t&&l.pc("background",i.$implicit.color)}function C(t,i){if(1&t){const t=l.Nb();l.Mb(0,"ion-textarea",26),l.Ub("ngModelChange",function(i){return l.lc(t),l.Wb(2).valort=i})("ionChange",function(i){return l.lc(t),l.Wb(2).cambiarTexto(i)}),l.Lb()}if(2&t){const t=l.Wb(2);l.dc("ngModel",t.valort)("autoGrow",!0)}}function y(t,i){if(1&t){const t=l.Nb();l.Mb(0,"ion-item-sliding"),l.Mb(1,"ion-item"),l.Mb(2,"ion-avatar",29),l.Kb(3,"img",30),l.Lb(),l.Mb(4,"ion-label"),l.Mb(5,"strong"),l.rc(6),l.Lb(),l.Kb(7,"br"),l.rc(8),l.Lb(),l.Lb(),l.Mb(9,"ion-item-options",31),l.Mb(10,"ion-item-option",32),l.Ub("click",function(){l.lc(t);const e=i.index;return l.Wb(3).eliminar(e)}),l.Kb(11,"ion-icon",33),l.Lb(),l.Lb(),l.Lb()}if(2&t){const t=i.$implicit;l.zb(3),l.dc("src",t.imagen,l.mc),l.zb(3),l.sc(t.nombrecompleto),l.zb(2),l.tc(" @",t.nombreusuario," ")}}function w(t,i){if(1&t&&(l.Mb(0,"div",27),l.qc(1,y,12,3,"ion-item-sliding",28),l.Lb()),2&t){const t=l.Wb(2);l.zb(1),l.dc("ngForOf",t.etiquetados)}}function q(t,i){if(1&t){const t=l.Nb();l.Mb(0,"div",13),l.Mb(1,"ion-segment",14),l.qc(2,L,3,2,"div",15),l.Lb(),l.Mb(3,"div",16,17),l.qc(5,C,1,2,"ion-textarea",18),l.Lb(),l.Mb(6,"ion-list"),l.Mb(7,"ion-item-divider",19),l.Mb(8,"ion-label"),l.rc(9,"A\xf1adir Etiquetas"),l.Lb(),l.Mb(10,"ion-buttons",20),l.Mb(11,"ion-button",5),l.Ub("click",function(){return l.lc(t),l.Wb().etiquetar()}),l.Kb(12,"ion-icon",21),l.Lb(),l.Lb(),l.Lb(),l.qc(13,w,2,1,"div",22),l.Lb(),l.Mb(14,"ion-item",23),l.Mb(15,"ion-textarea",24),l.Ub("ionChange",function(i){return l.lc(t),l.Wb().cambiar(i)}),l.Lb(),l.Lb(),l.Lb()}if(2&t){const t=l.Wb();l.zb(2),l.dc("ngForOf",t.colores),l.zb(1),l.pc("background",t.colorSelect.color)("color",t.colorSelect.letra),l.zb(2),l.dc("ngIf",t.cargan),l.zb(8),l.dc("ngIf",t.etiquetados.length>0),l.zb(2),l.dc("autoGrow",!0)("value",t.comentario)}}function P(t,i){1&t&&(l.Mb(0,"div",35),l.Mb(1,"div",36),l.Kb(2,"img",37),l.Kb(3,"br"),l.Mb(4,"h3",38),l.rc(5,"No Hay archivos agregados para publicar."),l.Lb(),l.Lb(),l.Lb())}function z(t,i){if(1&t&&l.Kb(0,"img",43),2&t){const t=l.Wb().$implicit;l.ec("src",t.path,l.mc)}}function k(t,i){if(1&t&&l.Kb(0,"video",44),2&t){const t=l.Wb().$implicit;l.ec("src",t.path,l.mc)}}function I(t,i){if(1&t){const t=l.Nb();l.Mb(0,"ion-slide"),l.qc(1,z,1,1,"img",39),l.qc(2,k,1,1,"video",40),l.Mb(3,"div",41),l.Ub("click",function(){l.lc(t);const e=i.index;return l.Wb(3).eliminardelCarrete(e)}),l.Mb(4,"ion-chip",42),l.rc(5,"Eliminar"),l.Lb(),l.Lb(),l.Lb()}if(2&t){const t=i.$implicit;l.zb(1),l.dc("ngIf",t.mime.includes("image")),l.zb(1),l.dc("ngIf",t.mime.includes("video")||t.mime.includes("Video")||t.mime.includes("mp4")||t.mime.includes("MP4"))}}function O(t,i){if(1&t&&(l.Mb(0,"ion-slides"),l.qc(1,I,6,2,"ion-slide",28),l.Lb()),2&t){const t=l.Wb(2);l.zb(1),l.dc("ngForOf",t.carreteRoot)}}function j(t,i){if(1&t){const t=l.Nb();l.Mb(0,"ion-item-sliding"),l.Mb(1,"ion-item"),l.Mb(2,"ion-avatar",29),l.Kb(3,"img",30),l.Lb(),l.Mb(4,"ion-label"),l.Mb(5,"strong"),l.rc(6),l.Lb(),l.Kb(7,"br"),l.rc(8),l.Lb(),l.Lb(),l.Mb(9,"ion-item-options",31),l.Mb(10,"ion-item-option",32),l.Ub("click",function(){l.lc(t);const e=i.index;return l.Wb(3).eliminar(e)}),l.Kb(11,"ion-icon",33),l.Lb(),l.Lb(),l.Lb()}if(2&t){const t=i.$implicit;l.zb(3),l.dc("src",t.imagen,l.mc),l.zb(3),l.sc(t.nombrecompleto),l.zb(2),l.tc(" @",t.nombreusuario," ")}}function T(t,i){if(1&t&&(l.Mb(0,"div",27),l.qc(1,j,12,3,"ion-item-sliding",28),l.Lb()),2&t){const t=l.Wb(2);l.zb(1),l.dc("ngForOf",t.etiquetados)}}function A(t,i){if(1&t){const t=l.Nb();l.Mb(0,"div",13),l.Mb(1,"div"),l.qc(2,P,6,0,"div",34),l.qc(3,O,2,1,"ion-slides",3),l.Lb(),l.Mb(4,"ion-list"),l.qc(5,T,2,1,"div",22),l.Lb(),l.Mb(6,"ion-item",23),l.Mb(7,"ion-textarea",24),l.Ub("ionChange",function(i){return l.lc(t),l.Wb().cambiar(i)}),l.Lb(),l.Lb(),l.Lb()}if(2&t){const t=l.Wb();l.zb(2),l.dc("ngIf",0===t.carreteRoot.length),l.zb(1),l.dc("ngIf",t.carreteRoot.length>0),l.zb(2),l.dc("ngIf",t.etiquetados.length>0),l.zb(2),l.dc("autoGrow",!0)("value",t.comentario)}}function E(t,i){if(1&t){const t=l.Nb();l.Mb(0,"ion-fab",45),l.Mb(1,"ion-fab-button",32),l.Ub("click",function(){return l.lc(t),l.Wb().opciones()}),l.Kb(2,"ion-icon",46),l.Lb(),l.Lb()}}const W=[{path:"",component:(()=>{class t{constructor(t,i,e,o,n,a,r,c,s,l,b,d){this.almacenamiento=t,this.modalCtrl=i,this.IGTMApi=e,this.toast=o,this.router=n,this.actionCtrl=a,this.camera=r,this.media=c,this.myLoading=s,this.socket=l,this.statusbar=b,this.activeRoute=d,this.tipoPublicacion="dibujar",this.historia=!1,this.cargado=!1,this.colorSelect={color:"#fafafa",letra:"#333333"},this.colores=[{color:"#fafafa",letra:"#333333"},{color:"#000000",letra:"#FFFFFF"},{color:"#8854DA",letra:"#FFFFFF"},{color:"#FFD000",letra:"#FFFFFF"},{color:"#BAB417",letra:"#FFFFFF"},{color:"#AAD9F0",letra:"#FFFFFF"},{color:"#F5AD45",letra:"#FFFFFF"},{color:"#DD5347",letra:"#FFFFFF"},{color:"#F8C883",letra:"#333333"},{color:"#1ABCFE",letra:"#333333"},{color:"#0ACF83",letra:"#333333"},{color:"#ED576B",letra:"#ffffff"},{color:"#FFA300",letra:"#333333"},{color:"#555555",letra:"#ffffff"},{color:"#CC924E",letra:"#ffffff"},{color:"#D69624",letra:"#ffffff"},{color:"#FF7262",letra:"#ffffff"}],this.texto="",this.valort="",this.etiquetados=[],this.comentario="",this.archivos=[],this.carrete=[],this.carreteRoot=[],this.video=!1,this.tipo="",this.cargan=!0}ngOnInit(){}ionViewWillEnter(){this.carrete=[],this.carreteRoot=[],this.etiquetados=[],this.comentario="",this.texto="",this.valort="",this.tipo=this.activeRoute.snapshot.paramMap.get("tipo"),"historia"===this.activeRoute.snapshot.paramMap.get("tipo")&&(this.historia=!0),this.iniciar()}cambiarColor(t){this.colorSelect=t}detectar(t){}cambio(t){this.tipoPublicacion=t.detail.value,this.carrete=[],this.carreteRoot=[]}iniciar(){return Object(c.a)(this,void 0,void 0,function*(){this.cargado=!0,yield this.almacenamiento.obtenerToken()})}etiquetar(){return Object(c.a)(this,void 0,void 0,function*(){const t=yield this.modalCtrl.create({component:s.a,componentProps:{tipo:"etiquetar"}});yield t.present();const i=yield t.onWillDismiss();i&&i.data&&i.data.exe&&(this.etiquetados.find(t=>t.nombreusuario===i.data.persona.nombreusuario)||this.etiquetados.push(i.data.persona))})}eliminar(t){this.etiquetados.splice(t,1)}cambiar(t){this.comentario=t.detail.value}cambiarTexto(t){this.texto=t.detail.value}entrada(t){return Object(c.a)(this,void 0,void 0,function*(){const i=this.comentario;if("@"===t.detail.data){const t=i.charAt(i.length-1);if(" "===t||""===t){const t=yield this.modalCtrl.create({component:s.a,componentProps:{tipo:"mencionar"}});yield t.present();const i=yield t.onWillDismiss();i&&i.data.exe&&(this.comentario=this.comentario+i.data.persona.nombreusuario)}}})}opciones(){return Object(c.a)(this,void 0,void 0,function*(){const t=yield this.actionCtrl.create({header:"Escoge una opci\xf3n",buttons:[{icon:"camera-outline",text:"Tomar foto de la c\xe1mara",handler:()=>{this.historia?0===this.carrete.length?this.tomarFoto(this.camera.PictureSourceType.CAMERA):this.toast.toastNotificacion("Solo puedes a\xf1adir una imagen por historia"):this.tomarFoto(this.camera.PictureSourceType.CAMERA)}},{icon:"image-outline",text:"Subir foto de galer\xeda",handler:()=>{this.historia?0===this.carrete.length?this.tomarFoto(this.camera.PictureSourceType.PHOTOLIBRARY,"image"):this.toast.toastNotificacion("Solo puedes a\xf1adir una imagen por historia"):this.tomarFoto(this.camera.PictureSourceType.PHOTOLIBRARY,"image")}},{icon:"people-outline",text:"Etiquetas",handler:()=>{this.etiquetar()}}]});yield t.present()})}tomarFoto(t,i){this.camera.getPicture({quality:100,allowEdit:!0,correctOrientation:!0,destinationType:this.camera.DestinationType.FILE_URI,mediaType:"image"===i?this.camera.MediaType.PICTURE:this.camera.MediaType.VIDEO,sourceType:t}).then(t=>Object(c.a)(this,void 0,void 0,function*(){let i="",e="";t.includes("jpg")?(i="image/jpg",e="image.jpg"):t.includes("png")?(i="image/png",e="image.png"):t.includes("jpeg")?(i="image/jpeg",e="image.jpeg"):t.includes("gif")?(i="image/gif",e="image.gif"):(e="video.mp4",i="video/mp4"),this.carrete.push({path:t,name:e,mime:i,cont:this.carrete.length+1});const o=window.Ionic.WebView.convertFileSrc(t);this.carreteRoot.push({path:o,mime:i}),this.camera.cleanup().then(()=>{})}))}capturarVideo(){this.media.captureVideo({limit:1,duration:30}).then(t=>{this.carrete.push({path:t[0].fullPath,name:t[0].name,mime:t[0].type,cont:this.carrete.length+1});const i=window.Ionic.WebView.convertFileSrc(t[0].fullPath);this.carreteRoot.push({path:i,mime:t[0].type})})}eliminardelCarrete(t){this.carrete.splice(t,1),this.carreteRoot.splice(t,1),this.carrete.find(t=>t.mime.includes("video")||t.mime.includes("Video"))||(this.video=!1)}crear(){return Object(c.a)(this,void 0,void 0,function*(){const t=yield this.almacenamiento.obtenerToken();t&&("dibujar"===this.tipoPublicacion?""!==this.texto&&this.publicacion(t.token,{tipo:"dibujar",grafico:this.colorSelect,texto:this.texto,comentario:this.comentario,etiquetas:this.etiquetados,historia:this.historia}):"multimedia"===this.tipoPublicacion&&this.enviarMensaje())})}enviarMensaje(){return Object(c.a)(this,void 0,void 0,function*(){if(this.carrete.length>0){const t=yield this.almacenamiento.obtenerToken();this.myLoading.cargaProcesos("Subiendo mensaje con archivos media, por favor espere"),t&&this.IGTMApi.crearPublicacion(t.token,{tipo:"multimedia",comentario:this.comentario,etiquetas:this.etiquetados,historia:this.historia}).subscribe(i=>{if(i.exe){const e=i.response._id;this.carrete=this.carrete.sort((t,i)=>t.mime>i.mime?1:t.mime<i.mime?-1:0);let o=this.carrete.length,n=1===this.carrete.length;this.carrete.forEach(i=>{this.IGTMApi.subirArchivosChat(t.token,e,i.path,n,i.cont,this.historia,i.name,i.mime).subscribe(t=>{t.response=JSON.parse(t.response),t.response.exe&&(o--,1===o&&(n=!0),0===o&&(t.response.response.tipo="file",this.myLoading.finalizarCargado(),i.mime.includes("video")||i.mime.includes("Video")?(this.socket.emit("subirvideo",{nameSecret:t.response.response.ruta,nameConvert:t.response.response.nuevo,creador:t.response.response.creador,mime:t.response.response.mime,nombre:t.response.response.nombre,_id:e,historia:this.historia}),this.toast.toastExitoso("La publicaci\xf3n estar\xe1 disponible en unos momentos.")):this.toast.toastExitoso("Contenido publicado."),this.router.navigate(["/central/iniciosan"])))},t=>{this.myLoading.finalizarCargado(),this.toast.alertApplication("No se pudo subir el archivo de v\xeddeo o imagen",!0)})})}})}})}publicacion(t,i){this.IGTMApi.crearPublicacion(t,i).subscribe(t=>{t.exe?(this.valort="",this.texto="",this.toast.toastExitoso("Contenido publicado."),this.router.navigate(["/central/iniciosan"])):this.toast.toastError("No se pudo crear la publicaci\xf3n, intentelo m\xe1s tarde")},t=>{this.toast.toastError("No se pudo crear la publicaci\xf3n, intentelo m\xe1s tarde")})}ionViewWillLeave(){this.carrete=[],this.carreteRoot=[],this.etiquetados=[],this.comentario="",this.texto="",this.valort=""}}return t.\u0275fac=function(i){return new(i||t)(l.Jb(b.a),l.Jb(a.ob),l.Jb(d.a),l.Jb(u.a),l.Jb(r.g),l.Jb(a.a),l.Jb(h.a),l.Jb(m.a),l.Jb(p.a),l.Jb(f.a),l.Jb(g.a),l.Jb(r.a))},t.\u0275cmp=l.Db({type:t,selectors:[["app-sancreador"]],viewQuery:function(t,i){if(1&t&&l.vc(v,1),2&t){let t;l.kc(t=l.Vb())&&(i.p=t.first)}},decls:19,vars:6,consts:[[1,"ion-no-border"],["color","oscuro"],["slot","start","icon","chevron-back-outline","defaultHref","/central/iniciosan",4,"ngIf"],[4,"ngIf"],["mode","ios","slot","end"],[3,"click"],["color","blanco"],["value","dibujar","okayText","Aceptar","cancelText","Cancelar",3,"ionChange"],["value","dibujar"],["value","multimedia"],["class","",4,"ngIf"],["vertical","bottom","horizontal","end","slot","fixed",4,"ngIf"],["slot","start","icon","chevron-back-outline","defaultHref","/central/iniciosan"],[1,""],["scrollable","true"],["class","color",3,"background","click",4,"ngFor","ngForOf"],[1,"lienzo"],["lienzo",""],["inputmode","text","maxlength","120","class","text-lienzo","placeholder","Escribe un texto para la publicaci\xf3n","value","",3,"ngModel","autoGrow","ngModelChange","ionChange",4,"ngIf"],["color","light"],["slot","end"],["name","chevron-forward-outline","slot","icon-only"],["class","etiquetados",4,"ngIf"],["mode","ios",1,"sinfondo"],["inputmode","text","maxlength","120","placeholder","Escribe un comentario",1,"comentario",3,"autoGrow","value","ionChange"],[1,"color",3,"click"],["inputmode","text","maxlength","120","placeholder","Escribe un texto para la publicaci\xf3n","value","",1,"text-lienzo",3,"ngModel","autoGrow","ngModelChange","ionChange"],[1,"etiquetados"],[4,"ngFor","ngForOf"],["slot","start"],["width","100%","height","100%","alt","",3,"src"],["side","end"],["color","danger",3,"click"],["slot","icon-only","name","trash-outline"],["class","none",4,"ngIf"],[1,"none"],[1,"flexc"],["src","/assets/Camara.png","width","70px","alt",""],[1,"tituloGrande"],["width","70px",3,"src",4,"ngIf"],["width","70px","controls","",3,"src",4,"ngIf"],[1,"eliminar",3,"click"],["color","danger"],["width","70px",3,"src"],["width","70px","controls","",3,"src"],["vertical","bottom","horizontal","end","slot","fixed"],["name","add"]],template:function(t,i){1&t&&(l.Mb(0,"ion-header",0),l.Mb(1,"ion-toolbar",1),l.qc(2,M,1,0,"ion-back-button",2),l.qc(3,F,2,0,"ion-title",3),l.qc(4,x,2,0,"ion-title",3),l.Mb(5,"ion-buttons",4),l.Mb(6,"ion-button",5),l.Ub("click",function(){return i.crear()}),l.rc(7,"Publicar"),l.Lb(),l.Lb(),l.Lb(),l.Lb(),l.Mb(8,"ion-content"),l.Mb(9,"ion-list"),l.Mb(10,"ion-item",6),l.Mb(11,"ion-select",7),l.Ub("ionChange",function(t){return i.cambio(t)}),l.Mb(12,"ion-select-option",8),l.rc(13,"Dibujar"),l.Lb(),l.Mb(14,"ion-select-option",9),l.rc(15,"Multimedia"),l.Lb(),l.Lb(),l.Lb(),l.Lb(),l.qc(16,q,16,9,"div",10),l.qc(17,A,8,5,"div",10),l.qc(18,E,3,0,"ion-fab",11),l.Lb()),2&t&&(l.zb(2),l.dc("ngIf","historia"===i.tipo),l.zb(1),l.dc("ngIf",!i.historia),l.zb(1),l.dc("ngIf",i.historia),l.zb(12),l.dc("ngIf","dibujar"===i.tipoPublicacion),l.zb(1),l.dc("ngIf","multimedia"===i.tipoPublicacion),l.zb(1),l.dc("ngIf","multimedia"===i.tipoPublicacion))},directives:[a.z,a.jb,o.j,a.k,a.j,a.t,a.L,a.F,a.W,a.vb,a.X,a.g,a.h,a.hb,a.U,o.i,a.G,a.K,a.A,a.fb,a.wb,n.f,n.i,n.k,a.J,a.f,a.I,a.H,a.ab,a.Z,a.r,a.v,a.w],styles:[".flex[_ngcontent-%COMP%]{display:flex;justify-content:space-around;align-items:center;padding:10px}ion-slide[_ngcontent-%COMP%], ion-slides[_ngcontent-%COMP%]{width:100%;min-height:100%}ion-slide[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap}div[_ngcontent-%COMP%]{width:100%}.color[_ngcontent-%COMP%]{margin:5px;width:50px;height:50px;border-radius:10px}.color[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{opacity:0}.lienzo[_ngcontent-%COMP%]{margin-top:10px;width:100%;max-height:auto;padding:10px}.text-lienzo[_ngcontent-%COMP%]{width:100%;text-align:center;min-height:100%!important;font-size:24px;font-weight:700;line-height:1.7}.comentario[_ngcontent-%COMP%]{width:100%;text-align:left}.amarillo[_ngcontent-%COMP%]{--background:#fef1a7!important}.flexc[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center}.tituloGrande[_ngcontent-%COMP%]{text-align:center;width:300px}"]}),t})()}];let R=(()=>{class t{}return t.\u0275mod=l.Hb({type:t}),t.\u0275inj=l.Gb({factory:function(i){return new(i||t)},imports:[[r.i.forChild(W)],r.i]}),t})();var J=e("J1J0");let S=(()=>{class t{}return t.\u0275mod=l.Hb({type:t}),t.\u0275inj=l.Gb({factory:function(i){return new(i||t)},imports:[[o.b,n.e,a.kb,R,J.a]]}),t})()},r3ab:function(t,i,e){"use strict";e.d(i,"a",function(){return r});var o=e("mrSG"),n=e("fXoL"),a=e("TEn/");let r=(()=>{class t{constructor(t){this.loadingCtrl=t}cargaProcesos(t){return Object(o.a)(this,void 0,void 0,function*(){return this.loading=yield this.loadingCtrl.create({message:t}),this.loading.present()})}finalizarCargado(){this.loading.dismiss()}}return t.\u0275fac=function(i){return new(i||t)(n.Qb(a.mb))},t.\u0275prov=n.Fb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})()}}]);